# TPCDS-Q14a first of two
# start query 14 in stream 0 using template query14.tpl using seed 521152908
with  cross_items as
 (select i_item_sk ss_item_sk
 from item,
 (select iss.i_brand_id brand_id
     ,iss.i_class_id class_id
     ,iss.i_category_id category_id
 from store_sales
     ,item iss
     ,date_dim d1
 where ss_item_sk = iss.i_item_sk
   and ss_sold_date_sk = d1.d_date_sk
   and d1.d_year between 1998 AND 1998 + 2
 intersect
 select ics.i_brand_id
     ,ics.i_class_id
     ,ics.i_category_id
 from catalog_sales
     ,item ics
     ,date_dim d2
 where cs_item_sk = ics.i_item_sk
   and cs_sold_date_sk = d2.d_date_sk
   and d2.d_year between 1998 AND 1998 + 2
 intersect
 select iws.i_brand_id
     ,iws.i_class_id
     ,iws.i_category_id
 from web_sales
     ,item iws
     ,date_dim d3
 where ws_item_sk = iws.i_item_sk
   and ws_sold_date_sk = d3.d_date_sk
   and d3.d_year between 1998 AND 1998 + 2) x
 where i_brand_id = brand_id
      and i_class_id = class_id
      and i_category_id = category_id
),
 avg_sales as
 (select avg(quantity*list_price) average_sales
  from (select ss_quantity quantity
             ,ss_list_price list_price
       from store_sales
           ,date_dim
       where ss_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select cs_quantity quantity
             ,cs_list_price list_price
       from catalog_sales
           ,date_dim
       where cs_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2
       union all
       select ws_quantity quantity
             ,ws_list_price list_price
       from web_sales
           ,date_dim
       where ws_sold_date_sk = d_date_sk
         and d_year between 1998 and 1998 + 2) x)
  select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)
 from(
       select 'store' channel, i_brand_id,i_class_id
             ,i_category_id,sum(ss_quantity*ss_list_price) sales
             , count(*) number_sales
       from store_sales
           ,item
           ,date_dim
       where ss_item_sk in (select ss_item_sk from cross_items)
         and ss_item_sk = i_item_sk
         and ss_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)
       union all
       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales
       from catalog_sales
           ,item
           ,date_dim
       where cs_item_sk in (select ss_item_sk from cross_items)
         and cs_item_sk = i_item_sk
         and cs_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)
       union all
       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales
       from web_sales
           ,item
           ,date_dim
       where ws_item_sk in (select ss_item_sk from cross_items)
         and ws_item_sk = i_item_sk
         and ws_sold_date_sk = d_date_sk
         and d_year = 1998+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)
 ) y
 group by rollup (channel, i_brand_id,i_class_id,i_category_id)
 order by channel,i_brand_id,i_class_id,i_category_id
 limit 100
---- PLAN
Max Per-Host Resource Reservation: Memory=333.12MB Threads=1
Per-Host Resource Estimates: Memory=1.21GB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=1.21GB mem-reservation=333.12MB thread-reservation=1 runtime-filters-memory=10.00MB
|  max-parallelism=1 segment-costs=[31372963012, 18425340152, 1786964, 1760391, 9213623656, 2680446, 3045814, 2119639300, 33456425724, 31372963012, 18425340152, 1786964, 1760391, 9213623656, 2680446, 3045814, 1218891580, 33456425724, 31372963012, 18425340152, 1786964, 1760391, 9213623656, 2680446, 3045814, 613191964, 33456425724, 11504873, 10687615, 20955666, 600]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(160,161,162,158,159) WHEN 158 THEN CHANNEL WHEN 159 THEN CHANNEL WHEN 160 THEN CHANNEL WHEN 161 THEN CHANNEL WHEN 162 THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_BRAND_ID WHEN 159 THEN I_BRAND_ID WHEN 160 THEN I_BRAND_ID WHEN 161 THEN NULL WHEN 162 THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CLASS_ID WHEN 159 THEN I_CLASS_ID WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CATEGORY_ID WHEN 159 THEN NULL WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END, aggif(valid_tid(160,161,162,158,159) IN (158, 159, 160, 161, 162), CASE valid_tid(160,161,162,158,159) WHEN 158 THEN sum(SALES) WHEN 159 THEN sum(SALES) WHEN 160 THEN sum(SALES) WHEN 161 THEN sum(SALES) WHEN 162 THEN sum(SALES) END), aggif(valid_tid(160,161,162,158,159) IN (158, 159, 160, 161, 162), CASE valid_tid(160,161,162,158,159) WHEN 158 THEN sum(NUMBER_SALES) WHEN 159 THEN sum(NUMBER_SALES) WHEN 160 THEN sum(NUMBER_SALES) WHEN 161 THEN sum(NUMBER_SALES) WHEN 162 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
142:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(160,161,162,158,159) WHEN 158 THEN CHANNEL WHEN 159 THEN CHANNEL WHEN 160 THEN CHANNEL WHEN 161 THEN CHANNEL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_BRAND_ID WHEN 159 THEN I_BRAND_ID WHEN 160 THEN I_BRAND_ID WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CLASS_ID WHEN 159 THEN I_CLASS_ID WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CATEGORY_ID WHEN 159 THEN NULL WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=164 row-size=48B cardinality=100 cost=20955666
|  in pipelines: 142(GETNEXT), 141(OPEN)
|
141:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(160,161,162,158,159) IN (CAST(158 AS INT), CAST(159 AS INT), CAST(160 AS INT), CAST(161 AS INT), CAST(162 AS INT)), CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN sum(SALES) WHEN CAST(159 AS INT) THEN sum(SALES) WHEN CAST(160 AS INT) THEN sum(SALES) WHEN CAST(161 AS INT) THEN sum(SALES) WHEN CAST(162 AS INT) THEN sum(SALES) END), aggif(valid_tid(160,161,162,158,159) IN (CAST(158 AS INT), CAST(159 AS INT), CAST(160 AS INT), CAST(161 AS INT), CAST(162 AS INT)), CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(159 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(160 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(161 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(162 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN CHANNEL WHEN CAST(159 AS INT) THEN CHANNEL WHEN CAST(160 AS INT) THEN CHANNEL WHEN CAST(161 AS INT) THEN CHANNEL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN I_BRAND_ID WHEN CAST(159 AS INT) THEN I_BRAND_ID WHEN CAST(160 AS INT) THEN I_BRAND_ID WHEN CAST(161 AS INT) THEN NULL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN I_CLASS_ID WHEN CAST(159 AS INT) THEN I_CLASS_ID WHEN CAST(160 AS INT) THEN NULL WHEN CAST(161 AS INT) THEN NULL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN I_CATEGORY_ID WHEN CAST(159 AS INT) THEN NULL WHEN CAST(160 AS INT) THEN NULL WHEN CAST(161 AS INT) THEN NULL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN CAST(158 AS INT) WHEN CAST(159 AS INT) THEN CAST(159 AS INT) WHEN CAST(160 AS INT) THEN CAST(160 AS INT) WHEN CAST(161 AS INT) THEN CAST(161 AS INT) WHEN CAST(162 AS INT) THEN CAST(162 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=163 row-size=52B cardinality=1.79M cost=10687615
|  in pipelines: 141(GETNEXT), 140(OPEN)
|
140:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=158N,159N,160N,161N,162N row-size=240B cardinality=1.79M cost=11333645
|  in pipelines: 140(GETNEXT), 34(OPEN), 80(OPEN), 126(OPEN)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=157 row-size=48B cardinality=447.36K cost=26522
|  in pipelines: 34(GETNEXT), 80(GETNEXT), 126(GETNEXT)
|
|--139:NESTED LOOP JOIN [INNER JOIN]
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_4.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_4.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=140,156 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 126(GETNEXT), 138(OPEN)
|  |
|  |--138:AGGREGATE [FINALIZE]
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=156 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 138(GETNEXT), 129(OPEN), 132(OPEN), 135(OPEN)
|  |  |
|  |  127:UNION
|  |  |  pass-through-operands: 128
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=154 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 129(GETNEXT), 132(GETNEXT), 135(GETNEXT)
|  |  |
|  |  |--137:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=150,152 row-size=377B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 135(GETNEXT), 136(OPEN)
|  |  |  |
|  |  |  |--136:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=152 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 136(GETNEXT)
|  |  |  |
|  |  |  135:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=150 row-size=140B cardinality=2.16G cost=4354495421
|  |  |     in pipelines: 135(GETNEXT)
|  |  |
|  |  128:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=149 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 129(GETNEXT), 132(GETNEXT)
|  |  |
|  |  |--134:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=145,147 row-size=377B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 132(GETNEXT), 133(OPEN)
|  |  |  |
|  |  |  |--133:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=147 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 133(GETNEXT)
|  |  |  |
|  |  |  132:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=145 row-size=140B cardinality=4.32G cost=8709277205
|  |  |     in pipelines: 132(GETNEXT)
|  |  |
|  |  131:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=141,143 row-size=333B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |  |
|  |  |--130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=143 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 130(GETNEXT)
|  |  |
|  |  129:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=141 row-size=96B cardinality=8.64G cost=11943846410
|  |     in pipelines: 129(GETNEXT)
|  |
|  126:AGGREGATE [FINALIZE]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_4.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_4.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=140 row-size=36B cardinality=149.12K cost=185273043
|  |  in pipelines: 126(GETNEXT), 120(OPEN)
|  |
|  125:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  fk/pk conjuncts: none
|  |  runtime filters: RF061[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=134,136,138,133 row-size=787B cardinality=127.83M cost=56310721
|  |  in pipelines: 120(GETNEXT), 119(OPEN)
|  |
|  |--119:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=133 row-size=4B cardinality=360.00K cost=1069444
|  |  |  in pipelines: 119(GETNEXT), 117(OPEN)
|  |  |
|  |  118:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.item_12.i_brand_id = BRAND_ID, tpcds_partitioned_parquet_snap.item_12.i_category_id = CATEGORY_ID, tpcds_partitioned_parquet_snap.item_12.i_class_id = CLASS_ID
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  runtime filters: RF069[min_max] <- BRAND_ID, RF070[min_max] <- CATEGORY_ID, RF071[min_max] <- CLASS_ID
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=131,130 row-size=425B cardinality=447.36K cost=620761
|  |  |  in pipelines: 117(GETNEXT), 116(OPEN)
|  |  |
|  |  |--116:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=130 row-size=20B cardinality=447.36K cost=2640587
|  |  |  |  in pipelines: 116(GETNEXT), 109(OPEN), 115(OPEN)
|  |  |  |
|  |  |  94:UNION
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=129 row-size=20B cardinality=447.36K cost=39859
|  |  |  |  in pipelines: 109(GETNEXT), 115(GETNEXT)
|  |  |  |
|  |  |  |--115:AGGREGATE [FINALIZE]
|  |  |  |  |  output: count()
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=128 row-size=20B cardinality=149.12K cost=2967204009
|  |  |  |  |  in pipelines: 115(GETNEXT), 110(OPEN)
|  |  |  |  |
|  |  |  |  114:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  runtime filters: RF081[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=122,124,126 row-size=783B cardinality=2.16G cost=945305506
|  |  |  |  |  in pipelines: 110(GETNEXT), 113(OPEN)
|  |  |  |  |
|  |  |  |  |--113:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=126 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |  |     in pipelines: 113(GETNEXT)
|  |  |  |  |
|  |  |  |  112:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=122,124 row-size=377B cardinality=2.16G(filtered from 2.16G) cost=945148406
|  |  |  |  |  in pipelines: 110(GETNEXT), 111(OPEN)
|  |  |  |  |
|  |  |  |  |--111:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |  |     tuple-ids=124 row-size=237B cardinality=7.30K cost=114705
|  |  |  |  |     in pipelines: 111(GETNEXT)
|  |  |  |  |
|  |  |  |  110:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |  |     runtime filters: RF081[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=2.16G size=145.75GB
|  |  |  |       partitions: 1824/1824 rows=2.16G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |  |     tuple-ids=122 row-size=140B cardinality=2.16G(filtered from 2.16G) cost=4354495421
|  |  |  |     in pipelines: 110(GETNEXT)
|  |  |  |
|  |  |  109:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=121 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 109(GETNEXT), 108(OPEN)
|  |  |  |
|  |  |  108:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=120 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 108(GETNEXT), 101(OPEN), 107(OPEN)
|  |  |  |
|  |  |  95:UNION
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=119 row-size=20B cardinality=298.24K cost=26573
|  |  |  |  in pipelines: 101(GETNEXT), 107(GETNEXT)
|  |  |  |
|  |  |  |--107:AGGREGATE [FINALIZE]
|  |  |  |  |  output: count()
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=118 row-size=20B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 107(GETNEXT), 102(OPEN)
|  |  |  |  |
|  |  |  |  106:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  runtime filters: RF076[bloom] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk, RF077[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=112,114,116 row-size=783B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 102(GETNEXT), 105(OPEN)
|  |  |  |  |
|  |  |  |  |--105:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=116 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |  |     in pipelines: 105(GETNEXT)
|  |  |  |  |
|  |  |  |  104:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=112,114 row-size=377B cardinality=4.32G(filtered from 4.32G) cost=1890351663
|  |  |  |  |  in pipelines: 102(GETNEXT), 103(OPEN)
|  |  |  |  |
|  |  |  |  |--103:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |  |     tuple-ids=114 row-size=237B cardinality=7.30K cost=114705
|  |  |  |  |     in pipelines: 103(GETNEXT)
|  |  |  |  |
|  |  |  |  102:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF077[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk, RF076[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=112 row-size=140B cardinality=4.32G(filtered from 4.32G) cost=8709277205
|  |  |  |     in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  101:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=111 row-size=20B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 101(GETNEXT), 96(OPEN)
|  |  |  |
|  |  |  100:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  runtime filters: RF072[bloom] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk, RF073[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=105,107,109 row-size=739B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 96(GETNEXT), 99(OPEN)
|  |  |  |
|  |  |  |--99:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=109 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  98:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=105,107 row-size=333B cardinality=8.64G(filtered from 8.64G) cost=3780599421
|  |  |  |  in pipelines: 96(GETNEXT), 97(OPEN)
|  |  |  |
|  |  |  |--97:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=107 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 97(GETNEXT)
|  |  |  |
|  |  |  96:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk, RF072[bloom] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |  |     tuple-ids=105 row-size=96B cardinality=8.64G(filtered from 8.64G) cost=11943846410
|  |  |     in pipelines: 96(GETNEXT)
|  |  |
|  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF069[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_brand_id, RF070[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_category_id, RF071[min_max] -> tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=131 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 117(GETNEXT)
|  |
|  124:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=134,136,138 row-size=783B cardinality=127.83M cost=56327115
|  |  in pipelines: 120(GETNEXT), 123(OPEN)
|  |
|  |--123:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=138 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 123(GETNEXT)
|  |
|  122:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=134,136 row-size=377B cardinality=127.89M cost=55978804
|  |  in pipelines: 120(GETNEXT), 121(OPEN)
|  |
|  |--121:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=136 row-size=237B cardinality=108 cost=114705
|  |     in pipelines: 121(GETNEXT)
|  |
|  120:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk, RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|     tuple-ids=134 row-size=140B cardinality=127.89M(filtered from 2.16G) cost=257831967
|     in pipelines: 120(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=104 row-size=48B cardinality=298.24K cost=53044
|  in pipelines: 34(GETNEXT), 80(GETNEXT)
|
|--93:NESTED LOOP JOIN [INNER JOIN]
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=87,103 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 80(GETNEXT), 92(OPEN)
|  |
|  |--92:AGGREGATE [FINALIZE]
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=103 row-size=16B cardinality=1 cost=1058398679
|  |  |  in pipelines: 92(GETNEXT), 83(OPEN), 86(OPEN), 89(OPEN)
|  |  |
|  |  81:UNION
|  |  |  pass-through-operands: 82
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=101 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 83(GETNEXT), 86(GETNEXT), 89(GETNEXT)
|  |  |
|  |  |--91:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=97,99 row-size=377B cardinality=2.16G cost=945425284
|  |  |  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |  |  |
|  |  |  |--90:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=99 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 90(GETNEXT)
|  |  |  |
|  |  |  89:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=97 row-size=140B cardinality=2.16G cost=4354495421
|  |  |     in pipelines: 89(GETNEXT)
|  |  |
|  |  82:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 83(GETNEXT), 86(GETNEXT)
|  |  |
|  |  |--88:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,94 row-size=377B cardinality=4.32G cost=1890905436
|  |  |  |  in pipelines: 86(GETNEXT), 87(OPEN)
|  |  |  |
|  |  |  |--87:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=94 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 87(GETNEXT)
|  |  |  |
|  |  |  86:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=92 row-size=140B cardinality=4.32G cost=8709277205
|  |  |     in pipelines: 86(GETNEXT)
|  |  |
|  |  85:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=88,90 row-size=333B cardinality=8.64G cost=3781706938
|  |  |  in pipelines: 83(GETNEXT), 84(OPEN)
|  |  |
|  |  |--84:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=90 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 84(GETNEXT)
|  |  |
|  |  83:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=88 row-size=96B cardinality=8.64G cost=11943846410
|  |     in pipelines: 83(GETNEXT)
|  |
|  80:AGGREGATE [FINALIZE]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=87 row-size=36B cardinality=149.12K cost=368471435
|  |  in pipelines: 80(GETNEXT), 74(OPEN)
|  |
|  79:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  fk/pk conjuncts: none
|  |  runtime filters: RF031[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=81,83,85,80 row-size=787B cardinality=254.69M cost=111837302
|  |  in pipelines: 74(GETNEXT), 73(OPEN)
|  |
|  |--73:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=4B cardinality=360.00K cost=1069444
|  |  |  in pipelines: 73(GETNEXT), 71(OPEN)
|  |  |
|  |  72:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.item_7.i_brand_id = BRAND_ID, tpcds_partitioned_parquet_snap.item_7.i_category_id = CATEGORY_ID, tpcds_partitioned_parquet_snap.item_7.i_class_id = CLASS_ID
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  runtime filters: RF039[min_max] <- BRAND_ID, RF040[min_max] <- CATEGORY_ID, RF041[min_max] <- CLASS_ID
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=78,77 row-size=425B cardinality=447.36K cost=620761
|  |  |  in pipelines: 71(GETNEXT), 70(OPEN)
|  |  |
|  |  |--70:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=77 row-size=20B cardinality=447.36K cost=2640587
|  |  |  |  in pipelines: 70(GETNEXT), 63(OPEN), 69(OPEN)
|  |  |  |
|  |  |  48:UNION
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=76 row-size=20B cardinality=447.36K cost=39859
|  |  |  |  in pipelines: 63(GETNEXT), 69(GETNEXT)
|  |  |  |
|  |  |  |--69:AGGREGATE [FINALIZE]
|  |  |  |  |  output: count()
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=75 row-size=20B cardinality=149.12K cost=2967204009
|  |  |  |  |  in pipelines: 69(GETNEXT), 64(OPEN)
|  |  |  |  |
|  |  |  |  68:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  runtime filters: RF051[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=69,71,73 row-size=783B cardinality=2.16G cost=945305506
|  |  |  |  |  in pipelines: 64(GETNEXT), 67(OPEN)
|  |  |  |  |
|  |  |  |  |--67:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=73 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |  |     in pipelines: 67(GETNEXT)
|  |  |  |  |
|  |  |  |  66:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=69,71 row-size=377B cardinality=2.16G(filtered from 2.16G) cost=945148406
|  |  |  |  |  in pipelines: 64(GETNEXT), 65(OPEN)
|  |  |  |  |
|  |  |  |  |--65:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |  |     tuple-ids=71 row-size=237B cardinality=7.30K cost=114705
|  |  |  |  |     in pipelines: 65(GETNEXT)
|  |  |  |  |
|  |  |  |  64:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |  |     runtime filters: RF051[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=2.16G size=145.75GB
|  |  |  |       partitions: 1824/1824 rows=2.16G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |  |     tuple-ids=69 row-size=140B cardinality=2.16G(filtered from 2.16G) cost=4354495421
|  |  |  |     in pipelines: 64(GETNEXT)
|  |  |  |
|  |  |  63:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=68 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 63(GETNEXT), 62(OPEN)
|  |  |  |
|  |  |  62:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=67 row-size=20B cardinality=298.24K cost=1760391
|  |  |  |  in pipelines: 62(GETNEXT), 55(OPEN), 61(OPEN)
|  |  |  |
|  |  |  49:UNION
|  |  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=66 row-size=20B cardinality=298.24K cost=26573
|  |  |  |  in pipelines: 55(GETNEXT), 61(GETNEXT)
|  |  |  |
|  |  |  |--61:AGGREGATE [FINALIZE]
|  |  |  |  |  output: count()
|  |  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=65 row-size=20B cardinality=149.12K cost=5933927815
|  |  |  |  |  in pipelines: 61(GETNEXT), 56(OPEN)
|  |  |  |  |
|  |  |  |  60:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  runtime filters: RF046[bloom] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk, RF047[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  |  tuple-ids=59,61,63 row-size=783B cardinality=4.32G cost=1890313155
|  |  |  |  |  in pipelines: 56(GETNEXT), 59(OPEN)
|  |  |  |  |
|  |  |  |  |--59:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |  |     tuple-ids=63 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  58:HASH JOIN [INNER JOIN]
|  |  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  |  tuple-ids=59,61 row-size=377B cardinality=4.32G(filtered from 4.32G) cost=1890351663
|  |  |  |  |  in pipelines: 56(GETNEXT), 57(OPEN)
|  |  |  |  |
|  |  |  |  |--57:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |  |     stored statistics:
|  |  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |  |       columns: all
|  |  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |  |     tuple-ids=61 row-size=237B cardinality=7.30K cost=114705
|  |  |  |  |     in pipelines: 57(GETNEXT)
|  |  |  |  |
|  |  |  |  56:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |  |     runtime filters: RF047[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF046[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk
|  |  |  |     stored statistics:
|  |  |  |       table: rows=4.32G size=280.96GB
|  |  |  |       partitions: 1831/1831 rows=4.32G
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=140B cardinality=4.32G(filtered from 4.32G) cost=8709277205
|  |  |  |     in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  55:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=58 row-size=20B cardinality=149.12K cost=11866877138
|  |  |  |  in pipelines: 55(GETNEXT), 50(OPEN)
|  |  |  |
|  |  |  54:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  runtime filters: RF042[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk, RF043[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=52,54,56 row-size=739B cardinality=8.64G cost=3780169729
|  |  |  |  in pipelines: 50(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  |--53:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=56 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  52:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=52,54 row-size=333B cardinality=8.64G(filtered from 8.64G) cost=3780599421
|  |  |  |  in pipelines: 50(GETNEXT), 51(OPEN)
|  |  |  |
|  |  |  |--51:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=54 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 51(GETNEXT)
|  |  |  |
|  |  |  50:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |  |     runtime filters: RF043[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk, RF042[bloom] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=8.64G size=389.90GB
|  |  |       partitions: 1824/1824 rows=8.64G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |  |     tuple-ids=52 row-size=96B cardinality=8.64G(filtered from 8.64G) cost=11943846410
|  |  |     in pipelines: 50(GETNEXT)
|  |  |
|  |  71:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_brand_id, RF040[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_category_id, RF041[min_max] -> tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=78 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 71(GETNEXT)
|  |
|  78:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=81,83,85 row-size=783B cardinality=254.69M cost=111869966
|  |  in pipelines: 74(GETNEXT), 77(OPEN)
|  |
|  |--77:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=85 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 77(GETNEXT)
|  |
|  76:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=81,83 row-size=377B cardinality=254.82M cost=111533149
|  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |
|  |--75:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=83 row-size=237B cardinality=108 cost=114705
|  |     in pipelines: 75(GETNEXT)
|  |
|  74:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk, RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=81 row-size=140B cardinality=254.82M(filtered from 4.32G) cost=513709414
|     in pipelines: 74(GETNEXT)
|
47:NESTED LOOP JOIN [INNER JOIN]
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  tuple-ids=35,51 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 34(GETNEXT), 46(OPEN)
|
|--46:AGGREGATE [FINALIZE]
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=51 row-size=16B cardinality=1 cost=1058398679
|  |  in pipelines: 46(GETNEXT), 37(OPEN), 40(OPEN), 43(OPEN)
|  |
|  35:UNION
|  |  pass-through-operands: 36
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=49 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 37(GETNEXT), 40(GETNEXT), 43(GETNEXT)
|  |
|  |--45:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=45,47 row-size=377B cardinality=2.16G cost=945425284
|  |  |  in pipelines: 43(GETNEXT), 44(OPEN)
|  |  |
|  |  |--44:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=47 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 44(GETNEXT)
|  |  |
|  |  43:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=45 row-size=140B cardinality=2.16G cost=4354495421
|  |     in pipelines: 43(GETNEXT)
|  |
|  36:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=44 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 37(GETNEXT), 40(GETNEXT)
|  |
|  |--42:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=40,42 row-size=377B cardinality=4.32G cost=1890905436
|  |  |  in pipelines: 40(GETNEXT), 41(OPEN)
|  |  |
|  |  |--41:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=42 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 41(GETNEXT)
|  |  |
|  |  40:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=40 row-size=140B cardinality=4.32G cost=8709277205
|  |     in pipelines: 40(GETNEXT)
|  |
|  39:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=36,38 row-size=333B cardinality=8.64G cost=3781706938
|  |  in pipelines: 37(GETNEXT), 38(OPEN)
|  |
|  |--38:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=38 row-size=237B cardinality=7.30K cost=114705
|  |     in pipelines: 38(GETNEXT)
|  |
|  37:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=36 row-size=96B cardinality=8.64G cost=11943846410
|     in pipelines: 37(GETNEXT)
|
34:AGGREGATE [FINALIZE]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=35 row-size=36B cardinality=149.12K cost=738702698
|  in pipelines: 34(GETNEXT), 02(OPEN)
|
33:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  runtime filters: RF001[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=0,2,4,34 row-size=743B cardinality=511.06M cost=224118221
|  in pipelines: 02(GETNEXT), 32(OPEN)
|
|--32:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=34 row-size=4B cardinality=360.00K cost=1069444
|  |  in pipelines: 32(GETNEXT), 30(OPEN)
|  |
|  31:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.item_3.i_brand_id = BRAND_ID, tpcds_partitioned_parquet_snap.item_3.i_category_id = CATEGORY_ID, tpcds_partitioned_parquet_snap.item_3.i_class_id = CLASS_ID
|  |  fk/pk conjuncts: assumed fk/pk
|  |  runtime filters: RF009[min_max] <- BRAND_ID, RF010[min_max] <- CATEGORY_ID, RF011[min_max] <- CLASS_ID
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=32,31 row-size=425B cardinality=447.36K cost=620761
|  |  in pipelines: 30(GETNEXT), 29(OPEN)
|  |
|  |--29:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=31 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 29(GETNEXT), 22(OPEN), 28(OPEN)
|  |  |
|  |  07:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=39859
|  |  |  in pipelines: 22(GETNEXT), 28(GETNEXT)
|  |  |
|  |  |--28:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=29 row-size=20B cardinality=149.12K cost=2967204009
|  |  |  |  in pipelines: 28(GETNEXT), 23(OPEN)
|  |  |  |
|  |  |  27:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  runtime filters: RF020[bloom] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk, RF021[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=23,25,27 row-size=783B cardinality=2.16G cost=945305506
|  |  |  |  in pipelines: 23(GETNEXT), 26(OPEN)
|  |  |  |
|  |  |  |--26:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=27 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 26(GETNEXT)
|  |  |  |
|  |  |  25:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=23,25 row-size=377B cardinality=2.16G(filtered from 2.16G) cost=945148406
|  |  |  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |  |  |
|  |  |  |--24:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=25 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 24(GETNEXT)
|  |  |  |
|  |  |  23:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF021[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk, RF020[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=23 row-size=140B cardinality=2.16G(filtered from 2.16G) cost=4354495421
|  |  |     in pipelines: 23(GETNEXT)
|  |  |
|  |  22:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=22 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 22(GETNEXT), 21(OPEN)
|  |  |
|  |  21:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 21(GETNEXT), 14(OPEN), 20(OPEN)
|  |  |
|  |  08:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=20 row-size=20B cardinality=298.24K cost=26573
|  |  |  in pipelines: 14(GETNEXT), 20(GETNEXT)
|  |  |
|  |  |--20:AGGREGATE [FINALIZE]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=19 row-size=20B cardinality=149.12K cost=5933927815
|  |  |  |  in pipelines: 20(GETNEXT), 15(OPEN)
|  |  |  |
|  |  |  19:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  runtime filters: RF016[bloom] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk, RF017[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=13,15,17 row-size=783B cardinality=4.32G cost=1890313155
|  |  |  |  in pipelines: 15(GETNEXT), 18(OPEN)
|  |  |  |
|  |  |  |--18:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=17 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  17:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=13,15 row-size=377B cardinality=4.32G(filtered from 4.32G) cost=1890351663
|  |  |  |  in pipelines: 15(GETNEXT), 16(OPEN)
|  |  |  |
|  |  |  |--16:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=15 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 16(GETNEXT)
|  |  |  |
|  |  |  15:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF017[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk, RF016[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=13 row-size=140B cardinality=4.32G(filtered from 4.32G) cost=8709277205
|  |  |     in pipelines: 15(GETNEXT)
|  |  |
|  |  14:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=12 row-size=20B cardinality=149.12K cost=11866877138
|  |  |  in pipelines: 14(GETNEXT), 09(OPEN)
|  |  |
|  |  13:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  runtime filters: RF012[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF013[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=6,8,10 row-size=739B cardinality=8.64G cost=3780169729
|  |  |  in pipelines: 09(GETNEXT), 12(OPEN)
|  |  |
|  |  |--12:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 12(GETNEXT)
|  |  |
|  |  11:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=2.88MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=6,8 row-size=333B cardinality=8.64G(filtered from 8.64G) cost=3780599421
|  |  |  in pipelines: 09(GETNEXT), 10(OPEN)
|  |  |
|  |  |--10:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=8 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 10(GETNEXT)
|  |  |
|  |  09:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF013[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk, RF012[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=6 row-size=96B cardinality=8.64G(filtered from 8.64G) cost=11943846410
|  |     in pipelines: 09(GETNEXT)
|  |
|  30:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF009[min_max] -> tpcds_partitioned_parquet_snap.item_3.i_brand_id, RF010[min_max] -> tpcds_partitioned_parquet_snap.item_3.i_category_id, RF011[min_max] -> tpcds_partitioned_parquet_snap.item_3.i_class_id
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=32 row-size=405B cardinality=360.00K cost=1355609
|     in pipelines: 30(GETNEXT)
|
06:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=151.22MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=739B cardinality=511.32M cost=224230100
|  in pipelines: 02(GETNEXT), 05(OPEN)
|
|--05:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=405B cardinality=360.00K cost=1355609
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=333B cardinality=511.58M cost=223916534
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=2 row-size=237B cardinality=108 cost=114705
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=96B cardinality=511.58M(filtered from 8.64G) cost=707201433
   in pipelines: 02(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=14.70GB Threads=345
Per-Host Resource Estimates: Memory=38.62GB
F96:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.05MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[634] cpu-comparison-result=1557 [max(1 (self) vs 1557 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(160,161,162,158,159) WHEN 158 THEN CHANNEL WHEN 159 THEN CHANNEL WHEN 160 THEN CHANNEL WHEN 161 THEN CHANNEL WHEN 162 THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_BRAND_ID WHEN 159 THEN I_BRAND_ID WHEN 160 THEN I_BRAND_ID WHEN 161 THEN NULL WHEN 162 THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CLASS_ID WHEN 159 THEN I_CLASS_ID WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CATEGORY_ID WHEN 159 THEN NULL WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END, aggif(valid_tid(160,161,162,158,159) IN (158, 159, 160, 161, 162), CASE valid_tid(160,161,162,158,159) WHEN 158 THEN sum(SALES) WHEN 159 THEN sum(SALES) WHEN 160 THEN sum(SALES) WHEN 161 THEN sum(SALES) WHEN 162 THEN sum(SALES) END), aggif(valid_tid(160,161,162,158,159) IN (158, 159, 160, 161, 162), CASE valid_tid(160,161,162,158,159) WHEN 158 THEN sum(NUMBER_SALES) WHEN 159 THEN sum(NUMBER_SALES) WHEN 160 THEN sum(NUMBER_SALES) WHEN 161 THEN sum(NUMBER_SALES) WHEN 162 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
235:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(160,161,162,158,159) WHEN 158 THEN CHANNEL WHEN 159 THEN CHANNEL WHEN 160 THEN CHANNEL WHEN 161 THEN CHANNEL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_BRAND_ID WHEN 159 THEN I_BRAND_ID WHEN 160 THEN I_BRAND_ID WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CLASS_ID WHEN 159 THEN I_CLASS_ID WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CATEGORY_ID WHEN 159 THEN NULL WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=51.25KB mem-reservation=0B thread-reservation=0
|  tuple-ids=164 row-size=48B cardinality=100 cost=34
|  in pipelines: 142(GETNEXT)
|
F95:PLAN FRAGMENT [HASH(CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(CHANNEL) WHEN 160 THEN murmur_hash(CHANNEL) WHEN 161 THEN murmur_hash(CHANNEL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_BRAND_ID) WHEN 159 THEN murmur_hash(I_BRAND_ID) WHEN 160 THEN murmur_hash(I_BRAND_ID) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_CLASS_ID) WHEN 159 THEN murmur_hash(I_CLASS_ID) WHEN 160 THEN murmur_hash(NULL) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_CATEGORY_ID) WHEN 159 THEN murmur_hash(NULL) WHEN 160 THEN murmur_hash(NULL) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=650.00MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=10 segment-costs=[13125702, 10687615, 20955666, 157] cpu-comparison-result=1557 [max(10 (self) vs 1557 (sum children))]
142:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(160,161,162,158,159) WHEN 158 THEN CHANNEL WHEN 159 THEN CHANNEL WHEN 160 THEN CHANNEL WHEN 161 THEN CHANNEL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_BRAND_ID WHEN 159 THEN I_BRAND_ID WHEN 160 THEN I_BRAND_ID WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CLASS_ID WHEN 159 THEN I_CLASS_ID WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CATEGORY_ID WHEN 159 THEN NULL WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=164 row-size=48B cardinality=100 cost=20955666
|  in pipelines: 142(GETNEXT), 141(OPEN)
|
141:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(160,161,162,158,159) IN (CAST(158 AS INT), CAST(159 AS INT), CAST(160 AS INT), CAST(161 AS INT), CAST(162 AS INT)), CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN sum(SALES) WHEN CAST(159 AS INT) THEN sum(SALES) WHEN CAST(160 AS INT) THEN sum(SALES) WHEN CAST(161 AS INT) THEN sum(SALES) WHEN CAST(162 AS INT) THEN sum(SALES) END), aggif(valid_tid(160,161,162,158,159) IN (CAST(158 AS INT), CAST(159 AS INT), CAST(160 AS INT), CAST(161 AS INT), CAST(162 AS INT)), CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(159 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(160 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(161 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(162 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN CHANNEL WHEN CAST(159 AS INT) THEN CHANNEL WHEN CAST(160 AS INT) THEN CHANNEL WHEN CAST(161 AS INT) THEN CHANNEL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN I_BRAND_ID WHEN CAST(159 AS INT) THEN I_BRAND_ID WHEN CAST(160 AS INT) THEN I_BRAND_ID WHEN CAST(161 AS INT) THEN NULL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN I_CLASS_ID WHEN CAST(159 AS INT) THEN I_CLASS_ID WHEN CAST(160 AS INT) THEN NULL WHEN CAST(161 AS INT) THEN NULL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN I_CATEGORY_ID WHEN CAST(159 AS INT) THEN NULL WHEN CAST(160 AS INT) THEN NULL WHEN CAST(161 AS INT) THEN NULL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN CAST(158 AS INT) WHEN CAST(159 AS INT) THEN CAST(159 AS INT) WHEN CAST(160 AS INT) THEN CAST(160 AS INT) WHEN CAST(161 AS INT) THEN CAST(161 AS INT) WHEN CAST(162 AS INT) THEN CAST(162 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=163 row-size=52B cardinality=1.79M cost=10687615
|  in pipelines: 141(GETNEXT), 234(OPEN)
|
234:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=158N,159N,160N,161N,162N row-size=240B cardinality=1.79M cost=10687785
|  in pipelines: 234(GETNEXT), 166(OPEN), 196(OPEN), 226(OPEN)
|
233:EXCHANGE [HASH(CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(CHANNEL) WHEN 160 THEN murmur_hash(CHANNEL) WHEN 161 THEN murmur_hash(CHANNEL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_BRAND_ID) WHEN 159 THEN murmur_hash(I_BRAND_ID) WHEN 160 THEN murmur_hash(I_BRAND_ID) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_CLASS_ID) WHEN 159 THEN murmur_hash(I_CLASS_ID) WHEN 160 THEN murmur_hash(NULL) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_CATEGORY_ID) WHEN 159 THEN murmur_hash(NULL) WHEN 160 THEN murmur_hash(NULL) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END)]
|  mem-estimate=37.68MB mem-reservation=0B thread-reservation=0
|  tuple-ids=158N,159N,160N,161N,162N row-size=240B cardinality=1.79M cost=2437917
|  in pipelines: 166(GETNEXT), 196(GETNEXT), 226(GETNEXT)
|
F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Instance Resources: mem-estimate=556.41MB mem-reservation=146.50MB thread-reservation=1
max-parallelism=109 segment-costs=[31467972, 31467972, 31443812, 11505411, 32269345] cpu-comparison-result=1557 [max(109 (self) vs 1557 (sum children))]
140:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=158N,159N,160N,161N,162N row-size=240B cardinality=1.79M cost=11334183
|  in pipelines: 166(GETNEXT), 196(GETNEXT), 226(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=157 row-size=48B cardinality=447.36K cost=26522
|  in pipelines: 166(GETNEXT), 196(GETNEXT), 226(GETNEXT)
|
|--139:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_4.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_4.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=140,156 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 226(GETNEXT), 231(OPEN)
|  |
|  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  232:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=156 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 231(GETNEXT)
|  |  |
|  |  F93:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  231:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=156 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 231(GETNEXT), 138(OPEN)
|  |  |
|  |  230:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=155 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 138(GETNEXT)
|  |  |
|  |  F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[33456059694, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  138:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=155 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 138(GETNEXT), 129(OPEN), 132(OPEN), 135(OPEN)
|  |  |
|  |  127:UNION
|  |  |  pass-through-operands: 128
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=154 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 129(GETNEXT), 132(GETNEXT), 135(GETNEXT)
|  |  |
|  |  |--137:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=150,152 row-size=377B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 135(GETNEXT), 136(OPEN)
|  |  |  |
|  |  |  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  229:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=152 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 136(GETNEXT)
|  |  |  |  |
|  |  |  |  F91:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  136:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=152 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 136(GETNEXT)
|  |  |  |
|  |  |  135:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=150 row-size=140B cardinality=2.16G cost=4354495421
|  |  |     in pipelines: 135(GETNEXT)
|  |  |
|  |  128:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=149 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 129(GETNEXT), 132(GETNEXT)
|  |  |
|  |  |--134:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=145,147 row-size=377B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 132(GETNEXT), 133(OPEN)
|  |  |  |
|  |  |  |--F107:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  228:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=147 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 133(GETNEXT)
|  |  |  |  |
|  |  |  |  F88:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  133:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=147 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 133(GETNEXT)
|  |  |  |
|  |  |  132:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=145 row-size=140B cardinality=4.32G cost=8709277205
|  |  |     in pipelines: 132(GETNEXT)
|  |  |
|  |  131:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=141,143 row-size=333B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  227:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=143 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 130(GETNEXT)
|  |  |  |
|  |  |  F86:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=143 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 130(GETNEXT)
|  |  |
|  |  129:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=141 row-size=96B cardinality=8.64G cost=11943846410
|  |     in pipelines: 129(GETNEXT)
|  |
|  226:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.web_sales_4.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_4.ws_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=140 row-size=36B cardinality=149.12K cost=26496317
|  |  in pipelines: 226(GETNEXT), 120(OPEN)
|  |
|  225:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_13.i_brand_id,tpcds_partitioned_parquet_snap.item_13.i_class_id,tpcds_partitioned_parquet_snap.item_13.i_category_id)]
|  |  mem-estimate=12.73MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=140 row-size=36B cardinality=17.88M cost=4947495
|  |  in pipelines: 120(GETNEXT)
|  |
|  F63:PLAN FRAGMENT [RANDOM] hosts=10 instances=70 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=9.26MB thread-reservation=1
|  max-parallelism=70 segment-costs=[691297462, 50665788] cpu-comparison-result=399 [max(70 (self) vs 399 (sum children))]
|  126:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_4.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_4.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=140 row-size=36B cardinality=17.88M cost=265568963
|  |  in pipelines: 120(GETNEXT)
|  |
|  125:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=32
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=134,136,138,133 row-size=787B cardinality=127.83M cost=55950721
|  |  in pipelines: 120(GETNEXT), 223(OPEN)
|  |
|  |--F129:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=120.45MB mem-reservation=119.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=32 plan-id=33 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  runtime filters: RF061[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=119.00MB mem-reservation=119.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  224:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 223(GETNEXT)
|  |  |
|  |  F83:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_12.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  223:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=133 row-size=4B cardinality=360.00K cost=1068777
|  |  |  in pipelines: 223(GETNEXT), 220(OPEN)
|  |  |
|  |  222:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_item_sk)]
|  |  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133 row-size=4B cardinality=445.08K cost=57637
|  |  |  in pipelines: 220(GETNEXT)
|  |  |
|  |  F81:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  119:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=133 row-size=4B cardinality=445.08K cost=1291265
|  |  |  in pipelines: 220(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=33
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_12.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_12.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  |  tuple-ids=130,131 row-size=425B cardinality=447.36K cost=195809
|  |  |  in pipelines: 220(GETNEXT), 117(OPEN)
|  |  |
|  |  |--F130:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=28.60MB mem-reservation=17.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[1071501]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_category_id, tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |  |  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  221:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_brand_id,tpcds_partitioned_parquet_snap.item_12.i_class_id,tpcds_partitioned_parquet_snap.item_12.i_category_id)]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=131 row-size=405B cardinality=360.00K cost=711501
|  |  |  |  in pipelines: 117(GETNEXT)
|  |  |  |
|  |  |  F82:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[10942162]
|  |  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=131 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 117(GETNEXT)
|  |  |
|  |  220:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 220(GETNEXT), 109(OPEN), 218(OPEN)
|  |  |
|  |  219:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=130 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 109(GETNEXT), 218(GETNEXT)
|  |  |
|  |  F80:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=384.94MB mem-reservation=102.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[1820963, 1760391, 28898336, 2680446, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  116:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 109(GETNEXT), 218(GETNEXT)
|  |  |
|  |  94:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=129 row-size=20B cardinality=447.36K cost=39859
|  |  |  in pipelines: 109(GETNEXT), 218(GETNEXT)
|  |  |
|  |  |--218:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=128 row-size=20B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 218(GETNEXT), 110(OPEN)
|  |  |  |
|  |  |  217:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_11.i_brand_id,tpcds_partitioned_parquet_snap.item_11.i_class_id,tpcds_partitioned_parquet_snap.item_11.i_category_id)]
|  |  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=128 row-size=20B cardinality=17.89M cost=3634352
|  |  |  |  in pipelines: 110(GETNEXT)
|  |  |  |
|  |  |  F76:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=9.26MB thread-reservation=1
|  |  |  max-parallelism=930 segment-costs=[9292145537, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  115:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=128 row-size=20B cardinality=17.89M cost=3047563509
|  |  |  |  in pipelines: 110(GETNEXT)
|  |  |  |
|  |  |  114:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=38
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=122,124,126 row-size=783B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 110(GETNEXT), 113(OPEN)
|  |  |  |
|  |  |  |--F135:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=419.60MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=38 plan-id=39 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  runtime filters: RF081[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  216:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=126 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 113(GETNEXT)
|  |  |  |  |
|  |  |  |  F78:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  |  113:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=126 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 113(GETNEXT)
|  |  |  |
|  |  |  112:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=39
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=122,124 row-size=377B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  |  in pipelines: 110(GETNEXT), 111(OPEN)
|  |  |  |
|  |  |  |--F136:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  215:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=124 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 111(GETNEXT)
|  |  |  |  |
|  |  |  |  F77:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  111:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=124 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 111(GETNEXT)
|  |  |  |
|  |  |  110:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF081[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=122 row-size=140B cardinality=2.16G(filtered from 2.16G) cost=4354495421
|  |  |     in pipelines: 110(GETNEXT)
|  |  |
|  |  109:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=121 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 109(GETNEXT), 214(OPEN)
|  |  |
|  |  214:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=120 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 214(GETNEXT), 208(OPEN), 212(OPEN)
|  |  |
|  |  213:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=120 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |
|  |  F74:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=162.06MB mem-reservation=42.50MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28898336, 28898336, 1786964, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  108:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=120 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |
|  |  95:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=119 row-size=20B cardinality=298.24K cost=26573
|  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |
|  |  |--212:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=118 row-size=20B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 212(GETNEXT), 102(OPEN)
|  |  |  |
|  |  |  211:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_10.i_brand_id,tpcds_partitioned_parquet_snap.item_10.i_class_id,tpcds_partitioned_parquet_snap.item_10.i_category_id)]
|  |  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=118 row-size=20B cardinality=17.89M cost=3634352
|  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=10.00MB thread-reservation=1
|  |  |  max-parallelism=1831 segment-costs=[18503862033, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  107:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=118 row-size=20B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  106:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=36
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=112,114,116 row-size=783B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 102(GETNEXT), 105(OPEN)
|  |  |  |
|  |  |  |--F133:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=36 plan-id=37 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  runtime filters: RF076[bloom] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk, RF077[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=116 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 105(GETNEXT)
|  |  |  |  |
|  |  |  |  F72:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  |  105:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=116 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 105(GETNEXT)
|  |  |  |
|  |  |  104:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=37
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=112,114 row-size=377B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  in pipelines: 102(GETNEXT), 103(OPEN)
|  |  |  |
|  |  |  |--F134:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=37 plan-id=38 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  209:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=114 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 103(GETNEXT)
|  |  |  |  |
|  |  |  |  F71:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  103:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=114 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 103(GETNEXT)
|  |  |  |
|  |  |  102:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF077[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk, RF076[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=112 row-size=140B cardinality=4.32G(filtered from 4.32G) cost=8709277205
|  |  |     in pipelines: 102(GETNEXT)
|  |  |
|  |  208:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=111 row-size=20B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 208(GETNEXT), 96(OPEN)
|  |  |
|  |  207:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_brand_id,tpcds_partitioned_parquet_snap.item_9.i_class_id,tpcds_partitioned_parquet_snap.item_9.i_category_id)]
|  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=111 row-size=20B cardinality=17.89M cost=3634352
|  |  |  in pipelines: 96(GETNEXT)
|  |  |
|  |  F66:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=17.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[31451484894, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  101:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=111 row-size=20B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 96(GETNEXT)
|  |  |
|  |  100:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=34
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=105,107,109 row-size=739B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 96(GETNEXT), 99(OPEN)
|  |  |
|  |  |--F131:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  runtime filters: RF072[bloom] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk, RF073[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  206:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=109 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  99:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=109 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 99(GETNEXT)
|  |  |
|  |  98:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=35
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=105,107 row-size=333B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  in pipelines: 96(GETNEXT), 97(OPEN)
|  |  |
|  |  |--F132:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=35 plan-id=36 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  205:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=107 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 97(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  97:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=107 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 97(GETNEXT)
|  |  |
|  |  96:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk, RF072[bloom] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=105 row-size=96B cardinality=8.64G(filtered from 8.64G) cost=11943846410
|  |     in pipelines: 96(GETNEXT)
|  |
|  124:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=40
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=134,136,138 row-size=783B cardinality=127.83M cost=55967115
|  |  in pipelines: 120(GETNEXT), 123(OPEN)
|  |
|  |--F137:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=249.60MB mem-reservation=238.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=40 plan-id=41 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  mem-estimate=238.00MB mem-reservation=238.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  204:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=138 row-size=405B cardinality=360.00K cost=478440
|  |  |  in pipelines: 123(GETNEXT)
|  |  |
|  |  F65:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[1757529]
|  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=138 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 123(GETNEXT)
|  |
|  122:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=41
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=134,136 row-size=377B cardinality=127.89M cost=55978696
|  |  in pipelines: 120(GETNEXT), 121(OPEN)
|  |
|  |--F138:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=14.61MB mem-reservation=14.56MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=41 plan-id=42 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=13.56MB mem-reservation=13.56MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  203:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=50.45KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=136 row-size=237B cardinality=108 cost=140
|  |  |  in pipelines: 121(GETNEXT)
|  |  |
|  |  F64:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[114776]
|  |  121:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=136 row-size=237B cardinality=108 cost=114705
|  |     in pipelines: 121(GETNEXT)
|  |
|  120:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk, RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|     tuple-ids=134 row-size=140B cardinality=127.89M(filtered from 2.16G) cost=257831967
|     in pipelines: 120(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=104 row-size=48B cardinality=298.24K cost=53044
|  in pipelines: 166(GETNEXT), 196(GETNEXT)
|
|--93:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=87,103 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 196(GETNEXT), 201(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  202:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=103 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 201(GETNEXT)
|  |  |
|  |  F61:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  201:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=103 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 201(GETNEXT), 92(OPEN)
|  |  |
|  |  200:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=102 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 92(GETNEXT)
|  |  |
|  |  F60:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[33456059694, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  92:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=102 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 92(GETNEXT), 83(OPEN), 86(OPEN), 89(OPEN)
|  |  |
|  |  81:UNION
|  |  |  pass-through-operands: 82
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=101 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 83(GETNEXT), 86(GETNEXT), 89(GETNEXT)
|  |  |
|  |  |--91:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=97,99 row-size=377B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |  |  |
|  |  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  199:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=99 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 90(GETNEXT)
|  |  |  |  |
|  |  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  90:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=99 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 90(GETNEXT)
|  |  |  |
|  |  |  89:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=97 row-size=140B cardinality=2.16G cost=4354495421
|  |  |     in pipelines: 89(GETNEXT)
|  |  |
|  |  82:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 83(GETNEXT), 86(GETNEXT)
|  |  |
|  |  |--88:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,94 row-size=377B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 86(GETNEXT), 87(OPEN)
|  |  |  |
|  |  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  198:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=94 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 87(GETNEXT)
|  |  |  |  |
|  |  |  |  F56:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=94 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 87(GETNEXT)
|  |  |  |
|  |  |  86:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=92 row-size=140B cardinality=4.32G cost=8709277205
|  |  |     in pipelines: 86(GETNEXT)
|  |  |
|  |  85:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=88,90 row-size=333B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 83(GETNEXT), 84(OPEN)
|  |  |
|  |  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  197:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=90 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 84(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  84:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=90 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 84(GETNEXT)
|  |  |
|  |  83:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=88 row-size=96B cardinality=8.64G cost=11943846410
|  |     in pipelines: 83(GETNEXT)
|  |
|  196:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=87 row-size=36B cardinality=149.12K cost=26516592
|  |  in pipelines: 196(GETNEXT), 74(OPEN)
|  |
|  195:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_8.i_brand_id,tpcds_partitioned_parquet_snap.item_8.i_class_id,tpcds_partitioned_parquet_snap.item_8.i_category_id)]
|  |  mem-estimate=14.26MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=87 row-size=36B cardinality=17.89M cost=4951380
|  |  in pipelines: 74(GETNEXT)
|  |
|  F31:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=109 segment-costs=[1297060658, 50705571] cpu-comparison-result=399 [max(109 (self) vs 399 (sum children))]
|  80:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=87 row-size=36B cardinality=17.89M cost=448830935
|  |  in pipelines: 74(GETNEXT)
|  |
|  79:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=81,83,85,80 row-size=787B cardinality=254.69M cost=111477302
|  |  in pipelines: 74(GETNEXT), 193(OPEN)
|  |
|  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=188.45MB mem-reservation=187.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  runtime filters: RF031[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  194:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=80 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 193(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_7.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  193:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=4B cardinality=360.00K cost=1068777
|  |  |  in pipelines: 193(GETNEXT), 190(OPEN)
|  |  |
|  |  192:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_item_sk)]
|  |  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=80 row-size=4B cardinality=445.08K cost=57637
|  |  |  in pipelines: 190(GETNEXT)
|  |  |
|  |  F49:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  73:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=4B cardinality=445.08K cost=1291265
|  |  |  in pipelines: 190(GETNEXT)
|  |  |
|  |  72:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=23
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_7.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_7.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  |  tuple-ids=77,78 row-size=425B cardinality=447.36K cost=195809
|  |  |  in pipelines: 190(GETNEXT), 71(OPEN)
|  |  |
|  |  |--F120:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=28.60MB mem-reservation=17.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[1071501]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=23 plan-id=24 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_category_id, tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  191:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_brand_id,tpcds_partitioned_parquet_snap.item_7.i_class_id,tpcds_partitioned_parquet_snap.item_7.i_category_id)]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=78 row-size=405B cardinality=360.00K cost=711501
|  |  |  |  in pipelines: 71(GETNEXT)
|  |  |  |
|  |  |  F50:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[10942162]
|  |  |  71:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=78 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 71(GETNEXT)
|  |  |
|  |  190:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=77 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 190(GETNEXT), 63(OPEN), 188(OPEN)
|  |  |
|  |  189:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=77 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 63(GETNEXT), 188(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=384.94MB mem-reservation=102.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[1820963, 1760391, 28898336, 2680446, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  70:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=77 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 63(GETNEXT), 188(GETNEXT)
|  |  |
|  |  48:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=76 row-size=20B cardinality=447.36K cost=39859
|  |  |  in pipelines: 63(GETNEXT), 188(GETNEXT)
|  |  |
|  |  |--188:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=20B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 188(GETNEXT), 64(OPEN)
|  |  |  |
|  |  |  187:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_6.i_brand_id,tpcds_partitioned_parquet_snap.item_6.i_class_id,tpcds_partitioned_parquet_snap.item_6.i_category_id)]
|  |  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=20B cardinality=17.89M cost=3634352
|  |  |  |  in pipelines: 64(GETNEXT)
|  |  |  |
|  |  |  F44:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=9.26MB thread-reservation=1
|  |  |  max-parallelism=930 segment-costs=[9292145537, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  69:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=20B cardinality=17.89M cost=3047563509
|  |  |  |  in pipelines: 64(GETNEXT)
|  |  |  |
|  |  |  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=28
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=69,71,73 row-size=783B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 64(GETNEXT), 67(OPEN)
|  |  |  |
|  |  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=419.60MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  runtime filters: RF051[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  186:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=73 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 67(GETNEXT)
|  |  |  |  |
|  |  |  |  F46:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=73 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 67(GETNEXT)
|  |  |  |
|  |  |  66:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=29
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=69,71 row-size=377B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  |  in pipelines: 64(GETNEXT), 65(OPEN)
|  |  |  |
|  |  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=29 plan-id=30 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  185:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 65(GETNEXT)
|  |  |  |  |
|  |  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  65:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=71 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 65(GETNEXT)
|  |  |  |
|  |  |  64:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF051[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=69 row-size=140B cardinality=2.16G(filtered from 2.16G) cost=4354495421
|  |  |     in pipelines: 64(GETNEXT)
|  |  |
|  |  63:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=68 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 63(GETNEXT), 184(OPEN)
|  |  |
|  |  184:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=67 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 184(GETNEXT), 178(OPEN), 182(OPEN)
|  |  |
|  |  183:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=67 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |
|  |  F42:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=162.06MB mem-reservation=42.50MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28898336, 28898336, 1786964, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  62:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=67 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |
|  |  49:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=66 row-size=20B cardinality=298.24K cost=26573
|  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |
|  |  |--182:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=65 row-size=20B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 182(GETNEXT), 56(OPEN)
|  |  |  |
|  |  |  181:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_5.i_brand_id,tpcds_partitioned_parquet_snap.item_5.i_class_id,tpcds_partitioned_parquet_snap.item_5.i_category_id)]
|  |  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=65 row-size=20B cardinality=17.89M cost=3634352
|  |  |  |  in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=10.00MB thread-reservation=1
|  |  |  max-parallelism=1831 segment-costs=[18503862033, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  61:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=65 row-size=20B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  60:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=26
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=59,61,63 row-size=783B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 56(GETNEXT), 59(OPEN)
|  |  |  |
|  |  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=26 plan-id=27 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  runtime filters: RF046[bloom] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk, RF047[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=63 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F40:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  |  59:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=63 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  58:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=59,61 row-size=377B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  in pipelines: 56(GETNEXT), 57(OPEN)
|  |  |  |
|  |  |  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  179:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 57(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  57:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  56:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF047[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF046[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=59 row-size=140B cardinality=4.32G(filtered from 4.32G) cost=8709277205
|  |  |     in pipelines: 56(GETNEXT)
|  |  |
|  |  178:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=58 row-size=20B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 178(GETNEXT), 50(OPEN)
|  |  |
|  |  177:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_brand_id,tpcds_partitioned_parquet_snap.item_4.i_class_id,tpcds_partitioned_parquet_snap.item_4.i_category_id)]
|  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=58 row-size=20B cardinality=17.89M cost=3634352
|  |  |  in pipelines: 50(GETNEXT)
|  |  |
|  |  F34:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=17.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[31451484894, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  55:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=58 row-size=20B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 50(GETNEXT)
|  |  |
|  |  54:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=24
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=52,54,56 row-size=739B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 50(GETNEXT), 53(OPEN)
|  |  |
|  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  runtime filters: RF042[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk, RF043[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=56 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  F36:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=56 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  52:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=52,54 row-size=333B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  in pipelines: 50(GETNEXT), 51(OPEN)
|  |  |
|  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  175:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=54 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 51(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  51:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=54 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 51(GETNEXT)
|  |  |
|  |  50:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF043[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk, RF042[bloom] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=52 row-size=96B cardinality=8.64G(filtered from 8.64G) cost=11943846410
|  |     in pipelines: 50(GETNEXT)
|  |
|  78:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=30
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=81,83,85 row-size=783B cardinality=254.69M cost=111509966
|  |  in pipelines: 74(GETNEXT), 77(OPEN)
|  |
|  |--F127:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=385.60MB mem-reservation=374.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=30 plan-id=31 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  174:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=85 row-size=405B cardinality=360.00K cost=478440
|  |  |  in pipelines: 77(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[1757529]
|  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=85 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 77(GETNEXT)
|  |
|  76:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=31
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=81,83 row-size=377B cardinality=254.82M cost=111533041
|  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |
|  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=22.36MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=31 plan-id=32 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  173:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=50.45KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=83 row-size=237B cardinality=108 cost=140
|  |  |  in pipelines: 75(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[114776]
|  |  75:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=83 row-size=237B cardinality=108 cost=114705
|  |     in pipelines: 75(GETNEXT)
|  |
|  74:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk, RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=81 row-size=140B cardinality=254.82M(filtered from 4.32G) cost=513709414
|     in pipelines: 74(GETNEXT)
|
47:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=35,51 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 166(GETNEXT), 171(OPEN)
|
|--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  172:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=51 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 171(GETNEXT)
|  |
|  F30:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  171:AGGREGATE [FINALIZE]
|  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=51 row-size=16B cardinality=1 cost=8
|  |  in pipelines: 171(GETNEXT), 46(OPEN)
|  |
|  170:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=50 row-size=16B cardinality=120 cost=22
|  |  in pipelines: 46(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[33456059694, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  46:AGGREGATE
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=50 row-size=16B cardinality=120 cost=1058398679
|  |  in pipelines: 46(GETNEXT), 37(OPEN), 40(OPEN), 43(OPEN)
|  |
|  35:UNION
|  |  pass-through-operands: 36
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=49 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 37(GETNEXT), 40(GETNEXT), 43(GETNEXT)
|  |
|  |--45:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=45,47 row-size=377B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 43(GETNEXT), 44(OPEN)
|  |  |
|  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  169:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=47 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 44(GETNEXT)
|  |  |  |
|  |  |  F28:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  44:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=47 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 44(GETNEXT)
|  |  |
|  |  43:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=45 row-size=140B cardinality=2.16G cost=4354495421
|  |     in pipelines: 43(GETNEXT)
|  |
|  36:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=44 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 37(GETNEXT), 40(GETNEXT)
|  |
|  |--42:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=40,42 row-size=377B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 40(GETNEXT), 41(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  168:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=42 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 41(GETNEXT)
|  |  |  |
|  |  |  F25:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  41:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=42 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 41(GETNEXT)
|  |  |
|  |  40:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=40 row-size=140B cardinality=4.32G cost=8709277205
|  |     in pipelines: 40(GETNEXT)
|  |
|  39:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=36,38 row-size=333B cardinality=8.64G cost=3781699633
|  |  in pipelines: 37(GETNEXT), 38(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |
|  |  167:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=38 row-size=237B cardinality=7.30K cost=9700
|  |  |  in pipelines: 38(GETNEXT)
|  |  |
|  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[119540]
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=38 row-size=237B cardinality=7.30K cost=114705
|  |     in pipelines: 38(GETNEXT)
|  |
|  37:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=36 row-size=96B cardinality=8.64G cost=11943846410
|     in pipelines: 37(GETNEXT)
|
166:AGGREGATE [FINALIZE]
|  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count:merge()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=35 row-size=36B cardinality=149.12K cost=26516592
|  in pipelines: 166(GETNEXT), 02(OPEN)
|
165:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_brand_id,tpcds_partitioned_parquet_snap.item.i_class_id,tpcds_partitioned_parquet_snap.item.i_category_id)]
|  mem-estimate=14.26MB mem-reservation=0B thread-reservation=0
|  tuple-ids=35 row-size=36B cardinality=17.89M cost=4951380
|  in pipelines: 02(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
Per-Instance Resources: mem-estimate=43.03MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=109 segment-costs=[2197808378, 50705571] cpu-comparison-result=399 [max(109 (self) vs 399 (sum children))]
34:AGGREGATE [STREAMING]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=35 row-size=36B cardinality=17.89M cost=819062198
|  in pipelines: 02(GETNEXT)
|
33:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=0,2,4,34 row-size=743B cardinality=511.06M cost=223758221
|  in pipelines: 02(GETNEXT), 163(OPEN)
|
|--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=188.45MB mem-reservation=187.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  runtime filters: RF001[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |
|  164:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=34 row-size=4B cardinality=360.00K cost=478440
|  |  in pipelines: 163(GETNEXT)
|  |
|  F20:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_3.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  163:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34 row-size=4B cardinality=360.00K cost=1068777
|  |  in pipelines: 163(GETNEXT), 160(OPEN)
|  |
|  162:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_item_sk)]
|  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=34 row-size=4B cardinality=445.08K cost=57637
|  |  in pipelines: 160(GETNEXT)
|  |
|  F18:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  32:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34 row-size=4B cardinality=445.08K cost=1291265
|  |  in pipelines: 160(GETNEXT)
|  |
|  31:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_3.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_3.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_3.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=31,32 row-size=425B cardinality=447.36K cost=195809
|  |  in pipelines: 160(GETNEXT), 30(OPEN)
|  |
|  |--F110:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=28.60MB mem-reservation=17.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[1071501]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_category_id, tpcds_partitioned_parquet_snap.item_3.i_class_id
|  |  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  161:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_brand_id,tpcds_partitioned_parquet_snap.item_3.i_class_id,tpcds_partitioned_parquet_snap.item_3.i_category_id)]
|  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=32 row-size=405B cardinality=360.00K cost=711501
|  |  |  in pipelines: 30(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[10942162]
|  |  30:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=32 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 30(GETNEXT)
|  |
|  160:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 160(GETNEXT), 22(OPEN), 158(OPEN)
|  |
|  159:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=20B cardinality=447.36K cost=90858
|  |  in pipelines: 22(GETNEXT), 158(GETNEXT)
|  |
|  F17:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=384.94MB mem-reservation=102.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[1820963, 1760391, 28898336, 2680446, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  29:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 22(GETNEXT), 158(GETNEXT)
|  |
|  07:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=39859
|  |  in pipelines: 22(GETNEXT), 158(GETNEXT)
|  |
|  |--158:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=29 row-size=20B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 158(GETNEXT), 23(OPEN)
|  |  |
|  |  157:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_brand_id,tpcds_partitioned_parquet_snap.item_2.i_class_id,tpcds_partitioned_parquet_snap.item_2.i_category_id)]
|  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=29 row-size=20B cardinality=17.89M cost=3634352
|  |  |  in pipelines: 23(GETNEXT)
|  |  |
|  |  F13:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=9.26MB thread-reservation=1
|  |  max-parallelism=930 segment-costs=[9292145537, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  28:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=29 row-size=20B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 23(GETNEXT)
|  |  |
|  |  27:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=23,25,27 row-size=783B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 23(GETNEXT), 26(OPEN)
|  |  |
|  |  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  runtime filters: RF020[bloom] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk, RF021[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  156:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=27 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 26(GETNEXT)
|  |  |  |
|  |  |  F15:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  26:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=27 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 26(GETNEXT)
|  |  |
|  |  25:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=19
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=23,25 row-size=377B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |  |
|  |  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=19 plan-id=20 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  155:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=25 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 24(GETNEXT)
|  |  |  |
|  |  |  F14:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  24:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=25 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 24(GETNEXT)
|  |  |
|  |  23:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF021[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk, RF020[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=23 row-size=140B cardinality=2.16G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 23(GETNEXT)
|  |
|  22:AGGREGATE [FINALIZE]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=22 row-size=20B cardinality=298.24K cost=1760391
|  |  in pipelines: 22(GETNEXT), 154(OPEN)
|  |
|  154:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  in pipelines: 154(GETNEXT), 148(OPEN), 152(OPEN)
|  |
|  153:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=60572
|  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |
|  F11:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=162.06MB mem-reservation=42.50MB thread-reservation=1
|  max-parallelism=120 segment-costs=[28898336, 28898336, 1786964, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  21:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |
|  08:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=20 row-size=20B cardinality=298.24K cost=26573
|  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |
|  |--152:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=19 row-size=20B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 152(GETNEXT), 15(OPEN)
|  |  |
|  |  151:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_brand_id,tpcds_partitioned_parquet_snap.item_1.i_class_id,tpcds_partitioned_parquet_snap.item_1.i_category_id)]
|  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=19 row-size=20B cardinality=17.89M cost=3634352
|  |  |  in pipelines: 15(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=10.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[18503862033, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  20:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=19 row-size=20B cardinality=17.89M cost=6014287315
|  |  |  in pipelines: 15(GETNEXT)
|  |  |
|  |  19:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=13,15,17 row-size=783B cardinality=4.32G cost=1889953155
|  |  |  in pipelines: 15(GETNEXT), 18(OPEN)
|  |  |
|  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  runtime filters: RF016[bloom] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk, RF017[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  150:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=17 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  18:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=17 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 18(GETNEXT)
|  |  |
|  |  17:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=13,15 row-size=377B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  in pipelines: 15(GETNEXT), 16(OPEN)
|  |  |
|  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  149:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=15 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 16(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=15 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 16(GETNEXT)
|  |  |
|  |  15:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF017[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk, RF016[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=13 row-size=140B cardinality=4.32G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 15(GETNEXT)
|  |
|  148:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=12 row-size=20B cardinality=149.12K cost=25263984
|  |  in pipelines: 148(GETNEXT), 09(OPEN)
|  |
|  147:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_0.i_brand_id,tpcds_partitioned_parquet_snap.item_0.i_class_id,tpcds_partitioned_parquet_snap.item_0.i_category_id)]
|  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=12 row-size=20B cardinality=17.89M cost=3634352
|  |  in pipelines: 09(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=17.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[31451484894, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  14:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=12 row-size=20B cardinality=17.89M cost=11947236639
|  |  in pipelines: 09(GETNEXT)
|  |
|  13:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=14
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=6,8,10 row-size=739B cardinality=8.64G cost=3779809729
|  |  in pipelines: 09(GETNEXT), 12(OPEN)
|  |
|  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  runtime filters: RF012[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF013[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  146:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=10 row-size=405B cardinality=360.00K cost=478440
|  |  |  in pipelines: 12(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[1757529]
|  |  12:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=10 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 12(GETNEXT)
|  |
|  11:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=6,8 row-size=333B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  in pipelines: 09(GETNEXT), 10(OPEN)
|  |
|  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |
|  |  145:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=8 row-size=237B cardinality=7.30K cost=9700
|  |  |  in pipelines: 10(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[119540]
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=8 row-size=237B cardinality=7.30K cost=114705
|  |     in pipelines: 10(GETNEXT)
|  |
|  09:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF013[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk, RF012[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=6 row-size=96B cardinality=8.64G(filtered from 8.64G) cost=11943846410
|     in pipelines: 09(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=20
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=739B cardinality=511.32M cost=223870100
|  in pipelines: 02(GETNEXT), 05(OPEN)
|
|--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=385.60MB mem-reservation=374.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=20 plan-id=21 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  144:EXCHANGE [BROADCAST]
|  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=405B cardinality=360.00K cost=478440
|  |  in pipelines: 05(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[1757529]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=405B cardinality=360.00K cost=1355609
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=21
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=333B cardinality=511.58M cost=223916426
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=22.36MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  143:EXCHANGE [BROADCAST]
|  |  mem-estimate=50.45KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=237B cardinality=108 cost=140
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[114776]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=2 row-size=237B cardinality=108 cost=114705
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=96B cardinality=511.58M(filtered from 8.64G) cost=707201433
   in pipelines: 02(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=14.70GB Threads=345
Per-Host Resource Estimates: Memory=38.62GB
F96:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.05MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[634] cpu-comparison-result=1557 [max(1 (self) vs 1557 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(160,161,162,158,159) WHEN 158 THEN CHANNEL WHEN 159 THEN CHANNEL WHEN 160 THEN CHANNEL WHEN 161 THEN CHANNEL WHEN 162 THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_BRAND_ID WHEN 159 THEN I_BRAND_ID WHEN 160 THEN I_BRAND_ID WHEN 161 THEN NULL WHEN 162 THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CLASS_ID WHEN 159 THEN I_CLASS_ID WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CATEGORY_ID WHEN 159 THEN NULL WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END, aggif(valid_tid(160,161,162,158,159) IN (158, 159, 160, 161, 162), CASE valid_tid(160,161,162,158,159) WHEN 158 THEN sum(SALES) WHEN 159 THEN sum(SALES) WHEN 160 THEN sum(SALES) WHEN 161 THEN sum(SALES) WHEN 162 THEN sum(SALES) END), aggif(valid_tid(160,161,162,158,159) IN (158, 159, 160, 161, 162), CASE valid_tid(160,161,162,158,159) WHEN 158 THEN sum(NUMBER_SALES) WHEN 159 THEN sum(NUMBER_SALES) WHEN 160 THEN sum(NUMBER_SALES) WHEN 161 THEN sum(NUMBER_SALES) WHEN 162 THEN sum(NUMBER_SALES) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
235:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(160,161,162,158,159) WHEN 158 THEN CHANNEL WHEN 159 THEN CHANNEL WHEN 160 THEN CHANNEL WHEN 161 THEN CHANNEL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_BRAND_ID WHEN 159 THEN I_BRAND_ID WHEN 160 THEN I_BRAND_ID WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CLASS_ID WHEN 159 THEN I_CLASS_ID WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CATEGORY_ID WHEN 159 THEN NULL WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST
|  limit: 100
|  mem-estimate=51.25KB mem-reservation=0B thread-reservation=0
|  tuple-ids=164 row-size=48B cardinality=100 cost=34
|  in pipelines: 142(GETNEXT)
|
F95:PLAN FRAGMENT [HASH(CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(CHANNEL) WHEN 160 THEN murmur_hash(CHANNEL) WHEN 161 THEN murmur_hash(CHANNEL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_BRAND_ID) WHEN 159 THEN murmur_hash(I_BRAND_ID) WHEN 160 THEN murmur_hash(I_BRAND_ID) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_CLASS_ID) WHEN 159 THEN murmur_hash(I_CLASS_ID) WHEN 160 THEN murmur_hash(NULL) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_CATEGORY_ID) WHEN 159 THEN murmur_hash(NULL) WHEN 160 THEN murmur_hash(NULL) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END)] hosts=10 instances=10 (adjusted from 120)
Per-Instance Resources: mem-estimate=650.00MB mem-reservation=171.94MB thread-reservation=1
max-parallelism=10 segment-costs=[13125702, 10687615, 20955666, 157] cpu-comparison-result=1557 [max(10 (self) vs 1557 (sum children))]
142:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(160,161,162,158,159) WHEN 158 THEN CHANNEL WHEN 159 THEN CHANNEL WHEN 160 THEN CHANNEL WHEN 161 THEN CHANNEL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_BRAND_ID WHEN 159 THEN I_BRAND_ID WHEN 160 THEN I_BRAND_ID WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CLASS_ID WHEN 159 THEN I_CLASS_ID WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST, CASE valid_tid(160,161,162,158,159) WHEN 158 THEN I_CATEGORY_ID WHEN 159 THEN NULL WHEN 160 THEN NULL WHEN 161 THEN NULL WHEN 162 THEN NULL END ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=164 row-size=48B cardinality=100 cost=20955666
|  in pipelines: 142(GETNEXT), 141(OPEN)
|
141:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(160,161,162,158,159) IN (CAST(158 AS INT), CAST(159 AS INT), CAST(160 AS INT), CAST(161 AS INT), CAST(162 AS INT)), CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN sum(SALES) WHEN CAST(159 AS INT) THEN sum(SALES) WHEN CAST(160 AS INT) THEN sum(SALES) WHEN CAST(161 AS INT) THEN sum(SALES) WHEN CAST(162 AS INT) THEN sum(SALES) END), aggif(valid_tid(160,161,162,158,159) IN (CAST(158 AS INT), CAST(159 AS INT), CAST(160 AS INT), CAST(161 AS INT), CAST(162 AS INT)), CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(159 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(160 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(161 AS INT) THEN sum(NUMBER_SALES) WHEN CAST(162 AS INT) THEN sum(NUMBER_SALES) END)
|  group by: CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN CHANNEL WHEN CAST(159 AS INT) THEN CHANNEL WHEN CAST(160 AS INT) THEN CHANNEL WHEN CAST(161 AS INT) THEN CHANNEL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN I_BRAND_ID WHEN CAST(159 AS INT) THEN I_BRAND_ID WHEN CAST(160 AS INT) THEN I_BRAND_ID WHEN CAST(161 AS INT) THEN NULL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN I_CLASS_ID WHEN CAST(159 AS INT) THEN I_CLASS_ID WHEN CAST(160 AS INT) THEN NULL WHEN CAST(161 AS INT) THEN NULL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN I_CATEGORY_ID WHEN CAST(159 AS INT) THEN NULL WHEN CAST(160 AS INT) THEN NULL WHEN CAST(161 AS INT) THEN NULL WHEN CAST(162 AS INT) THEN NULL END, CASE valid_tid(160,161,162,158,159) WHEN CAST(158 AS INT) THEN CAST(158 AS INT) WHEN CAST(159 AS INT) THEN CAST(159 AS INT) WHEN CAST(160 AS INT) THEN CAST(160 AS INT) WHEN CAST(161 AS INT) THEN CAST(161 AS INT) WHEN CAST(162 AS INT) THEN CAST(162 AS INT) END
|  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=163 row-size=52B cardinality=1.79M cost=10687615
|  in pipelines: 141(GETNEXT), 234(OPEN)
|
234:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(SALES), sum:merge(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=137.94MB thread-reservation=0
|  tuple-ids=158N,159N,160N,161N,162N row-size=240B cardinality=1.79M cost=10687785
|  in pipelines: 234(GETNEXT), 166(OPEN), 196(OPEN), 226(OPEN)
|
233:EXCHANGE [HASH(CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(CHANNEL) WHEN 159 THEN murmur_hash(CHANNEL) WHEN 160 THEN murmur_hash(CHANNEL) WHEN 161 THEN murmur_hash(CHANNEL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_BRAND_ID) WHEN 159 THEN murmur_hash(I_BRAND_ID) WHEN 160 THEN murmur_hash(I_BRAND_ID) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_CLASS_ID) WHEN 159 THEN murmur_hash(I_CLASS_ID) WHEN 160 THEN murmur_hash(NULL) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END,CASE valid_tid(160,161,162,158,159) WHEN 158 THEN murmur_hash(I_CATEGORY_ID) WHEN 159 THEN murmur_hash(NULL) WHEN 160 THEN murmur_hash(NULL) WHEN 161 THEN murmur_hash(NULL) WHEN 162 THEN murmur_hash(NULL) END)]
|  mem-estimate=37.68MB mem-reservation=0B thread-reservation=0
|  tuple-ids=158N,159N,160N,161N,162N row-size=240B cardinality=1.79M cost=2437917
|  in pipelines: 166(GETNEXT), 196(GETNEXT), 226(GETNEXT)
|
F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Instance Resources: mem-estimate=556.41MB mem-reservation=146.50MB thread-reservation=1
max-parallelism=109 segment-costs=[31467972, 31467972, 31443812, 11505411, 32269345] cpu-comparison-result=1557 [max(109 (self) vs 1557 (sum children))]
140:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID
|  Class 1
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, I_CLASS_ID, NULL
|  Class 2
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, I_BRAND_ID, NULL, NULL
|  Class 3
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: CHANNEL, NULL, NULL, NULL
|  Class 4
|    output: sum(SALES), sum(NUMBER_SALES)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=522.00MB mem-reservation=138.00MB thread-reservation=0
|  tuple-ids=158N,159N,160N,161N,162N row-size=240B cardinality=1.79M cost=11334183
|  in pipelines: 166(GETNEXT), 196(GETNEXT), 226(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=157 row-size=48B cardinality=447.36K cost=26522
|  in pipelines: 166(GETNEXT), 196(GETNEXT), 226(GETNEXT)
|
|--139:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.web_sales_4.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_4.ws_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=140,156 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 226(GETNEXT), 231(OPEN)
|  |
|  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  232:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=156 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 231(GETNEXT)
|  |  |
|  |  F93:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  231:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=156 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 231(GETNEXT), 138(OPEN)
|  |  |
|  |  230:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=155 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 138(GETNEXT)
|  |  |
|  |  F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[33456059694, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  138:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=155 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 138(GETNEXT), 129(OPEN), 132(OPEN), 135(OPEN)
|  |  |
|  |  127:UNION
|  |  |  pass-through-operands: 128
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=154 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 129(GETNEXT), 132(GETNEXT), 135(GETNEXT)
|  |  |
|  |  |--137:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_5.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=150,152 row-size=377B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 135(GETNEXT), 136(OPEN)
|  |  |  |
|  |  |  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_19.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  229:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=152 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 136(GETNEXT)
|  |  |  |  |
|  |  |  |  F91:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  136:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_19.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_19.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=152 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 136(GETNEXT)
|  |  |  |
|  |  |  135:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=150 row-size=140B cardinality=2.16G cost=4354495421
|  |  |     in pipelines: 135(GETNEXT)
|  |  |
|  |  128:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=149 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 129(GETNEXT), 132(GETNEXT)
|  |  |
|  |  |--134:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_5.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=145,147 row-size=377B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 132(GETNEXT), 133(OPEN)
|  |  |  |
|  |  |  |--F107:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_18.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  228:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=147 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 133(GETNEXT)
|  |  |  |  |
|  |  |  |  F88:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  133:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_18.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_18.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=147 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 133(GETNEXT)
|  |  |  |
|  |  |  132:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=145 row-size=140B cardinality=4.32G cost=8709277205
|  |  |     in pipelines: 132(GETNEXT)
|  |  |
|  |  131:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_5.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=141,143 row-size=333B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 129(GETNEXT), 130(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_17.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  227:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=143 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 130(GETNEXT)
|  |  |  |
|  |  |  F86:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  130:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_17.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_17.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=143 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 130(GETNEXT)
|  |  |
|  |  129:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=141 row-size=96B cardinality=8.64G cost=11943846410
|  |     in pipelines: 129(GETNEXT)
|  |
|  226:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.web_sales_4.ws_quantity, tpcds_partitioned_parquet_snap.web_sales_4.ws_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=140 row-size=36B cardinality=149.12K cost=26496317
|  |  in pipelines: 226(GETNEXT), 120(OPEN)
|  |
|  225:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_13.i_brand_id,tpcds_partitioned_parquet_snap.item_13.i_class_id,tpcds_partitioned_parquet_snap.item_13.i_category_id)]
|  |  mem-estimate=12.73MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=140 row-size=36B cardinality=17.88M cost=4947495
|  |  in pipelines: 120(GETNEXT)
|  |
|  F63:PLAN FRAGMENT [RANDOM] hosts=10 instances=70 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=9.26MB thread-reservation=1
|  max-parallelism=70 segment-costs=[691297462, 50665788] cpu-comparison-result=399 [max(70 (self) vs 399 (sum children))]
|  126:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.web_sales_4.ws_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.web_sales_4.ws_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_13.i_brand_id, tpcds_partitioned_parquet_snap.item_13.i_class_id, tpcds_partitioned_parquet_snap.item_13.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=140 row-size=36B cardinality=17.88M cost=265568963
|  |  in pipelines: 120(GETNEXT)
|  |
|  125:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=32
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=134,136,138,133 row-size=787B cardinality=127.83M cost=55950721
|  |  in pipelines: 120(GETNEXT), 223(OPEN)
|  |
|  |--F129:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=120.45MB mem-reservation=119.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=32 plan-id=33 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  runtime filters: RF061[min_max] <- tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=119.00MB mem-reservation=119.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  224:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 223(GETNEXT)
|  |  |
|  |  F83:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_12.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  223:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=133 row-size=4B cardinality=360.00K cost=1068777
|  |  |  in pipelines: 223(GETNEXT), 220(OPEN)
|  |  |
|  |  222:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_item_sk)]
|  |  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=133 row-size=4B cardinality=445.08K cost=57637
|  |  |  in pipelines: 220(GETNEXT)
|  |  |
|  |  F81:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  119:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_12.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=133 row-size=4B cardinality=445.08K cost=1291265
|  |  |  in pipelines: 220(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=33
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_12.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_12.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  |  tuple-ids=130,131 row-size=425B cardinality=447.36K cost=195809
|  |  |  in pipelines: 220(GETNEXT), 117(OPEN)
|  |  |
|  |  |--F130:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=28.60MB mem-reservation=17.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[1071501]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_12.i_brand_id, tpcds_partitioned_parquet_snap.item_12.i_category_id, tpcds_partitioned_parquet_snap.item_12.i_class_id
|  |  |  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  221:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_12.i_brand_id,tpcds_partitioned_parquet_snap.item_12.i_class_id,tpcds_partitioned_parquet_snap.item_12.i_category_id)]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=131 row-size=405B cardinality=360.00K cost=711501
|  |  |  |  in pipelines: 117(GETNEXT)
|  |  |  |
|  |  |  F82:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[10942162]
|  |  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=131 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 117(GETNEXT)
|  |  |
|  |  220:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 220(GETNEXT), 109(OPEN), 218(OPEN)
|  |  |
|  |  219:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=130 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 109(GETNEXT), 218(GETNEXT)
|  |  |
|  |  F80:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=384.94MB mem-reservation=102.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[1820963, 1760391, 28898336, 2680446, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  116:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 109(GETNEXT), 218(GETNEXT)
|  |  |
|  |  94:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=129 row-size=20B cardinality=447.36K cost=39859
|  |  |  in pipelines: 109(GETNEXT), 218(GETNEXT)
|  |  |
|  |  |--218:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=128 row-size=20B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 218(GETNEXT), 110(OPEN)
|  |  |  |
|  |  |  217:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_11.i_brand_id,tpcds_partitioned_parquet_snap.item_11.i_class_id,tpcds_partitioned_parquet_snap.item_11.i_category_id)]
|  |  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=128 row-size=20B cardinality=17.89M cost=3634352
|  |  |  |  in pipelines: 110(GETNEXT)
|  |  |  |
|  |  |  F76:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=9.26MB thread-reservation=1
|  |  |  max-parallelism=930 segment-costs=[9292145537, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  115:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_11.i_brand_id, tpcds_partitioned_parquet_snap.item_11.i_class_id, tpcds_partitioned_parquet_snap.item_11.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=128 row-size=20B cardinality=17.89M cost=3047563509
|  |  |  |  in pipelines: 110(GETNEXT)
|  |  |  |
|  |  |  114:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=38
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk = tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=122,124,126 row-size=783B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 110(GETNEXT), 113(OPEN)
|  |  |  |
|  |  |  |--F135:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=419.60MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=38 plan-id=39 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  runtime filters: RF081[min_max] <- tpcds_partitioned_parquet_snap.item_11.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  216:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=126 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 113(GETNEXT)
|  |  |  |  |
|  |  |  |  F78:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  |  113:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=126 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 113(GETNEXT)
|  |  |  |
|  |  |  112:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=39
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=122,124 row-size=377B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  |  in pipelines: 110(GETNEXT), 111(OPEN)
|  |  |  |
|  |  |  |--F136:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  215:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=124 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 111(GETNEXT)
|  |  |  |  |
|  |  |  |  F77:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  111:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_15.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_15.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=124 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 111(GETNEXT)
|  |  |  |
|  |  |  110:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF081[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=122 row-size=140B cardinality=2.16G(filtered from 2.16G) cost=4354495421
|  |  |     in pipelines: 110(GETNEXT)
|  |  |
|  |  109:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=121 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 109(GETNEXT), 214(OPEN)
|  |  |
|  |  214:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=120 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 214(GETNEXT), 208(OPEN), 212(OPEN)
|  |  |
|  |  213:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=120 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |
|  |  F74:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=162.06MB mem-reservation=42.50MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28898336, 28898336, 1786964, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  108:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=120 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |
|  |  95:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=119 row-size=20B cardinality=298.24K cost=26573
|  |  |  in pipelines: 208(GETNEXT), 212(GETNEXT)
|  |  |
|  |  |--212:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=118 row-size=20B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 212(GETNEXT), 102(OPEN)
|  |  |  |
|  |  |  211:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_10.i_brand_id,tpcds_partitioned_parquet_snap.item_10.i_class_id,tpcds_partitioned_parquet_snap.item_10.i_category_id)]
|  |  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=118 row-size=20B cardinality=17.89M cost=3634352
|  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  F70:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=10.00MB thread-reservation=1
|  |  |  max-parallelism=1831 segment-costs=[18503862033, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  107:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_10.i_brand_id, tpcds_partitioned_parquet_snap.item_10.i_class_id, tpcds_partitioned_parquet_snap.item_10.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=118 row-size=20B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  106:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=36
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk = tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=112,114,116 row-size=783B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 102(GETNEXT), 105(OPEN)
|  |  |  |
|  |  |  |--F133:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=36 plan-id=37 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  runtime filters: RF076[bloom] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk, RF077[min_max] <- tpcds_partitioned_parquet_snap.item_10.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=116 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 105(GETNEXT)
|  |  |  |  |
|  |  |  |  F72:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  |  105:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=116 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 105(GETNEXT)
|  |  |  |
|  |  |  104:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=37
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=112,114 row-size=377B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  in pipelines: 102(GETNEXT), 103(OPEN)
|  |  |  |
|  |  |  |--F134:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=37 plan-id=38 cohort-id=07
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  209:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=114 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 103(GETNEXT)
|  |  |  |  |
|  |  |  |  F71:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  103:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_14.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_14.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=114 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 103(GETNEXT)
|  |  |  |
|  |  |  102:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF077[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk, RF076[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=112 row-size=140B cardinality=4.32G(filtered from 4.32G) cost=8709277205
|  |  |     in pipelines: 102(GETNEXT)
|  |  |
|  |  208:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=111 row-size=20B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 208(GETNEXT), 96(OPEN)
|  |  |
|  |  207:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_9.i_brand_id,tpcds_partitioned_parquet_snap.item_9.i_class_id,tpcds_partitioned_parquet_snap.item_9.i_category_id)]
|  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=111 row-size=20B cardinality=17.89M cost=3634352
|  |  |  in pipelines: 96(GETNEXT)
|  |  |
|  |  F66:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=17.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[31451484894, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  101:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_9.i_brand_id, tpcds_partitioned_parquet_snap.item_9.i_class_id, tpcds_partitioned_parquet_snap.item_9.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=111 row-size=20B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 96(GETNEXT)
|  |  |
|  |  100:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=34
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk = tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=105,107,109 row-size=739B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 96(GETNEXT), 99(OPEN)
|  |  |
|  |  |--F131:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  runtime filters: RF072[bloom] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk, RF073[min_max] <- tpcds_partitioned_parquet_snap.item_9.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  206:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=109 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 99(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  99:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=109 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 99(GETNEXT)
|  |  |
|  |  98:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=35
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=105,107 row-size=333B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  in pipelines: 96(GETNEXT), 97(OPEN)
|  |  |
|  |  |--F132:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=35 plan-id=36 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  205:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=107 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 97(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  97:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_13.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_13.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=107 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 97(GETNEXT)
|  |  |
|  |  96:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk, RF072[bloom] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=105 row-size=96B cardinality=8.64G(filtered from 8.64G) cost=11943846410
|  |     in pipelines: 96(GETNEXT)
|  |
|  124:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=40
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk = tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=134,136,138 row-size=783B cardinality=127.83M cost=55967115
|  |  in pipelines: 120(GETNEXT), 123(OPEN)
|  |
|  |--F137:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=249.60MB mem-reservation=238.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=40 plan-id=41 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  runtime filters: RF063[min_max] <- tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |  |  mem-estimate=238.00MB mem-reservation=238.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  204:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=138 row-size=405B cardinality=360.00K cost=478440
|  |  |  in pipelines: 123(GETNEXT)
|  |  |
|  |  F65:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[1757529]
|  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF061[min_max] -> tpcds_partitioned_parquet_snap.item_13.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=138 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 123(GETNEXT)
|  |
|  122:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=41
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=134,136 row-size=377B cardinality=127.89M cost=55978696
|  |  in pipelines: 120(GETNEXT), 121(OPEN)
|  |
|  |--F138:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=14.61MB mem-reservation=14.56MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=41 plan-id=42 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  runtime filters: RF064[bloom] <- tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=13.56MB mem-reservation=13.56MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  203:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=50.45KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=136 row-size=237B cardinality=108 cost=140
|  |  |  in pipelines: 121(GETNEXT)
|  |  |
|  |  F64:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[114776]
|  |  121:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_16.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_16.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=136 row-size=237B cardinality=108 cost=114705
|  |     in pipelines: 121(GETNEXT)
|  |
|  120:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk, RF061[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_item_sk, RF064[bloom] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|     tuple-ids=134 row-size=140B cardinality=127.89M(filtered from 2.16G) cost=257831967
|     in pipelines: 120(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=104 row-size=48B cardinality=298.24K cost=53044
|  in pipelines: 166(GETNEXT), 196(GETNEXT)
|
|--93:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=87,103 row-size=52B cardinality=149.12K cost=30554
|  |  in pipelines: 196(GETNEXT), 201(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  202:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=103 row-size=16B cardinality=1 cost=0
|  |  |  in pipelines: 201(GETNEXT)
|  |  |
|  |  F61:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  |  201:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=103 row-size=16B cardinality=1 cost=8
|  |  |  in pipelines: 201(GETNEXT), 92(OPEN)
|  |  |
|  |  200:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=102 row-size=16B cardinality=120 cost=22
|  |  |  in pipelines: 92(GETNEXT)
|  |  |
|  |  F60:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[33456059694, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  |  92:AGGREGATE
|  |  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=102 row-size=16B cardinality=120 cost=1058398679
|  |  |  in pipelines: 92(GETNEXT), 83(OPEN), 86(OPEN), 89(OPEN)
|  |  |
|  |  81:UNION
|  |  |  pass-through-operands: 82
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=101 row-size=8B cardinality=15.12G cost=110287964
|  |  |  in pipelines: 83(GETNEXT), 86(GETNEXT), 89(GETNEXT)
|  |  |
|  |  |--91:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=97,99 row-size=377B cardinality=2.16G cost=945417979
|  |  |  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |  |  |
|  |  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  199:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=99 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 90(GETNEXT)
|  |  |  |  |
|  |  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  90:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_12.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_12.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=99 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 90(GETNEXT)
|  |  |  |
|  |  |  89:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=97 row-size=140B cardinality=2.16G cost=4354495421
|  |  |     in pipelines: 89(GETNEXT)
|  |  |
|  |  82:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=12.96G cost=661738272
|  |  |  in pipelines: 83(GETNEXT), 86(GETNEXT)
|  |  |
|  |  |--88:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,94 row-size=377B cardinality=4.32G cost=1890898131
|  |  |  |  in pipelines: 86(GETNEXT), 87(OPEN)
|  |  |  |
|  |  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  198:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=94 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 87(GETNEXT)
|  |  |  |  |
|  |  |  |  F56:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_11.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_11.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=94 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 87(GETNEXT)
|  |  |  |
|  |  |  86:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=92 row-size=140B cardinality=4.32G cost=8709277205
|  |  |     in pipelines: 86(GETNEXT)
|  |  |
|  |  85:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=88,90 row-size=333B cardinality=8.64G cost=3781699633
|  |  |  in pipelines: 83(GETNEXT), 84(OPEN)
|  |  |
|  |  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  197:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=90 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 84(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  84:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_10.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_10.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=90 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 84(GETNEXT)
|  |  |
|  |  83:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=88 row-size=96B cardinality=8.64G cost=11943846410
|  |     in pipelines: 83(GETNEXT)
|  |
|  196:AGGREGATE [FINALIZE]
|  |  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_quantity, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_list_price)), count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=87 row-size=36B cardinality=149.12K cost=26516592
|  |  in pipelines: 196(GETNEXT), 74(OPEN)
|  |
|  195:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_8.i_brand_id,tpcds_partitioned_parquet_snap.item_8.i_class_id,tpcds_partitioned_parquet_snap.item_8.i_category_id)]
|  |  mem-estimate=14.26MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=87 row-size=36B cardinality=17.89M cost=4951380
|  |  in pipelines: 74(GETNEXT)
|  |
|  F31:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=43.03MB mem-reservation=10.00MB thread-reservation=1
|  max-parallelism=109 segment-costs=[1297060658, 50705571] cpu-comparison-result=399 [max(109 (self) vs 399 (sum children))]
|  80:AGGREGATE [STREAMING]
|  |  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_list_price)), count()
|  |  group by: tpcds_partitioned_parquet_snap.item_8.i_brand_id, tpcds_partitioned_parquet_snap.item_8.i_class_id, tpcds_partitioned_parquet_snap.item_8.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=87 row-size=36B cardinality=17.89M cost=448830935
|  |  in pipelines: 74(GETNEXT)
|  |
|  79:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  fk/pk conjuncts: none
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=81,83,85,80 row-size=787B cardinality=254.69M cost=111477302
|  |  in pipelines: 74(GETNEXT), 193(OPEN)
|  |
|  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=188.45MB mem-reservation=187.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  runtime filters: RF031[min_max] <- tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  194:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=80 row-size=4B cardinality=360.00K cost=478440
|  |  |  in pipelines: 193(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_7.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  193:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=4B cardinality=360.00K cost=1068777
|  |  |  in pipelines: 193(GETNEXT), 190(OPEN)
|  |  |
|  |  192:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_item_sk)]
|  |  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=80 row-size=4B cardinality=445.08K cost=57637
|  |  |  in pipelines: 190(GETNEXT)
|  |  |
|  |  F49:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  |  73:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item_7.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=80 row-size=4B cardinality=445.08K cost=1291265
|  |  |  in pipelines: 190(GETNEXT)
|  |  |
|  |  72:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=23
|  |  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_7.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_7.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |  fk/pk conjuncts: assumed fk/pk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  |  tuple-ids=77,78 row-size=425B cardinality=447.36K cost=195809
|  |  |  in pipelines: 190(GETNEXT), 71(OPEN)
|  |  |
|  |  |--F120:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  |  Per-Instance Resources: mem-estimate=28.60MB mem-reservation=17.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[1071501]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=23 plan-id=24 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_7.i_brand_id, tpcds_partitioned_parquet_snap.item_7.i_category_id, tpcds_partitioned_parquet_snap.item_7.i_class_id
|  |  |  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  191:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_7.i_brand_id,tpcds_partitioned_parquet_snap.item_7.i_class_id,tpcds_partitioned_parquet_snap.item_7.i_category_id)]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=78 row-size=405B cardinality=360.00K cost=711501
|  |  |  |  in pipelines: 71(GETNEXT)
|  |  |  |
|  |  |  F50:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[10942162]
|  |  |  71:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=78 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 71(GETNEXT)
|  |  |
|  |  190:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=77 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 190(GETNEXT), 63(OPEN), 188(OPEN)
|  |  |
|  |  189:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=77 row-size=20B cardinality=447.36K cost=90858
|  |  |  in pipelines: 63(GETNEXT), 188(GETNEXT)
|  |  |
|  |  F48:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=384.94MB mem-reservation=102.00MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[1820963, 1760391, 28898336, 2680446, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  |  70:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=77 row-size=20B cardinality=447.36K cost=2640587
|  |  |  in pipelines: 63(GETNEXT), 188(GETNEXT)
|  |  |
|  |  48:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=76 row-size=20B cardinality=447.36K cost=39859
|  |  |  in pipelines: 63(GETNEXT), 188(GETNEXT)
|  |  |
|  |  |--188:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=20B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 188(GETNEXT), 64(OPEN)
|  |  |  |
|  |  |  187:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_6.i_brand_id,tpcds_partitioned_parquet_snap.item_6.i_class_id,tpcds_partitioned_parquet_snap.item_6.i_category_id)]
|  |  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=20B cardinality=17.89M cost=3634352
|  |  |  |  in pipelines: 64(GETNEXT)
|  |  |  |
|  |  |  F44:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=9.26MB thread-reservation=1
|  |  |  max-parallelism=930 segment-costs=[9292145537, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  69:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_6.i_brand_id, tpcds_partitioned_parquet_snap.item_6.i_class_id, tpcds_partitioned_parquet_snap.item_6.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=75 row-size=20B cardinality=17.89M cost=3047563509
|  |  |  |  in pipelines: 64(GETNEXT)
|  |  |  |
|  |  |  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=28
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk = tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=69,71,73 row-size=783B cardinality=2.16G cost=944945506
|  |  |  |  in pipelines: 64(GETNEXT), 67(OPEN)
|  |  |  |
|  |  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=419.60MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  runtime filters: RF051[min_max] <- tpcds_partitioned_parquet_snap.item_6.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  186:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=73 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 67(GETNEXT)
|  |  |  |  |
|  |  |  |  F46:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  |  67:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=73 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 67(GETNEXT)
|  |  |  |
|  |  |  66:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=29
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=69,71 row-size=377B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  |  in pipelines: 64(GETNEXT), 65(OPEN)
|  |  |  |
|  |  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=29 plan-id=30 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  185:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=71 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 65(GETNEXT)
|  |  |  |  |
|  |  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  65:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_8.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_8.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=71 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 65(GETNEXT)
|  |  |  |
|  |  |  64:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |  |     runtime filters: RF051[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=2.16G size=145.75GB
|  |  |       partitions: 1824/1824 rows=2.16G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |  |     tuple-ids=69 row-size=140B cardinality=2.16G(filtered from 2.16G) cost=4354495421
|  |  |     in pipelines: 64(GETNEXT)
|  |  |
|  |  63:AGGREGATE [FINALIZE]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=68 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 63(GETNEXT), 184(OPEN)
|  |  |
|  |  184:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  having: count() = CAST(2 AS BIGINT)
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=67 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 184(GETNEXT), 178(OPEN), 182(OPEN)
|  |  |
|  |  183:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=67 row-size=20B cardinality=298.24K cost=60572
|  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |
|  |  F42:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=162.06MB mem-reservation=42.50MB thread-reservation=1
|  |  max-parallelism=120 segment-costs=[28898336, 28898336, 1786964, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  |  62:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=67 row-size=20B cardinality=298.24K cost=1760391
|  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |
|  |  49:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=66 row-size=20B cardinality=298.24K cost=26573
|  |  |  in pipelines: 178(GETNEXT), 182(GETNEXT)
|  |  |
|  |  |--182:AGGREGATE [FINALIZE]
|  |  |  |  output: count:merge()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=65 row-size=20B cardinality=149.12K cost=25263984
|  |  |  |  in pipelines: 182(GETNEXT), 56(OPEN)
|  |  |  |
|  |  |  181:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_5.i_brand_id,tpcds_partitioned_parquet_snap.item_5.i_class_id,tpcds_partitioned_parquet_snap.item_5.i_category_id)]
|  |  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=65 row-size=20B cardinality=17.89M cost=3634352
|  |  |  |  in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=10.00MB thread-reservation=1
|  |  |  max-parallelism=1831 segment-costs=[18503862033, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  |  61:AGGREGATE [STREAMING]
|  |  |  |  output: count()
|  |  |  |  group by: tpcds_partitioned_parquet_snap.item_5.i_brand_id, tpcds_partitioned_parquet_snap.item_5.i_class_id, tpcds_partitioned_parquet_snap.item_5.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  |  tuple-ids=65 row-size=20B cardinality=17.89M cost=6014287315
|  |  |  |  in pipelines: 56(GETNEXT)
|  |  |  |
|  |  |  60:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=26
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk = tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  |  tuple-ids=59,61,63 row-size=783B cardinality=4.32G cost=1889953155
|  |  |  |  in pipelines: 56(GETNEXT), 59(OPEN)
|  |  |  |
|  |  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=26 plan-id=27 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  runtime filters: RF046[bloom] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk, RF047[min_max] <- tpcds_partitioned_parquet_snap.item_5.i_item_sk
|  |  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |  |
|  |  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=63 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F40:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  |  59:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=360.00K size=33.54MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=63 row-size=405B cardinality=360.00K cost=1355609
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  58:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=59,61 row-size=377B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  |  in pipelines: 56(GETNEXT), 57(OPEN)
|  |  |  |
|  |  |  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=06
|  |  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  179:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  |  in pipelines: 57(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  |  57:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.17MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_7.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_7.d_year >= CAST(1998 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=237B cardinality=7.30K cost=114705
|  |  |  |     in pipelines: 57(GETNEXT)
|  |  |  |
|  |  |  56:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |  |     runtime filters: RF047[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk, RF046[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=4.32G size=280.96GB
|  |  |       partitions: 1831/1831 rows=4.32G
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=59 row-size=140B cardinality=4.32G(filtered from 4.32G) cost=8709277205
|  |  |     in pipelines: 56(GETNEXT)
|  |  |
|  |  178:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=58 row-size=20B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 178(GETNEXT), 50(OPEN)
|  |  |
|  |  177:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_4.i_brand_id,tpcds_partitioned_parquet_snap.item_4.i_class_id,tpcds_partitioned_parquet_snap.item_4.i_category_id)]
|  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=58 row-size=20B cardinality=17.89M cost=3634352
|  |  |  in pipelines: 50(GETNEXT)
|  |  |
|  |  F34:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=17.00MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[31451484894, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  55:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_4.i_brand_id, tpcds_partitioned_parquet_snap.item_4.i_class_id, tpcds_partitioned_parquet_snap.item_4.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=58 row-size=20B cardinality=17.89M cost=11947236639
|  |  |  in pipelines: 50(GETNEXT)
|  |  |
|  |  54:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=24
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk = tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=52,54,56 row-size=739B cardinality=8.64G cost=3779809729
|  |  |  in pipelines: 50(GETNEXT), 53(OPEN)
|  |  |
|  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  runtime filters: RF042[bloom] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk, RF043[min_max] <- tpcds_partitioned_parquet_snap.item_4.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=56 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  F36:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=56 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  52:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=52,54 row-size=333B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  |  in pipelines: 50(GETNEXT), 51(OPEN)
|  |  |
|  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  175:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=54 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 51(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  51:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_6.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_6.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=54 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 51(GETNEXT)
|  |  |
|  |  50:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=389.90GB
|  |     runtime filters: RF043[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk, RF042[bloom] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_item_sk
|  |     stored statistics:
|  |       table: rows=8.64G size=389.90GB
|  |       partitions: 1824/1824 rows=8.64G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=390.22M
|  |     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|  |     tuple-ids=52 row-size=96B cardinality=8.64G(filtered from 8.64G) cost=11943846410
|  |     in pipelines: 50(GETNEXT)
|  |
|  78:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=30
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk = tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=81,83,85 row-size=783B cardinality=254.69M cost=111509966
|  |  in pipelines: 74(GETNEXT), 77(OPEN)
|  |
|  |--F127:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=385.60MB mem-reservation=374.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=30 plan-id=31 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  runtime filters: RF033[min_max] <- tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  174:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=85 row-size=405B cardinality=360.00K cost=478440
|  |  |  in pipelines: 77(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[1757529]
|  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.item_8.i_item_sk
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=85 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 77(GETNEXT)
|  |
|  76:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=31
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=81,83 row-size=377B cardinality=254.82M cost=111533041
|  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |
|  |--F128:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=22.36MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[248]
|  |  JOIN BUILD
|  |  |  join-table-id=31 plan-id=32 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  runtime filters: RF034[bloom] <- tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  173:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=50.45KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=83 row-size=237B cardinality=108 cost=140
|  |  |  in pipelines: 75(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[114776]
|  |  75:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_9.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_9.d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=83 row-size=237B cardinality=108 cost=114705
|  |     in pipelines: 75(GETNEXT)
|  |
|  74:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF033[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk, RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_item_sk, RF034[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=81 row-size=140B cardinality=254.82M(filtered from 4.32G) cost=513709414
|     in pipelines: 74(GETNEXT)
|
47:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  join predicates: sum(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)) > avg(multiply(QUANTITY, LIST_PRICE))
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=35,51 row-size=52B cardinality=149.12K cost=30554
|  in pipelines: 166(GETNEXT), 171(OPEN)
|
|--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=10 segment-costs=[0] cpu-comparison-result=120 [max(10 (self) vs 120 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  172:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=51 row-size=16B cardinality=1 cost=0
|  |  in pipelines: 171(GETNEXT)
|  |
|  F30:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=297.44KB mem-reservation=0B thread-reservation=1
|  max-parallelism=1 segment-costs=[30, 0] cpu-comparison-result=120 [max(1 (self) vs 120 (sum children))]
|  171:AGGREGATE [FINALIZE]
|  |  output: avg:merge(multiply(QUANTITY, LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=51 row-size=16B cardinality=1 cost=8
|  |  in pipelines: 171(GETNEXT), 46(OPEN)
|  |
|  170:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=281.44KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=50 row-size=16B cardinality=120 cost=22
|  |  in pipelines: 46(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=8.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[33456059694, 185] cpu-comparison-result=120 [max(120 (self) vs 33 (sum children))]
|  46:AGGREGATE
|  |  output: avg(multiply(CAST(QUANTITY AS DECIMAL(10,0)), LIST_PRICE))
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=50 row-size=16B cardinality=120 cost=1058398679
|  |  in pipelines: 46(GETNEXT), 37(OPEN), 40(OPEN), 43(OPEN)
|  |
|  35:UNION
|  |  pass-through-operands: 36
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=49 row-size=8B cardinality=15.12G cost=110287964
|  |  in pipelines: 37(GETNEXT), 40(GETNEXT), 43(GETNEXT)
|  |
|  |--45:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=45,47 row-size=377B cardinality=2.16G cost=945417979
|  |  |  in pipelines: 43(GETNEXT), 44(OPEN)
|  |  |
|  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  169:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=47 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 44(GETNEXT)
|  |  |  |
|  |  |  F28:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  44:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_5.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_5.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=47 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 44(GETNEXT)
|  |  |
|  |  43:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=45 row-size=140B cardinality=2.16G cost=4354495421
|  |     in pipelines: 43(GETNEXT)
|  |
|  36:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=44 row-size=8B cardinality=12.96G cost=661738272
|  |  in pipelines: 37(GETNEXT), 40(GETNEXT)
|  |
|  |--42:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=40,42 row-size=377B cardinality=4.32G cost=1890898131
|  |  |  in pipelines: 40(GETNEXT), 41(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  168:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=42 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 41(GETNEXT)
|  |  |  |
|  |  |  F25:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  41:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_4.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_4.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=42 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 41(GETNEXT)
|  |  |
|  |  40:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=40 row-size=140B cardinality=4.32G cost=8709277205
|  |     in pipelines: 40(GETNEXT)
|  |
|  39:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=36,38 row-size=333B cardinality=8.64G cost=3781699633
|  |  in pipelines: 37(GETNEXT), 38(OPEN)
|  |
|  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |
|  |  167:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=38 row-size=237B cardinality=7.30K cost=9700
|  |  |  in pipelines: 38(GETNEXT)
|  |  |
|  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[119540]
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_3.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_3.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=38 row-size=237B cardinality=7.30K cost=114705
|  |     in pipelines: 38(GETNEXT)
|  |
|  37:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=36 row-size=96B cardinality=8.64G cost=11943846410
|     in pipelines: 37(GETNEXT)
|
166:AGGREGATE [FINALIZE]
|  output: sum:merge(multiply(tpcds_partitioned_parquet_snap.store_sales.ss_quantity, tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count:merge()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=35 row-size=36B cardinality=149.12K cost=26516592
|  in pipelines: 166(GETNEXT), 02(OPEN)
|
165:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_brand_id,tpcds_partitioned_parquet_snap.item.i_class_id,tpcds_partitioned_parquet_snap.item.i_category_id)]
|  mem-estimate=14.26MB mem-reservation=0B thread-reservation=0
|  tuple-ids=35 row-size=36B cardinality=17.89M cost=4951380
|  in pipelines: 02(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=109 (adjusted from 120)
Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
Per-Instance Resources: mem-estimate=43.03MB mem-reservation=17.00MB thread-reservation=1
max-parallelism=109 segment-costs=[2197808378, 50705571] cpu-comparison-result=399 [max(109 (self) vs 399 (sum children))]
34:AGGREGATE [STREAMING]
|  output: sum(multiply(CAST(tpcds_partitioned_parquet_snap.store_sales.ss_quantity AS DECIMAL(10,0)), tpcds_partitioned_parquet_snap.store_sales.ss_list_price)), count()
|  group by: tpcds_partitioned_parquet_snap.item.i_brand_id, tpcds_partitioned_parquet_snap.item.i_class_id, tpcds_partitioned_parquet_snap.item.i_category_id
|  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=35 row-size=36B cardinality=17.89M cost=819062198
|  in pipelines: 02(GETNEXT)
|
33:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  tuple-ids=0,2,4,34 row-size=743B cardinality=511.06M cost=223758221
|  in pipelines: 02(GETNEXT), 163(OPEN)
|
|--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=188.45MB mem-reservation=187.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  runtime filters: RF001[min_max] <- tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=187.00MB mem-reservation=187.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |
|  164:EXCHANGE [BROADCAST]
|  |  mem-estimate=1.45MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=34 row-size=4B cardinality=360.00K cost=478440
|  |  in pipelines: 163(GETNEXT)
|  |
|  F20:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item_3.i_item_sk)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=10.25MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=10 segment-costs=[1126414, 11664] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  163:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34 row-size=4B cardinality=360.00K cost=1068777
|  |  in pipelines: 163(GETNEXT), 160(OPEN)
|  |
|  162:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_item_sk)]
|  |  mem-estimate=253.86KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=34 row-size=4B cardinality=445.08K cost=57637
|  |  in pipelines: 160(GETNEXT)
|  |
|  F18:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  Per-Instance Resources: mem-estimate=141.67MB mem-reservation=36.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[2731445, 1487074, 343957] cpu-comparison-result=374 [max(10 (self) vs 374 (sum children))]
|  32:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item_3.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34 row-size=4B cardinality=445.08K cost=1291265
|  |  in pipelines: 160(GETNEXT)
|  |
|  31:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: BRAND_ID = tpcds_partitioned_parquet_snap.item_3.i_brand_id, CATEGORY_ID = tpcds_partitioned_parquet_snap.item_3.i_category_id, CLASS_ID = tpcds_partitioned_parquet_snap.item_3.i_class_id
|  |  fk/pk conjuncts: assumed fk/pk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=1.00MB thread-reservation=0
|  |  tuple-ids=31,32 row-size=425B cardinality=447.36K cost=195809
|  |  in pipelines: 160(GETNEXT), 30(OPEN)
|  |
|  |--F110:PLAN FRAGMENT [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)] hosts=10 instances=10 (adjusted from 120)
|  |  |  Per-Instance Resources: mem-estimate=28.60MB mem-reservation=17.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[1071501]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_3.i_brand_id, tpcds_partitioned_parquet_snap.item_3.i_category_id, tpcds_partitioned_parquet_snap.item_3.i_class_id
|  |  |  mem-estimate=17.00MB mem-reservation=17.00MB spill-buffer=1.00MB thread-reservation=0 cost=360000
|  |  |
|  |  161:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_3.i_brand_id,tpcds_partitioned_parquet_snap.item_3.i_class_id,tpcds_partitioned_parquet_snap.item_3.i_category_id)]
|  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=32 row-size=405B cardinality=360.00K cost=711501
|  |  |  in pipelines: 30(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=32.00MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[10942162]
|  |  30:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=32 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 30(GETNEXT)
|  |
|  160:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 160(GETNEXT), 22(OPEN), 158(OPEN)
|  |
|  159:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.67MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=20B cardinality=447.36K cost=90858
|  |  in pipelines: 22(GETNEXT), 158(GETNEXT)
|  |
|  F17:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=384.94MB mem-reservation=102.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[1820963, 1760391, 28898336, 2680446, 806679] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  29:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=20B cardinality=447.36K cost=2640587
|  |  in pipelines: 22(GETNEXT), 158(GETNEXT)
|  |
|  07:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=20B cardinality=447.36K cost=39859
|  |  in pipelines: 22(GETNEXT), 158(GETNEXT)
|  |
|  |--158:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=29 row-size=20B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 158(GETNEXT), 23(OPEN)
|  |  |
|  |  157:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_2.i_brand_id,tpcds_partitioned_parquet_snap.item_2.i_class_id,tpcds_partitioned_parquet_snap.item_2.i_category_id)]
|  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=29 row-size=20B cardinality=17.89M cost=3634352
|  |  |  in pipelines: 23(GETNEXT)
|  |  |
|  |  F13:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=9.26MB thread-reservation=1
|  |  max-parallelism=930 segment-costs=[9292145537, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  28:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_2.i_brand_id, tpcds_partitioned_parquet_snap.item_2.i_class_id, tpcds_partitioned_parquet_snap.item_2.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=29 row-size=20B cardinality=17.89M cost=3047563509
|  |  |  in pipelines: 23(GETNEXT)
|  |  |
|  |  27:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_item_sk = tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=23,25,27 row-size=783B cardinality=2.16G cost=944945506
|  |  |  in pipelines: 23(GETNEXT), 26(OPEN)
|  |  |
|  |  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  runtime filters: RF020[bloom] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk, RF021[min_max] <- tpcds_partitioned_parquet_snap.item_2.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  156:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=27 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 26(GETNEXT)
|  |  |  |
|  |  |  F15:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  26:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=27 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 26(GETNEXT)
|  |  |
|  |  25:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=19
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=23,25 row-size=377B cardinality=2.16G(filtered from 2.16G) cost=945141101
|  |  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |  |
|  |  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=19 plan-id=20 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  155:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=25 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 24(GETNEXT)
|  |  |  |
|  |  |  F14:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  24:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_2.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_2.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=25 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 24(GETNEXT)
|  |  |
|  |  23:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF021[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk, RF020[bloom] -> tpcds_partitioned_parquet_snap.web_sales.ws_item_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=23 row-size=140B cardinality=2.16G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 23(GETNEXT)
|  |
|  22:AGGREGATE [FINALIZE]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=22 row-size=20B cardinality=298.24K cost=1760391
|  |  in pipelines: 22(GETNEXT), 154(OPEN)
|  |
|  154:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  having: count() = CAST(2 AS BIGINT)
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  in pipelines: 154(GETNEXT), 148(OPEN), 152(OPEN)
|  |
|  153:EXCHANGE [HASH(BRAND_ID,CLASS_ID,CATEGORY_ID)]
|  |  mem-estimate=3.38MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=60572
|  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |
|  F11:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=162.06MB mem-reservation=42.50MB thread-reservation=1
|  max-parallelism=120 segment-costs=[28898336, 28898336, 1786964, 537786] cpu-comparison-result=240 [max(120 (self) vs 240 (sum children))]
|  21:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: BRAND_ID, CLASS_ID, CATEGORY_ID
|  |  mem-estimate=128.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=21 row-size=20B cardinality=298.24K cost=1760391
|  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |
|  08:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=20 row-size=20B cardinality=298.24K cost=26573
|  |  in pipelines: 148(GETNEXT), 152(GETNEXT)
|  |
|  |--152:AGGREGATE [FINALIZE]
|  |  |  output: count:merge()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=19 row-size=20B cardinality=149.12K cost=25263984
|  |  |  in pipelines: 152(GETNEXT), 15(OPEN)
|  |  |
|  |  151:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_1.i_brand_id,tpcds_partitioned_parquet_snap.item_1.i_class_id,tpcds_partitioned_parquet_snap.item_1.i_category_id)]
|  |  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=19 row-size=20B cardinality=17.89M cost=3634352
|  |  |  in pipelines: 15(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  |  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=10.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[18503862033, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  |  20:AGGREGATE [STREAMING]
|  |  |  output: count()
|  |  |  group by: tpcds_partitioned_parquet_snap.item_1.i_brand_id, tpcds_partitioned_parquet_snap.item_1.i_class_id, tpcds_partitioned_parquet_snap.item_1.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=19 row-size=20B cardinality=17.89M cost=6014287315
|  |  |  in pipelines: 15(GETNEXT)
|  |  |
|  |  19:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk = tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=13,15,17 row-size=783B cardinality=4.32G cost=1889953155
|  |  |  in pipelines: 15(GETNEXT), 18(OPEN)
|  |  |
|  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  |  max-parallelism=10 segment-costs=[838440]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  runtime filters: RF016[bloom] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk, RF017[min_max] <- tpcds_partitioned_parquet_snap.item_1.i_item_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |  |
|  |  |  150:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=17 row-size=405B cardinality=360.00K cost=478440
|  |  |  |  in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=4 segment-costs=[1757529]
|  |  |  18:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |  |     stored statistics:
|  |  |       table: rows=360.00K size=33.54MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=17 row-size=405B cardinality=360.00K cost=1355609
|  |  |     in pipelines: 18(GETNEXT)
|  |  |
|  |  17:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=13,15 row-size=377B cardinality=4.32G(filtered from 4.32G) cost=1890344358
|  |  |  in pipelines: 15(GETNEXT), 16(OPEN)
|  |  |
|  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[17005]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  149:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=15 row-size=237B cardinality=7.30K cost=9700
|  |  |  |  in pipelines: 16(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[119540]
|  |  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_1.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_1.d_year >= CAST(1998 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=15 row-size=237B cardinality=7.30K cost=114705
|  |  |     in pipelines: 16(GETNEXT)
|  |  |
|  |  15:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF017[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk, RF016[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_item_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=13 row-size=140B cardinality=4.32G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 15(GETNEXT)
|  |
|  148:AGGREGATE [FINALIZE]
|  |  output: count:merge()
|  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=12 row-size=20B cardinality=149.12K cost=25263984
|  |  in pipelines: 148(GETNEXT), 09(OPEN)
|  |
|  147:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item_0.i_brand_id,tpcds_partitioned_parquet_snap.item_0.i_class_id,tpcds_partitioned_parquet_snap.item_0.i_category_id)]
|  |  mem-estimate=12.81MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=12 row-size=20B cardinality=17.89M cost=3634352
|  |  in pipelines: 09(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=37.25MB mem-reservation=17.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[31451484894, 32267182] cpu-comparison-result=120 [max(120 (self) vs 25 (sum children))]
|  14:AGGREGATE [STREAMING]
|  |  output: count()
|  |  group by: tpcds_partitioned_parquet_snap.item_0.i_brand_id, tpcds_partitioned_parquet_snap.item_0.i_class_id, tpcds_partitioned_parquet_snap.item_0.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=9.00MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=12 row-size=20B cardinality=17.89M cost=11947236639
|  |  in pipelines: 09(GETNEXT)
|  |
|  13:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=14
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk = tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=6,8,10 row-size=739B cardinality=8.64G cost=3779809729
|  |  in pipelines: 09(GETNEXT), 12(OPEN)
|  |
|  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=420.60MB mem-reservation=409.00MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=10 segment-costs=[838440]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  runtime filters: RF012[bloom] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk, RF013[min_max] <- tpcds_partitioned_parquet_snap.item_0.i_item_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |  |
|  |  146:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=10 row-size=405B cardinality=360.00K cost=478440
|  |  |  in pipelines: 12(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  |  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=4 segment-costs=[1757529]
|  |  12:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=33.54MB
|  |     stored statistics:
|  |       table: rows=360.00K size=33.54MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=101.54K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=10 row-size=405B cardinality=360.00K cost=1355609
|  |     in pipelines: 12(GETNEXT)
|  |
|  11:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=6,8 row-size=333B cardinality=8.64G(filtered from 8.64G) cost=3780592116
|  |  in pipelines: 09(GETNEXT), 10(OPEN)
|  |
|  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=36.39MB mem-reservation=34.50MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[17005]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=34.50MB mem-reservation=34.50MB spill-buffer=128.00KB thread-reservation=0 cost=7305
|  |  |
|  |  145:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=1.89MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=8 row-size=237B cardinality=7.30K cost=9700
|  |  |  in pipelines: 10(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[119540]
|  |  10:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim_0.d_year <= add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim_0.d_year >= CAST(1998 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=8 row-size=237B cardinality=7.30K cost=114705
|  |     in pipelines: 10(GETNEXT)
|  |
|  09:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF013[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk, RF012[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_item_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=6 row-size=96B cardinality=8.64G(filtered from 8.64G) cost=11943846410
|     in pipelines: 09(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=20
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=739B cardinality=511.32M cost=223870100
|  in pipelines: 02(GETNEXT), 05(OPEN)
|
|--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=385.60MB mem-reservation=374.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[838440]
|  JOIN BUILD
|  |  join-table-id=20 plan-id=21 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF003[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=374.00MB mem-reservation=374.00MB spill-buffer=2.00MB thread-reservation=0 cost=360000
|  |
|  144:EXCHANGE [BROADCAST]
|  |  mem-estimate=11.60MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=405B cardinality=360.00K cost=478440
|  |  in pipelines: 05(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=4 instances=4
|  Per-Instance Resources: mem-estimate=17.60MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=4 segment-costs=[1757529]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=33.54MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=360.00K size=33.54MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=101.54K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=405B cardinality=360.00K cost=1355609
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=21
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=333B cardinality=511.58M cost=223916426
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=22.36MB mem-reservation=22.31MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=10 segment-costs=[248]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  runtime filters: RF004[bloom] <- tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  143:EXCHANGE [BROADCAST]
|  |  mem-estimate=50.45KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=237B cardinality=108 cost=140
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[114776]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: tpcds_partitioned_parquet_snap.date_dim.d_year = add(CAST(1998 AS INT), CAST(2 AS INT)), tpcds_partitioned_parquet_snap.date_dim.d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=2 row-size=237B cardinality=108 cost=114705
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF001[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_item_sk, RF004[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=96B cardinality=511.58M(filtered from 8.64G) cost=707201433
   in pipelines: 02(GETNEXT)
====
