# TPCDS-Q04
# start query 4 in stream 0 using template query4.tpl using seed 466720613
with year_total as (
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total
       ,'s' sale_type
 from customer
     ,store_sales
     ,date_dim
 where c_customer_sk = ss_customer_sk
   and ss_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
 union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total
       ,'c' sale_type
 from customer
     ,catalog_sales
     ,date_dim
 where c_customer_sk = cs_bill_customer_sk
   and cs_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
union all
 select c_customer_id customer_id
       ,c_first_name customer_first_name
       ,c_last_name customer_last_name
       ,c_preferred_cust_flag customer_preferred_cust_flag
       ,c_birth_country customer_birth_country
       ,c_login customer_login
       ,c_email_address customer_email_address
       ,d_year dyear
       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total
       ,'w' sale_type
 from customer
     ,web_sales
     ,date_dim
 where c_customer_sk = ws_bill_customer_sk
   and ws_sold_date_sk = d_date_sk
 group by c_customer_id
         ,c_first_name
         ,c_last_name
         ,c_preferred_cust_flag
         ,c_birth_country
         ,c_login
         ,c_email_address
         ,d_year
         )
  select
                  t_s_secyear.customer_id
                 ,t_s_secyear.customer_first_name
                 ,t_s_secyear.customer_last_name
                 ,t_s_secyear.customer_birth_country
 from year_total t_s_firstyear
     ,year_total t_s_secyear
     ,year_total t_c_firstyear
     ,year_total t_c_secyear
     ,year_total t_w_firstyear
     ,year_total t_w_secyear
 where t_s_secyear.customer_id = t_s_firstyear.customer_id
   and t_s_firstyear.customer_id = t_c_secyear.customer_id
   and t_s_firstyear.customer_id = t_c_firstyear.customer_id
   and t_s_firstyear.customer_id = t_w_firstyear.customer_id
   and t_s_firstyear.customer_id = t_w_secyear.customer_id
   and t_s_firstyear.sale_type = 's'
   and t_c_firstyear.sale_type = 'c'
   and t_w_firstyear.sale_type = 'w'
   and t_s_secyear.sale_type = 's'
   and t_c_secyear.sale_type = 'c'
   and t_w_secyear.sale_type = 'w'
   and t_s_firstyear.dyear =  1999
   and t_s_secyear.dyear = 1999+1
   and t_c_firstyear.dyear =  1999
   and t_c_secyear.dyear =  1999+1
   and t_w_firstyear.dyear = 1999
   and t_w_secyear.dyear = 1999+1
   and t_s_firstyear.year_total > 0
   and t_c_firstyear.year_total > 0
   and t_w_firstyear.year_total > 0
   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end
           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end
   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end
           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end
 order by t_s_secyear.customer_id
         ,t_s_secyear.customer_first_name
         ,t_s_secyear.customer_last_name
         ,t_s_secyear.customer_birth_country
limit 100

# end query 4 in stream 0 using template query4.tpl
---- PLAN
Max Per-Host Resource Reservation: Memory=990.00MB Threads=1
Per-Host Resource Estimates: Memory=382.06GB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=382.06GB mem-reservation=990.00MB thread-reservation=1 runtime-filters-memory=160.00MB
|  max-parallelism=1 segment-costs=[56489724478, 35665892950, 17904128344, 56489724478, 35665892950, 17904128344, 56489724478, 35665892950, 17904128344, 56489724478, 35665892950, 17904128344, 56489724478, 35665892950, 17904128344, 56489724478, 35665892950, 17904128344, 234049227739, 400]
PLAN-ROOT SINK
|  output exprs: CUSTOMER_ID, CUSTOMER_FIRST_NAME, CUSTOMER_LAST_NAME, CUSTOMER_BIRTH_COUNTRY
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=400
|
131:TOP-N [LIMIT=100]
|  order by: CUSTOMER_ID ASC NULLS LAST, CUSTOMER_FIRST_NAME ASC NULLS LAST, CUSTOMER_LAST_NAME ASC NULLS LAST, CUSTOMER_BIRTH_COUNTRY ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=138 row-size=48B cardinality=100 cost=20108584520
|  in pipelines: 131(GETNEXT), 07(OPEN), 13(OPEN), 19(OPEN)
|
130:HASH JOIN [INNER JOIN]
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  other join predicates: CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END > CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END
|  mem-estimate=50.00GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68,91,114,137 row-size=696B cardinality=1.18G cost=1701289795
|  in pipelines: 07(GETNEXT), 13(GETNEXT), 19(GETNEXT), 116(OPEN), 122(OPEN), 128(OPEN)
|
|--129:SELECT
|  |  predicates: DYEAR = CAST(1999 AS INT), SALE_TYPE = 'w', YEAR_TOTAL > CAST(0 AS DECIMAL(3,0))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=116B cardinality=1.18G cost=35500236800
|  |  in pipelines: 116(GETNEXT), 122(GETNEXT), 128(GETNEXT)
|  |
|  109:UNION
|  |  pass-through-operands: 110
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 116(GETNEXT), 122(GETNEXT), 128(GETNEXT)
|  |
|  |--128:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_16.c_customer_id, tpcds_partitioned_parquet_snap.customer_16.c_first_name, tpcds_partitioned_parquet_snap.customer_16.c_last_name, tpcds_partitioned_parquet_snap.customer_16.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_16.c_birth_country, tpcds_partitioned_parquet_snap.customer_16.c_login, tpcds_partitioned_parquet_snap.customer_16.c_email_address, tpcds_partitioned_parquet_snap.date_dim_16.d_year
|  |  |  mem-estimate=7.64GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=136 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 128(GETNEXT), 123(OPEN)
|  |  |
|  |  127:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130,132,134 row-size=582B cardinality=1.99G cost=870089007
|  |  |  in pipelines: 123(GETNEXT), 126(OPEN)
|  |  |
|  |  |--126:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=134 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 126(GETNEXT)
|  |  |
|  |  125:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  runtime filters: RF071[min_max] <- tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130,132 row-size=344B cardinality=1.99G cost=900015958
|  |  |  in pipelines: 123(GETNEXT), 124(OPEN)
|  |  |
|  |  |--124:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=132 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 124(GETNEXT)
|  |  |
|  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF071[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=130 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 123(GETNEXT)
|  |
|  110:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=129 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 116(GETNEXT), 122(GETNEXT)
|  |
|  |--122:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_15.c_customer_id, tpcds_partitioned_parquet_snap.customer_15.c_first_name, tpcds_partitioned_parquet_snap.customer_15.c_last_name, tpcds_partitioned_parquet_snap.customer_15.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_15.c_birth_country, tpcds_partitioned_parquet_snap.customer_15.c_login, tpcds_partitioned_parquet_snap.customer_15.c_email_address, tpcds_partitioned_parquet_snap.date_dim_15.d_year
|  |  |  mem-estimate=10.25GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=128 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 122(GETNEXT), 117(OPEN)
|  |  |
|  |  121:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=122,124,126 row-size=582B cardinality=3.97G cost=1735865988
|  |  |  in pipelines: 117(GETNEXT), 120(OPEN)
|  |  |
|  |  |--120:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=126 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 120(GETNEXT)
|  |  |
|  |  119:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  runtime filters: RF067[min_max] <- tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=122,124 row-size=344B cardinality=3.97G cost=1765792939
|  |  |  in pipelines: 117(GETNEXT), 118(OPEN)
|  |  |
|  |  |--118:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=124 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 118(GETNEXT)
|  |  |
|  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF067[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=122 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 117(GETNEXT)
|  |
|  116:AGGREGATE [FINALIZE]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_14.c_customer_id, tpcds_partitioned_parquet_snap.customer_14.c_first_name, tpcds_partitioned_parquet_snap.customer_14.c_last_name, tpcds_partitioned_parquet_snap.customer_14.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_14.c_birth_country, tpcds_partitioned_parquet_snap.customer_14.c_login, tpcds_partitioned_parquet_snap.customer_14.c_email_address, tpcds_partitioned_parquet_snap.date_dim_14.d_year
|  |  mem-estimate=15.48GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=121 row-size=169B cardinality=5.88G cost=37525876254
|  |  in pipelines: 116(GETNEXT), 111(OPEN)
|  |
|  115:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=115,117,119 row-size=538B cardinality=7.93G cost=3471570225
|  |  in pipelines: 111(GETNEXT), 114(OPEN)
|  |
|  |--114:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=119 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 114(GETNEXT)
|  |
|  113:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  runtime filters: RF062[bloom] <- tpcds_partitioned_parquet_snap.customer_14.c_customer_sk, RF063[min_max] <- tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=115,117 row-size=300B cardinality=7.93G cost=3501497176
|  |  in pipelines: 111(GETNEXT), 112(OPEN)
|  |
|  |--112:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=117 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 112(GETNEXT)
|  |
|  111:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk, RF062[bloom] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=115 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 111(GETNEXT)
|
108:HASH JOIN [INNER JOIN]
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  mem-estimate=50.00GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68,91,114 row-size=580B cardinality=1.18G cost=1701289795
|  in pipelines: 07(GETNEXT), 13(GETNEXT), 19(GETNEXT), 94(OPEN), 100(OPEN), 106(OPEN)
|
|--107:SELECT
|  |  predicates: DYEAR = add(CAST(1999 AS INT), CAST(1 AS INT)), SALE_TYPE = 'w'
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=114 row-size=116B cardinality=1.18G cost=23666825216
|  |  in pipelines: 94(GETNEXT), 100(GETNEXT), 106(GETNEXT)
|  |
|  87:UNION
|  |  pass-through-operands: 88
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=114 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 94(GETNEXT), 100(GETNEXT), 106(GETNEXT)
|  |
|  |--106:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_13.c_customer_id, tpcds_partitioned_parquet_snap.customer_13.c_first_name, tpcds_partitioned_parquet_snap.customer_13.c_last_name, tpcds_partitioned_parquet_snap.customer_13.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_13.c_birth_country, tpcds_partitioned_parquet_snap.customer_13.c_login, tpcds_partitioned_parquet_snap.customer_13.c_email_address, tpcds_partitioned_parquet_snap.date_dim_13.d_year
|  |  |  mem-estimate=7.64GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=113 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 106(GETNEXT), 101(OPEN)
|  |  |
|  |  105:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=107,109,111 row-size=582B cardinality=1.99G cost=870089007
|  |  |  in pipelines: 101(GETNEXT), 104(OPEN)
|  |  |
|  |  |--104:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=111 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 104(GETNEXT)
|  |  |
|  |  103:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  runtime filters: RF059[min_max] <- tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=107,109 row-size=344B cardinality=1.99G cost=900015958
|  |  |  in pipelines: 101(GETNEXT), 102(OPEN)
|  |  |
|  |  |--102:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=109 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 102(GETNEXT)
|  |  |
|  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF059[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=107 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 101(GETNEXT)
|  |
|  88:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=106 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 94(GETNEXT), 100(GETNEXT)
|  |
|  |--100:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_12.c_customer_id, tpcds_partitioned_parquet_snap.customer_12.c_first_name, tpcds_partitioned_parquet_snap.customer_12.c_last_name, tpcds_partitioned_parquet_snap.customer_12.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_12.c_birth_country, tpcds_partitioned_parquet_snap.customer_12.c_login, tpcds_partitioned_parquet_snap.customer_12.c_email_address, tpcds_partitioned_parquet_snap.date_dim_12.d_year
|  |  |  mem-estimate=10.25GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=105 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 100(GETNEXT), 95(OPEN)
|  |  |
|  |  99:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99,101,103 row-size=582B cardinality=3.97G cost=1735865988
|  |  |  in pipelines: 95(GETNEXT), 98(OPEN)
|  |  |
|  |  |--98:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=103 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  97:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  runtime filters: RF055[min_max] <- tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99,101 row-size=344B cardinality=3.97G cost=1765792939
|  |  |  in pipelines: 95(GETNEXT), 96(OPEN)
|  |  |
|  |  |--96:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=101 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 96(GETNEXT)
|  |  |
|  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF055[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=99 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 95(GETNEXT)
|  |
|  94:AGGREGATE [FINALIZE]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_11.c_customer_id, tpcds_partitioned_parquet_snap.customer_11.c_first_name, tpcds_partitioned_parquet_snap.customer_11.c_last_name, tpcds_partitioned_parquet_snap.customer_11.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_11.c_birth_country, tpcds_partitioned_parquet_snap.customer_11.c_login, tpcds_partitioned_parquet_snap.customer_11.c_email_address, tpcds_partitioned_parquet_snap.date_dim_11.d_year
|  |  mem-estimate=15.48GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=98 row-size=169B cardinality=5.88G cost=37525876254
|  |  in pipelines: 94(GETNEXT), 89(OPEN)
|  |
|  93:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=92,94,96 row-size=538B cardinality=7.93G cost=3471570225
|  |  in pipelines: 89(GETNEXT), 92(OPEN)
|  |
|  |--92:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=96 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 92(GETNEXT)
|  |
|  91:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  runtime filters: RF050[bloom] <- tpcds_partitioned_parquet_snap.customer_11.c_customer_sk, RF051[min_max] <- tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=92,94 row-size=300B cardinality=7.93G cost=3501497176
|  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |
|  |--90:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=94 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 90(GETNEXT)
|  |
|  89:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF051[min_max] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk, RF050[bloom] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=92 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 89(GETNEXT)
|
86:HASH JOIN [INNER JOIN]
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  other join predicates: CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END > CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END
|  mem-estimate=50.00GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68,91 row-size=464B cardinality=1.18G cost=1701289795
|  in pipelines: 07(GETNEXT), 13(GETNEXT), 19(GETNEXT), 72(OPEN), 78(OPEN), 84(OPEN)
|
|--85:SELECT
|  |  predicates: DYEAR = CAST(1999 AS INT), SALE_TYPE = 'c', YEAR_TOTAL > CAST(0 AS DECIMAL(3,0))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=91 row-size=116B cardinality=1.18G cost=35500236800
|  |  in pipelines: 72(GETNEXT), 78(GETNEXT), 84(GETNEXT)
|  |
|  65:UNION
|  |  pass-through-operands: 66
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=91 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 72(GETNEXT), 78(GETNEXT), 84(GETNEXT)
|  |
|  |--84:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_10.c_customer_id, tpcds_partitioned_parquet_snap.customer_10.c_first_name, tpcds_partitioned_parquet_snap.customer_10.c_last_name, tpcds_partitioned_parquet_snap.customer_10.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_10.c_birth_country, tpcds_partitioned_parquet_snap.customer_10.c_login, tpcds_partitioned_parquet_snap.customer_10.c_email_address, tpcds_partitioned_parquet_snap.date_dim_10.d_year
|  |  |  mem-estimate=7.64GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=90 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 84(GETNEXT), 79(OPEN)
|  |  |
|  |  83:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=84,86,88 row-size=582B cardinality=1.99G cost=870089007
|  |  |  in pipelines: 79(GETNEXT), 82(OPEN)
|  |  |
|  |  |--82:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=88 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 82(GETNEXT)
|  |  |
|  |  81:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  runtime filters: RF047[min_max] <- tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=84,86 row-size=344B cardinality=1.99G cost=900015958
|  |  |  in pipelines: 79(GETNEXT), 80(OPEN)
|  |  |
|  |  |--80:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=86 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  79:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF047[min_max] -> tpcds_partitioned_parquet_snap.web_sales_2.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=84 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 79(GETNEXT)
|  |
|  66:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=83 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 72(GETNEXT), 78(GETNEXT)
|  |
|  |--78:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_9.c_customer_id, tpcds_partitioned_parquet_snap.customer_9.c_first_name, tpcds_partitioned_parquet_snap.customer_9.c_last_name, tpcds_partitioned_parquet_snap.customer_9.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_9.c_birth_country, tpcds_partitioned_parquet_snap.customer_9.c_login, tpcds_partitioned_parquet_snap.customer_9.c_email_address, tpcds_partitioned_parquet_snap.date_dim_9.d_year
|  |  |  mem-estimate=10.25GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 78(GETNEXT), 73(OPEN)
|  |  |
|  |  77:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=76,78,80 row-size=582B cardinality=3.97G cost=1735865988
|  |  |  in pipelines: 73(GETNEXT), 76(OPEN)
|  |  |
|  |  |--76:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=80 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 76(GETNEXT)
|  |  |
|  |  75:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  runtime filters: RF042[bloom] <- tpcds_partitioned_parquet_snap.customer_9.c_customer_sk, RF043[min_max] <- tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=76,78 row-size=344B cardinality=3.97G cost=1765792939
|  |  |  in pipelines: 73(GETNEXT), 74(OPEN)
|  |  |
|  |  |--74:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=78 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 74(GETNEXT)
|  |  |
|  |  73:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF043[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk, RF042[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=76 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 73(GETNEXT)
|  |
|  72:AGGREGATE [FINALIZE]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_8.c_customer_id, tpcds_partitioned_parquet_snap.customer_8.c_first_name, tpcds_partitioned_parquet_snap.customer_8.c_last_name, tpcds_partitioned_parquet_snap.customer_8.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_8.c_birth_country, tpcds_partitioned_parquet_snap.customer_8.c_login, tpcds_partitioned_parquet_snap.customer_8.c_email_address, tpcds_partitioned_parquet_snap.date_dim_8.d_year
|  |  mem-estimate=15.48GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=75 row-size=169B cardinality=5.88G cost=37525876254
|  |  in pipelines: 72(GETNEXT), 67(OPEN)
|  |
|  71:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=69,71,73 row-size=538B cardinality=7.93G cost=3471570225
|  |  in pipelines: 67(GETNEXT), 70(OPEN)
|  |
|  |--70:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=73 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 70(GETNEXT)
|  |
|  69:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  runtime filters: RF038[bloom] <- tpcds_partitioned_parquet_snap.customer_8.c_customer_sk, RF039[min_max] <- tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=69,71 row-size=300B cardinality=7.93G cost=3501497176
|  |  in pipelines: 67(GETNEXT), 68(OPEN)
|  |
|  |--68:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=71 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 68(GETNEXT)
|  |
|  67:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk, RF038[bloom] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=69 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 67(GETNEXT)
|
64:HASH JOIN [INNER JOIN]
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  mem-estimate=50.00GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68 row-size=348B cardinality=1.18G cost=1701289795
|  in pipelines: 07(GETNEXT), 13(GETNEXT), 19(GETNEXT), 50(OPEN), 56(OPEN), 62(OPEN)
|
|--63:SELECT
|  |  predicates: DYEAR = add(CAST(1999 AS INT), CAST(1 AS INT)), SALE_TYPE = 'c'
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68 row-size=116B cardinality=1.18G cost=23666825216
|  |  in pipelines: 50(GETNEXT), 56(GETNEXT), 62(GETNEXT)
|  |
|  43:UNION
|  |  pass-through-operands: 44
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 50(GETNEXT), 56(GETNEXT), 62(GETNEXT)
|  |
|  |--62:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_7.c_customer_id, tpcds_partitioned_parquet_snap.customer_7.c_first_name, tpcds_partitioned_parquet_snap.customer_7.c_last_name, tpcds_partitioned_parquet_snap.customer_7.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_7.c_birth_country, tpcds_partitioned_parquet_snap.customer_7.c_login, tpcds_partitioned_parquet_snap.customer_7.c_email_address, tpcds_partitioned_parquet_snap.date_dim_7.d_year
|  |  |  mem-estimate=7.64GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=67 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 62(GETNEXT), 57(OPEN)
|  |  |
|  |  61:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=61,63,65 row-size=582B cardinality=1.99G cost=870089007
|  |  |  in pipelines: 57(GETNEXT), 60(OPEN)
|  |  |
|  |  |--60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=65 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 60(GETNEXT)
|  |  |
|  |  59:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  runtime filters: RF035[min_max] <- tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=61,63 row-size=344B cardinality=1.99G cost=900015958
|  |  |  in pipelines: 57(GETNEXT), 58(OPEN)
|  |  |
|  |  |--58:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=63 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 58(GETNEXT)
|  |  |
|  |  57:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF035[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=61 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 57(GETNEXT)
|  |
|  44:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=60 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 50(GETNEXT), 56(GETNEXT)
|  |
|  |--56:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_6.c_customer_id, tpcds_partitioned_parquet_snap.customer_6.c_first_name, tpcds_partitioned_parquet_snap.customer_6.c_last_name, tpcds_partitioned_parquet_snap.customer_6.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_6.c_birth_country, tpcds_partitioned_parquet_snap.customer_6.c_login, tpcds_partitioned_parquet_snap.customer_6.c_email_address, tpcds_partitioned_parquet_snap.date_dim_6.d_year
|  |  |  mem-estimate=10.25GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=59 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 56(GETNEXT), 51(OPEN)
|  |  |
|  |  55:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=53,55,57 row-size=582B cardinality=3.97G cost=1735865988
|  |  |  in pipelines: 51(GETNEXT), 54(OPEN)
|  |  |
|  |  |--54:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=57 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 54(GETNEXT)
|  |  |
|  |  53:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  runtime filters: RF030[bloom] <- tpcds_partitioned_parquet_snap.customer_6.c_customer_sk, RF031[min_max] <- tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=53,55 row-size=344B cardinality=3.97G cost=1765792939
|  |  |  in pipelines: 51(GETNEXT), 52(OPEN)
|  |  |
|  |  |--52:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=55 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 52(GETNEXT)
|  |  |
|  |  51:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk, RF030[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=53 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 51(GETNEXT)
|  |
|  50:AGGREGATE [FINALIZE]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_5.c_customer_id, tpcds_partitioned_parquet_snap.customer_5.c_first_name, tpcds_partitioned_parquet_snap.customer_5.c_last_name, tpcds_partitioned_parquet_snap.customer_5.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_5.c_birth_country, tpcds_partitioned_parquet_snap.customer_5.c_login, tpcds_partitioned_parquet_snap.customer_5.c_email_address, tpcds_partitioned_parquet_snap.date_dim_5.d_year
|  |  mem-estimate=15.48GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=52 row-size=169B cardinality=5.88G cost=37525876254
|  |  in pipelines: 50(GETNEXT), 45(OPEN)
|  |
|  49:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=46,48,50 row-size=538B cardinality=7.93G cost=3471570225
|  |  in pipelines: 45(GETNEXT), 48(OPEN)
|  |
|  |--48:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=50 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 48(GETNEXT)
|  |
|  47:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  runtime filters: RF026[bloom] <- tpcds_partitioned_parquet_snap.customer_5.c_customer_sk, RF027[min_max] <- tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=46,48 row-size=300B cardinality=7.93G cost=3501497176
|  |  in pipelines: 45(GETNEXT), 46(OPEN)
|  |
|  |--46:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=48 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 46(GETNEXT)
|  |
|  45:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF027[min_max] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk, RF026[bloom] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=46 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 45(GETNEXT)
|
42:HASH JOIN [INNER JOIN]
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  mem-estimate=50.00GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45 row-size=232B cardinality=1.18G cost=1701289795
|  in pipelines: 07(GETNEXT), 13(GETNEXT), 19(GETNEXT), 28(OPEN), 34(OPEN), 40(OPEN)
|
|--41:SELECT
|  |  predicates: DYEAR = CAST(1999 AS INT), SALE_TYPE = 's', YEAR_TOTAL > CAST(0 AS DECIMAL(3,0))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=116B cardinality=1.18G cost=35500236800
|  |  in pipelines: 28(GETNEXT), 34(GETNEXT), 40(GETNEXT)
|  |
|  21:UNION
|  |  pass-through-operands: 22
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 28(GETNEXT), 34(GETNEXT), 40(GETNEXT)
|  |
|  |--40:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_4.c_customer_id, tpcds_partitioned_parquet_snap.customer_4.c_first_name, tpcds_partitioned_parquet_snap.customer_4.c_last_name, tpcds_partitioned_parquet_snap.customer_4.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_4.c_birth_country, tpcds_partitioned_parquet_snap.customer_4.c_login, tpcds_partitioned_parquet_snap.customer_4.c_email_address, tpcds_partitioned_parquet_snap.date_dim_4.d_year
|  |  |  mem-estimate=7.64GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=44 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 40(GETNEXT), 35(OPEN)
|  |  |
|  |  39:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=38,40,42 row-size=582B cardinality=1.99G cost=870089007
|  |  |  in pipelines: 35(GETNEXT), 38(OPEN)
|  |  |
|  |  |--38:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=42 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 38(GETNEXT)
|  |  |
|  |  37:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  runtime filters: RF023[min_max] <- tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=38,40 row-size=344B cardinality=1.99G cost=900015958
|  |  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |  |
|  |  |--36:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=40 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 36(GETNEXT)
|  |  |
|  |  35:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF023[min_max] -> tpcds_partitioned_parquet_snap.web_sales_0.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=38 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 35(GETNEXT)
|  |
|  22:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=37 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 28(GETNEXT), 34(GETNEXT)
|  |
|  |--34:AGGREGATE [FINALIZE]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_3.c_customer_id, tpcds_partitioned_parquet_snap.customer_3.c_first_name, tpcds_partitioned_parquet_snap.customer_3.c_last_name, tpcds_partitioned_parquet_snap.customer_3.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_3.c_birth_country, tpcds_partitioned_parquet_snap.customer_3.c_login, tpcds_partitioned_parquet_snap.customer_3.c_email_address, tpcds_partitioned_parquet_snap.date_dim_3.d_year
|  |  |  mem-estimate=10.25GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=36 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 34(GETNEXT), 29(OPEN)
|  |  |
|  |  33:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=30,32,34 row-size=582B cardinality=3.97G cost=1735865988
|  |  |  in pipelines: 29(GETNEXT), 32(OPEN)
|  |  |
|  |  |--32:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=34 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 32(GETNEXT)
|  |  |
|  |  31:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  runtime filters: RF018[bloom] <- tpcds_partitioned_parquet_snap.customer_3.c_customer_sk, RF019[min_max] <- tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=30,32 row-size=344B cardinality=3.97G cost=1765792939
|  |  |  in pipelines: 29(GETNEXT), 30(OPEN)
|  |  |
|  |  |--30:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=32 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 30(GETNEXT)
|  |  |
|  |  29:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF019[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk, RF018[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=30 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 29(GETNEXT)
|  |
|  28:AGGREGATE [FINALIZE]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_2.c_customer_id, tpcds_partitioned_parquet_snap.customer_2.c_first_name, tpcds_partitioned_parquet_snap.customer_2.c_last_name, tpcds_partitioned_parquet_snap.customer_2.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_2.c_birth_country, tpcds_partitioned_parquet_snap.customer_2.c_login, tpcds_partitioned_parquet_snap.customer_2.c_email_address, tpcds_partitioned_parquet_snap.date_dim_2.d_year
|  |  mem-estimate=15.48GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=29 row-size=169B cardinality=5.88G cost=37525876254
|  |  in pipelines: 28(GETNEXT), 23(OPEN)
|  |
|  27:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=23,25,27 row-size=538B cardinality=7.93G cost=3471570225
|  |  in pipelines: 23(GETNEXT), 26(OPEN)
|  |
|  |--26:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=27 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 26(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  runtime filters: RF014[bloom] <- tpcds_partitioned_parquet_snap.customer_2.c_customer_sk, RF015[min_max] <- tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=23,25 row-size=300B cardinality=7.93G cost=3501497176
|  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |
|  |--24:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=25 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF015[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk, RF014[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=23 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 23(GETNEXT)
|
20:SELECT
|  predicates: DYEAR = add(CAST(1999 AS INT), CAST(1 AS INT)), SALE_TYPE = 's'
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=116B cardinality=1.18G cost=23666825216
|  in pipelines: 07(GETNEXT), 13(GETNEXT), 19(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=116B cardinality=11.83G cost=782000635
|  in pipelines: 07(GETNEXT), 13(GETNEXT), 19(GETNEXT)
|
|--19:AGGREGATE [FINALIZE]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_1.c_customer_id, tpcds_partitioned_parquet_snap.customer_1.c_first_name, tpcds_partitioned_parquet_snap.customer_1.c_last_name, tpcds_partitioned_parquet_snap.customer_1.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_1.c_birth_country, tpcds_partitioned_parquet_snap.customer_1.c_login, tpcds_partitioned_parquet_snap.customer_1.c_email_address, tpcds_partitioned_parquet_snap.date_dim_1.d_year
|  |  mem-estimate=7.64GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=21 row-size=169B cardinality=1.99G cost=11732593545
|  |  in pipelines: 19(GETNEXT), 14(OPEN)
|  |
|  18:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=15,17,19 row-size=582B cardinality=1.99G cost=870089007
|  |  in pipelines: 14(GETNEXT), 17(OPEN)
|  |
|  |--17:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=19 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 17(GETNEXT)
|  |
|  16:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  runtime filters: RF011[min_max] <- tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=15,17 row-size=344B cardinality=1.99G cost=900015958
|  |  in pipelines: 14(GETNEXT), 15(OPEN)
|  |
|  |--15:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=17 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 15(GETNEXT)
|  |
|  14:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF011[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|     tuple-ids=15 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|     in pipelines: 14(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=14 row-size=116B cardinality=9.85G cost=3873500731
|  in pipelines: 07(GETNEXT), 13(GETNEXT)
|
|--13:AGGREGATE [FINALIZE]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_0.c_customer_id, tpcds_partitioned_parquet_snap.customer_0.c_first_name, tpcds_partitioned_parquet_snap.customer_0.c_last_name, tpcds_partitioned_parquet_snap.customer_0.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_0.c_birth_country, tpcds_partitioned_parquet_snap.customer_0.c_login, tpcds_partitioned_parquet_snap.customer_0.c_email_address, tpcds_partitioned_parquet_snap.date_dim_0.d_year
|  |  mem-estimate=10.25GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=13 row-size=169B cardinality=3.97G cost=23408022405
|  |  in pipelines: 13(GETNEXT), 08(OPEN)
|  |
|  12:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=7,9,11 row-size=582B cardinality=3.97G cost=1735865988
|  |  in pipelines: 08(GETNEXT), 11(OPEN)
|  |
|  |--11:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=11 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 11(GETNEXT)
|  |
|  10:HASH JOIN [INNER JOIN]
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.customer_0.c_customer_sk, RF007[min_max] <- tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=7,9 row-size=344B cardinality=3.97G cost=1765792939
|  |  in pipelines: 08(GETNEXT), 09(OPEN)
|  |
|  |--09:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=9 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 09(GETNEXT)
|  |
|  08:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF007[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=7 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|     in pipelines: 08(GETNEXT)
|
07:AGGREGATE [FINALIZE]
|  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  group by: tpcds_partitioned_parquet_snap.customer.c_customer_id, tpcds_partitioned_parquet_snap.customer.c_first_name, tpcds_partitioned_parquet_snap.customer.c_last_name, tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer.c_birth_country, tpcds_partitioned_parquet_snap.customer.c_login, tpcds_partitioned_parquet_snap.customer.c_email_address, tpcds_partitioned_parquet_snap.date_dim.d_year
|  mem-estimate=15.48GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=6 row-size=169B cardinality=5.88G cost=37525876254
|  in pipelines: 07(GETNEXT), 02(OPEN)
|
06:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=538B cardinality=7.93G cost=3471570225
|  in pipelines: 02(GETNEXT), 05(OPEN)
|
|--05:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=4 row-size=237B cardinality=73.05K cost=110600
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN]
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk, RF003[min_max] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  mem-estimate=6.46GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2 row-size=300B cardinality=7.93G cost=3501497176
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_partitioned_parquet_snap.customer]
|     HDFS partitions=1/1 files=1 size=1.55GB
|     stored statistics:
|       table: rows=30.00M size=1.55GB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.10M
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=2 row-size=204B cardinality=30.00M cost=46823813
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
   in pipelines: 02(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=26.29GB Threads=409
Per-Host Resource Estimates: Memory=1.25TB
F85:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.40MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[434] cpu-comparison-result=2160 [max(1 (self) vs 2160 (sum children))]
PLAN-ROOT SINK
|  output exprs: CUSTOMER_ID, CUSTOMER_FIRST_NAME, CUSTOMER_LAST_NAME, CUSTOMER_BIRTH_COUNTRY
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=400
|
210:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CUSTOMER_ID ASC NULLS LAST, CUSTOMER_FIRST_NAME ASC NULLS LAST, CUSTOMER_LAST_NAME ASC NULLS LAST, CUSTOMER_BIRTH_COUNTRY ASC NULLS LAST
|  limit: 100
|  mem-estimate=406.72KB mem-reservation=0B thread-reservation=0
|  tuple-ids=138 row-size=48B cardinality=100 cost=34
|  in pipelines: 131(GETNEXT)
|
F28:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
Per-Instance Resources: mem-estimate=24.07MB mem-reservation=0B thread-reservation=1
max-parallelism=2350 segment-costs=[23461227104, 157] cpu-comparison-result=2160 [max(80 (self) vs 2160 (sum children))]
131:TOP-N [LIMIT=100]
|  order by: CUSTOMER_ID ASC NULLS LAST, CUSTOMER_FIRST_NAME ASC NULLS LAST, CUSTOMER_LAST_NAME ASC NULLS LAST, CUSTOMER_BIRTH_COUNTRY ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=138 row-size=48B cardinality=100 cost=20108584520
|  in pipelines: 131(GETNEXT), 135(OPEN), 139(OPEN), 143(OPEN)
|
130:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=00
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  other join predicates: CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END > CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68,91,114,137 row-size=696B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 200(OPEN), 204(OPEN), 208(OPEN)
|
|--F86:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  209:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 200(GETNEXT), 204(GETNEXT), 208(GETNEXT)
|  |
|  F84:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 49605428499] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  129:SELECT
|  |  predicates: DYEAR = CAST(1999 AS INT), SALE_TYPE = 'w', YEAR_TOTAL > CAST(0 AS DECIMAL(3,0))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=116B cardinality=1.18G cost=35500236800
|  |  in pipelines: 200(GETNEXT), 204(GETNEXT), 208(GETNEXT)
|  |
|  109:UNION
|  |  pass-through-operands: 110
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 200(GETNEXT), 204(GETNEXT), 208(GETNEXT)
|  |
|  |--208:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_16.c_customer_id, tpcds_partitioned_parquet_snap.customer_16.c_first_name, tpcds_partitioned_parquet_snap.customer_16.c_last_name, tpcds_partitioned_parquet_snap.customer_16.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_16.c_birth_country, tpcds_partitioned_parquet_snap.customer_16.c_login, tpcds_partitioned_parquet_snap.customer_16.c_email_address, tpcds_partitioned_parquet_snap.date_dim_16.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=136 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 208(GETNEXT), 123(OPEN)
|  |  |
|  |  207:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_16.c_customer_id,tpcds_partitioned_parquet_snap.customer_16.c_first_name,tpcds_partitioned_parquet_snap.customer_16.c_last_name,tpcds_partitioned_parquet_snap.customer_16.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_16.c_birth_country,tpcds_partitioned_parquet_snap.customer_16.c_login,tpcds_partitioned_parquet_snap.customer_16.c_email_address,tpcds_partitioned_parquet_snap.date_dim_16.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=136 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 123(GETNEXT)
|  |  |
|  |  F80:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  128:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_16.c_customer_id, tpcds_partitioned_parquet_snap.customer_16.c_first_name, tpcds_partitioned_parquet_snap.customer_16.c_last_name, tpcds_partitioned_parquet_snap.customer_16.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_16.c_birth_country, tpcds_partitioned_parquet_snap.customer_16.c_login, tpcds_partitioned_parquet_snap.customer_16.c_email_address, tpcds_partitioned_parquet_snap.date_dim_16.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=136 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 123(GETNEXT)
|  |  |
|  |  127:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130,132,134 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 123(GETNEXT), 126(OPEN)
|  |  |
|  |  |--F91:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  206:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=134 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 126(GETNEXT)
|  |  |  |
|  |  |  F82:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=134 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 126(GETNEXT)
|  |  |
|  |  125:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=06
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130,132 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 123(GETNEXT), 124(OPEN)
|  |  |
|  |  |--F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=06 plan-id=07 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  |  runtime filters: RF071[min_max] <- tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  205:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=132 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 124(GETNEXT)
|  |  |  |
|  |  |  F81:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  124:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=132 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 124(GETNEXT)
|  |  |
|  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF071[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=130 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 123(GETNEXT)
|  |
|  110:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=129 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 200(GETNEXT), 204(GETNEXT)
|  |
|  |--204:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_15.c_customer_id, tpcds_partitioned_parquet_snap.customer_15.c_first_name, tpcds_partitioned_parquet_snap.customer_15.c_last_name, tpcds_partitioned_parquet_snap.customer_15.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_15.c_birth_country, tpcds_partitioned_parquet_snap.customer_15.c_login, tpcds_partitioned_parquet_snap.customer_15.c_email_address, tpcds_partitioned_parquet_snap.date_dim_15.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=128 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 204(GETNEXT), 117(OPEN)
|  |  |
|  |  203:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_15.c_customer_id,tpcds_partitioned_parquet_snap.customer_15.c_first_name,tpcds_partitioned_parquet_snap.customer_15.c_last_name,tpcds_partitioned_parquet_snap.customer_15.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_15.c_birth_country,tpcds_partitioned_parquet_snap.customer_15.c_login,tpcds_partitioned_parquet_snap.customer_15.c_email_address,tpcds_partitioned_parquet_snap.date_dim_15.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=128 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 117(GETNEXT)
|  |  |
|  |  F75:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  122:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_15.c_customer_id, tpcds_partitioned_parquet_snap.customer_15.c_first_name, tpcds_partitioned_parquet_snap.customer_15.c_last_name, tpcds_partitioned_parquet_snap.customer_15.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_15.c_birth_country, tpcds_partitioned_parquet_snap.customer_15.c_login, tpcds_partitioned_parquet_snap.customer_15.c_email_address, tpcds_partitioned_parquet_snap.date_dim_15.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=128 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 117(GETNEXT)
|  |  |
|  |  121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=122,124,126 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 117(GETNEXT), 120(OPEN)
|  |  |
|  |  |--F89:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  202:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=126 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  F77:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  120:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=126 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 120(GETNEXT)
|  |  |
|  |  119:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=04
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=122,124 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 117(GETNEXT), 118(OPEN)
|  |  |
|  |  |--F90:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=04 plan-id=05 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  |  runtime filters: RF067[min_max] <- tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  201:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 118(GETNEXT)
|  |  |  |
|  |  |  F76:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  118:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=124 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 118(GETNEXT)
|  |  |
|  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF067[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=122 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 117(GETNEXT)
|  |
|  200:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_14.c_customer_id, tpcds_partitioned_parquet_snap.customer_14.c_first_name, tpcds_partitioned_parquet_snap.customer_14.c_last_name, tpcds_partitioned_parquet_snap.customer_14.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_14.c_birth_country, tpcds_partitioned_parquet_snap.customer_14.c_login, tpcds_partitioned_parquet_snap.customer_14.c_email_address, tpcds_partitioned_parquet_snap.date_dim_14.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=121 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 200(GETNEXT), 111(OPEN)
|  |
|  199:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_14.c_customer_id,tpcds_partitioned_parquet_snap.customer_14.c_first_name,tpcds_partitioned_parquet_snap.customer_14.c_last_name,tpcds_partitioned_parquet_snap.customer_14.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_14.c_birth_country,tpcds_partitioned_parquet_snap.customer_14.c_login,tpcds_partitioned_parquet_snap.customer_14.c_email_address,tpcds_partitioned_parquet_snap.date_dim_14.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=121 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 111(GETNEXT)
|  |
|  F71:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  116:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_14.c_customer_id, tpcds_partitioned_parquet_snap.customer_14.c_first_name, tpcds_partitioned_parquet_snap.customer_14.c_last_name, tpcds_partitioned_parquet_snap.customer_14.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_14.c_birth_country, tpcds_partitioned_parquet_snap.customer_14.c_login, tpcds_partitioned_parquet_snap.customer_14.c_email_address, tpcds_partitioned_parquet_snap.date_dim_14.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=121 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 111(GETNEXT)
|  |
|  115:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=115,117,119 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 111(GETNEXT), 114(OPEN)
|  |
|  |--F87:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  198:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=119 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 114(GETNEXT)
|  |  |
|  |  F73:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  114:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=119 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 114(GETNEXT)
|  |
|  113:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=02
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=115,117 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 111(GETNEXT), 112(OPEN)
|  |
|  |--F88:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  |  runtime filters: RF062[bloom] <- tpcds_partitioned_parquet_snap.customer_14.c_customer_sk, RF063[min_max] <- tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  197:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=117 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 112(GETNEXT)
|  |  |
|  |  F72:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  112:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=117 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 112(GETNEXT)
|  |
|  111:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk, RF062[bloom] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=115 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 111(GETNEXT)
|
108:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=07
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68,91,114 row-size=580B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 187(OPEN), 191(OPEN), 195(OPEN)
|
|--F93:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=07 plan-id=08 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  196:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=114 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 187(GETNEXT), 191(GETNEXT), 195(GETNEXT)
|  |
|  F70:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 37772016915] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  107:SELECT
|  |  predicates: DYEAR = add(CAST(1999 AS INT), CAST(1 AS INT)), SALE_TYPE = 'w'
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=114 row-size=116B cardinality=1.18G cost=23666825216
|  |  in pipelines: 187(GETNEXT), 191(GETNEXT), 195(GETNEXT)
|  |
|  87:UNION
|  |  pass-through-operands: 88
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=114 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 187(GETNEXT), 191(GETNEXT), 195(GETNEXT)
|  |
|  |--195:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_13.c_customer_id, tpcds_partitioned_parquet_snap.customer_13.c_first_name, tpcds_partitioned_parquet_snap.customer_13.c_last_name, tpcds_partitioned_parquet_snap.customer_13.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_13.c_birth_country, tpcds_partitioned_parquet_snap.customer_13.c_login, tpcds_partitioned_parquet_snap.customer_13.c_email_address, tpcds_partitioned_parquet_snap.date_dim_13.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=113 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 195(GETNEXT), 101(OPEN)
|  |  |
|  |  194:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_13.c_customer_id,tpcds_partitioned_parquet_snap.customer_13.c_first_name,tpcds_partitioned_parquet_snap.customer_13.c_last_name,tpcds_partitioned_parquet_snap.customer_13.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_13.c_birth_country,tpcds_partitioned_parquet_snap.customer_13.c_login,tpcds_partitioned_parquet_snap.customer_13.c_email_address,tpcds_partitioned_parquet_snap.date_dim_13.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=113 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 101(GETNEXT)
|  |  |
|  |  F66:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  106:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_13.c_customer_id, tpcds_partitioned_parquet_snap.customer_13.c_first_name, tpcds_partitioned_parquet_snap.customer_13.c_last_name, tpcds_partitioned_parquet_snap.customer_13.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_13.c_birth_country, tpcds_partitioned_parquet_snap.customer_13.c_login, tpcds_partitioned_parquet_snap.customer_13.c_email_address, tpcds_partitioned_parquet_snap.date_dim_13.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=113 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 101(GETNEXT)
|  |  |
|  |  105:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=12
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=107,109,111 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 101(GETNEXT), 104(OPEN)
|  |  |
|  |  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=12 plan-id=13 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  193:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=111 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  104:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=111 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 104(GETNEXT)
|  |  |
|  |  103:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=13
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=107,109 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 101(GETNEXT), 102(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=13 plan-id=14 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  |  runtime filters: RF059[min_max] <- tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  192:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=109 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  102:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=109 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 102(GETNEXT)
|  |  |
|  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF059[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=107 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 101(GETNEXT)
|  |
|  88:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=106 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 187(GETNEXT), 191(GETNEXT)
|  |
|  |--191:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_12.c_customer_id, tpcds_partitioned_parquet_snap.customer_12.c_first_name, tpcds_partitioned_parquet_snap.customer_12.c_last_name, tpcds_partitioned_parquet_snap.customer_12.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_12.c_birth_country, tpcds_partitioned_parquet_snap.customer_12.c_login, tpcds_partitioned_parquet_snap.customer_12.c_email_address, tpcds_partitioned_parquet_snap.date_dim_12.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=105 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 191(GETNEXT), 95(OPEN)
|  |  |
|  |  190:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_12.c_customer_id,tpcds_partitioned_parquet_snap.customer_12.c_first_name,tpcds_partitioned_parquet_snap.customer_12.c_last_name,tpcds_partitioned_parquet_snap.customer_12.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_12.c_birth_country,tpcds_partitioned_parquet_snap.customer_12.c_login,tpcds_partitioned_parquet_snap.customer_12.c_email_address,tpcds_partitioned_parquet_snap.date_dim_12.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=105 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 95(GETNEXT)
|  |  |
|  |  F61:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  100:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_12.c_customer_id, tpcds_partitioned_parquet_snap.customer_12.c_first_name, tpcds_partitioned_parquet_snap.customer_12.c_last_name, tpcds_partitioned_parquet_snap.customer_12.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_12.c_birth_country, tpcds_partitioned_parquet_snap.customer_12.c_login, tpcds_partitioned_parquet_snap.customer_12.c_email_address, tpcds_partitioned_parquet_snap.date_dim_12.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=105 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 95(GETNEXT)
|  |  |
|  |  99:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=10
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99,101,103 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 95(GETNEXT), 98(OPEN)
|  |  |
|  |  |--F96:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=10 plan-id=11 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  189:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=103 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  F63:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=103 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  97:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=11
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99,101 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 95(GETNEXT), 96(OPEN)
|  |  |
|  |  |--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=11 plan-id=12 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  |  runtime filters: RF055[min_max] <- tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  188:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=101 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 96(GETNEXT)
|  |  |  |
|  |  |  F62:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  96:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=101 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 96(GETNEXT)
|  |  |
|  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF055[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=99 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 95(GETNEXT)
|  |
|  187:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_11.c_customer_id, tpcds_partitioned_parquet_snap.customer_11.c_first_name, tpcds_partitioned_parquet_snap.customer_11.c_last_name, tpcds_partitioned_parquet_snap.customer_11.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_11.c_birth_country, tpcds_partitioned_parquet_snap.customer_11.c_login, tpcds_partitioned_parquet_snap.customer_11.c_email_address, tpcds_partitioned_parquet_snap.date_dim_11.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=98 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 187(GETNEXT), 89(OPEN)
|  |
|  186:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_11.c_customer_id,tpcds_partitioned_parquet_snap.customer_11.c_first_name,tpcds_partitioned_parquet_snap.customer_11.c_last_name,tpcds_partitioned_parquet_snap.customer_11.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_11.c_birth_country,tpcds_partitioned_parquet_snap.customer_11.c_login,tpcds_partitioned_parquet_snap.customer_11.c_email_address,tpcds_partitioned_parquet_snap.date_dim_11.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=98 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 89(GETNEXT)
|  |
|  F57:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  94:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_11.c_customer_id, tpcds_partitioned_parquet_snap.customer_11.c_first_name, tpcds_partitioned_parquet_snap.customer_11.c_last_name, tpcds_partitioned_parquet_snap.customer_11.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_11.c_birth_country, tpcds_partitioned_parquet_snap.customer_11.c_login, tpcds_partitioned_parquet_snap.customer_11.c_email_address, tpcds_partitioned_parquet_snap.date_dim_11.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=98 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 89(GETNEXT)
|  |
|  93:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=08
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=92,94,96 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 89(GETNEXT), 92(OPEN)
|  |
|  |--F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  185:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 92(GETNEXT)
|  |  |
|  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  92:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=96 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 92(GETNEXT)
|  |
|  91:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=09
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=92,94 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |
|  |--F95:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=09 plan-id=10 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  |  runtime filters: RF050[bloom] <- tpcds_partitioned_parquet_snap.customer_11.c_customer_sk, RF051[min_max] <- tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  184:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=94 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 90(GETNEXT)
|  |  |
|  |  F58:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  90:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=94 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 90(GETNEXT)
|  |
|  89:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF051[min_max] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk, RF050[bloom] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=92 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 89(GETNEXT)
|
86:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=14
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  other join predicates: CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END > CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68,91 row-size=464B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 174(OPEN), 178(OPEN), 182(OPEN)
|
|--F100:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=14 plan-id=15 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  183:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=91 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 174(GETNEXT), 178(GETNEXT), 182(GETNEXT)
|  |
|  F56:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 49605428499] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  85:SELECT
|  |  predicates: DYEAR = CAST(1999 AS INT), SALE_TYPE = 'c', YEAR_TOTAL > CAST(0 AS DECIMAL(3,0))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=91 row-size=116B cardinality=1.18G cost=35500236800
|  |  in pipelines: 174(GETNEXT), 178(GETNEXT), 182(GETNEXT)
|  |
|  65:UNION
|  |  pass-through-operands: 66
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=91 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 174(GETNEXT), 178(GETNEXT), 182(GETNEXT)
|  |
|  |--182:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_10.c_customer_id, tpcds_partitioned_parquet_snap.customer_10.c_first_name, tpcds_partitioned_parquet_snap.customer_10.c_last_name, tpcds_partitioned_parquet_snap.customer_10.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_10.c_birth_country, tpcds_partitioned_parquet_snap.customer_10.c_login, tpcds_partitioned_parquet_snap.customer_10.c_email_address, tpcds_partitioned_parquet_snap.date_dim_10.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=90 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 182(GETNEXT), 79(OPEN)
|  |  |
|  |  181:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_10.c_customer_id,tpcds_partitioned_parquet_snap.customer_10.c_first_name,tpcds_partitioned_parquet_snap.customer_10.c_last_name,tpcds_partitioned_parquet_snap.customer_10.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_10.c_birth_country,tpcds_partitioned_parquet_snap.customer_10.c_login,tpcds_partitioned_parquet_snap.customer_10.c_email_address,tpcds_partitioned_parquet_snap.date_dim_10.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=90 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 79(GETNEXT)
|  |  |
|  |  F52:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  84:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_10.c_customer_id, tpcds_partitioned_parquet_snap.customer_10.c_first_name, tpcds_partitioned_parquet_snap.customer_10.c_last_name, tpcds_partitioned_parquet_snap.customer_10.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_10.c_birth_country, tpcds_partitioned_parquet_snap.customer_10.c_login, tpcds_partitioned_parquet_snap.customer_10.c_email_address, tpcds_partitioned_parquet_snap.date_dim_10.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=90 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 79(GETNEXT)
|  |  |
|  |  83:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=19
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=84,86,88 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 79(GETNEXT), 82(OPEN)
|  |  |
|  |  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=19 plan-id=20 cohort-id=10
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=88 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 82(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  82:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=88 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 82(GETNEXT)
|  |  |
|  |  81:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=20
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=84,86 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 79(GETNEXT), 80(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=20 plan-id=21 cohort-id=10
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  |  runtime filters: RF047[min_max] <- tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  179:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=86 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 80(GETNEXT)
|  |  |  |
|  |  |  F53:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=86 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  79:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF047[min_max] -> tpcds_partitioned_parquet_snap.web_sales_2.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=84 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 79(GETNEXT)
|  |
|  66:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=83 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 174(GETNEXT), 178(GETNEXT)
|  |
|  |--178:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_9.c_customer_id, tpcds_partitioned_parquet_snap.customer_9.c_first_name, tpcds_partitioned_parquet_snap.customer_9.c_last_name, tpcds_partitioned_parquet_snap.customer_9.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_9.c_birth_country, tpcds_partitioned_parquet_snap.customer_9.c_login, tpcds_partitioned_parquet_snap.customer_9.c_email_address, tpcds_partitioned_parquet_snap.date_dim_9.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 178(GETNEXT), 73(OPEN)
|  |  |
|  |  177:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_9.c_customer_id,tpcds_partitioned_parquet_snap.customer_9.c_first_name,tpcds_partitioned_parquet_snap.customer_9.c_last_name,tpcds_partitioned_parquet_snap.customer_9.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_9.c_birth_country,tpcds_partitioned_parquet_snap.customer_9.c_login,tpcds_partitioned_parquet_snap.customer_9.c_email_address,tpcds_partitioned_parquet_snap.date_dim_9.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 73(GETNEXT)
|  |  |
|  |  F47:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  78:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_9.c_customer_id, tpcds_partitioned_parquet_snap.customer_9.c_first_name, tpcds_partitioned_parquet_snap.customer_9.c_last_name, tpcds_partitioned_parquet_snap.customer_9.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_9.c_birth_country, tpcds_partitioned_parquet_snap.customer_9.c_login, tpcds_partitioned_parquet_snap.customer_9.c_email_address, tpcds_partitioned_parquet_snap.date_dim_9.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 73(GETNEXT)
|  |  |
|  |  77:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=76,78,80 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 73(GETNEXT), 76(OPEN)
|  |  |
|  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=09
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=80 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 76(GETNEXT)
|  |  |  |
|  |  |  F49:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  76:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=80 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 76(GETNEXT)
|  |  |
|  |  75:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=76,78 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 73(GETNEXT), 74(OPEN)
|  |  |
|  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=09
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  |  runtime filters: RF042[bloom] <- tpcds_partitioned_parquet_snap.customer_9.c_customer_sk, RF043[min_max] <- tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  175:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=78 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 74(GETNEXT)
|  |  |  |
|  |  |  F48:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=78 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 74(GETNEXT)
|  |  |
|  |  73:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF043[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk, RF042[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=76 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 73(GETNEXT)
|  |
|  174:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_8.c_customer_id, tpcds_partitioned_parquet_snap.customer_8.c_first_name, tpcds_partitioned_parquet_snap.customer_8.c_last_name, tpcds_partitioned_parquet_snap.customer_8.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_8.c_birth_country, tpcds_partitioned_parquet_snap.customer_8.c_login, tpcds_partitioned_parquet_snap.customer_8.c_email_address, tpcds_partitioned_parquet_snap.date_dim_8.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=75 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 174(GETNEXT), 67(OPEN)
|  |
|  173:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_8.c_customer_id,tpcds_partitioned_parquet_snap.customer_8.c_first_name,tpcds_partitioned_parquet_snap.customer_8.c_last_name,tpcds_partitioned_parquet_snap.customer_8.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_8.c_birth_country,tpcds_partitioned_parquet_snap.customer_8.c_login,tpcds_partitioned_parquet_snap.customer_8.c_email_address,tpcds_partitioned_parquet_snap.date_dim_8.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=75 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 67(GETNEXT)
|  |
|  F43:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  72:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_8.c_customer_id, tpcds_partitioned_parquet_snap.customer_8.c_first_name, tpcds_partitioned_parquet_snap.customer_8.c_last_name, tpcds_partitioned_parquet_snap.customer_8.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_8.c_birth_country, tpcds_partitioned_parquet_snap.customer_8.c_login, tpcds_partitioned_parquet_snap.customer_8.c_email_address, tpcds_partitioned_parquet_snap.date_dim_8.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=75 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 67(GETNEXT)
|  |
|  71:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=69,71,73 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 67(GETNEXT), 70(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=08
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  172:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=73 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 70(GETNEXT)
|  |  |
|  |  F45:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  70:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=73 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 70(GETNEXT)
|  |
|  69:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=16
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=69,71 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 67(GETNEXT), 68(OPEN)
|  |
|  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=16 plan-id=17 cohort-id=08
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  |  runtime filters: RF038[bloom] <- tpcds_partitioned_parquet_snap.customer_8.c_customer_sk, RF039[min_max] <- tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  171:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=71 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 68(GETNEXT)
|  |  |
|  |  F44:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  68:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=71 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 68(GETNEXT)
|  |
|  67:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk, RF038[bloom] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=69 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 67(GETNEXT)
|
64:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=21
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68 row-size=348B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 161(OPEN), 165(OPEN), 169(OPEN)
|
|--F107:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  170:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 161(GETNEXT), 165(GETNEXT), 169(GETNEXT)
|  |
|  F42:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 37772016915] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  63:SELECT
|  |  predicates: DYEAR = add(CAST(1999 AS INT), CAST(1 AS INT)), SALE_TYPE = 'c'
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68 row-size=116B cardinality=1.18G cost=23666825216
|  |  in pipelines: 161(GETNEXT), 165(GETNEXT), 169(GETNEXT)
|  |
|  43:UNION
|  |  pass-through-operands: 44
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 161(GETNEXT), 165(GETNEXT), 169(GETNEXT)
|  |
|  |--169:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_7.c_customer_id, tpcds_partitioned_parquet_snap.customer_7.c_first_name, tpcds_partitioned_parquet_snap.customer_7.c_last_name, tpcds_partitioned_parquet_snap.customer_7.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_7.c_birth_country, tpcds_partitioned_parquet_snap.customer_7.c_login, tpcds_partitioned_parquet_snap.customer_7.c_email_address, tpcds_partitioned_parquet_snap.date_dim_7.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=67 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 169(GETNEXT), 57(OPEN)
|  |  |
|  |  168:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_7.c_customer_id,tpcds_partitioned_parquet_snap.customer_7.c_first_name,tpcds_partitioned_parquet_snap.customer_7.c_last_name,tpcds_partitioned_parquet_snap.customer_7.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_7.c_birth_country,tpcds_partitioned_parquet_snap.customer_7.c_login,tpcds_partitioned_parquet_snap.customer_7.c_email_address,tpcds_partitioned_parquet_snap.date_dim_7.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=67 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 57(GETNEXT)
|  |  |
|  |  F38:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  62:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_7.c_customer_id, tpcds_partitioned_parquet_snap.customer_7.c_first_name, tpcds_partitioned_parquet_snap.customer_7.c_last_name, tpcds_partitioned_parquet_snap.customer_7.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_7.c_birth_country, tpcds_partitioned_parquet_snap.customer_7.c_login, tpcds_partitioned_parquet_snap.customer_7.c_email_address, tpcds_partitioned_parquet_snap.date_dim_7.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=67 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 57(GETNEXT)
|  |  |
|  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=26
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=61,63,65 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 57(GETNEXT), 60(OPEN)
|  |  |
|  |  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=26 plan-id=27 cohort-id=13
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  167:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=65 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  F40:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=65 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 60(GETNEXT)
|  |  |
|  |  59:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=27
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=61,63 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 57(GETNEXT), 58(OPEN)
|  |  |
|  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=27 plan-id=28 cohort-id=13
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  |  runtime filters: RF035[min_max] <- tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  166:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=63 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  58:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=63 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 58(GETNEXT)
|  |  |
|  |  57:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF035[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=61 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 57(GETNEXT)
|  |
|  44:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=60 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 161(GETNEXT), 165(GETNEXT)
|  |
|  |--165:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_6.c_customer_id, tpcds_partitioned_parquet_snap.customer_6.c_first_name, tpcds_partitioned_parquet_snap.customer_6.c_last_name, tpcds_partitioned_parquet_snap.customer_6.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_6.c_birth_country, tpcds_partitioned_parquet_snap.customer_6.c_login, tpcds_partitioned_parquet_snap.customer_6.c_email_address, tpcds_partitioned_parquet_snap.date_dim_6.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=59 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 165(GETNEXT), 51(OPEN)
|  |  |
|  |  164:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_6.c_customer_id,tpcds_partitioned_parquet_snap.customer_6.c_first_name,tpcds_partitioned_parquet_snap.customer_6.c_last_name,tpcds_partitioned_parquet_snap.customer_6.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_6.c_birth_country,tpcds_partitioned_parquet_snap.customer_6.c_login,tpcds_partitioned_parquet_snap.customer_6.c_email_address,tpcds_partitioned_parquet_snap.date_dim_6.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=59 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 51(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  56:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_6.c_customer_id, tpcds_partitioned_parquet_snap.customer_6.c_first_name, tpcds_partitioned_parquet_snap.customer_6.c_last_name, tpcds_partitioned_parquet_snap.customer_6.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_6.c_birth_country, tpcds_partitioned_parquet_snap.customer_6.c_login, tpcds_partitioned_parquet_snap.customer_6.c_email_address, tpcds_partitioned_parquet_snap.date_dim_6.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=59 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 51(GETNEXT)
|  |  |
|  |  55:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=24
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=53,55,57 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 51(GETNEXT), 54(OPEN)
|  |  |
|  |  |--F110:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=12
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  163:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=57 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=57 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 54(GETNEXT)
|  |  |
|  |  53:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=53,55 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 51(GETNEXT), 52(OPEN)
|  |  |
|  |  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=12
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  |  runtime filters: RF030[bloom] <- tpcds_partitioned_parquet_snap.customer_6.c_customer_sk, RF031[min_max] <- tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  162:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=55 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 52(GETNEXT)
|  |  |  |
|  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  52:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=55 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 52(GETNEXT)
|  |  |
|  |  51:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk, RF030[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=53 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 51(GETNEXT)
|  |
|  161:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_5.c_customer_id, tpcds_partitioned_parquet_snap.customer_5.c_first_name, tpcds_partitioned_parquet_snap.customer_5.c_last_name, tpcds_partitioned_parquet_snap.customer_5.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_5.c_birth_country, tpcds_partitioned_parquet_snap.customer_5.c_login, tpcds_partitioned_parquet_snap.customer_5.c_email_address, tpcds_partitioned_parquet_snap.date_dim_5.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=52 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 161(GETNEXT), 45(OPEN)
|  |
|  160:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_5.c_customer_id,tpcds_partitioned_parquet_snap.customer_5.c_first_name,tpcds_partitioned_parquet_snap.customer_5.c_last_name,tpcds_partitioned_parquet_snap.customer_5.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_5.c_birth_country,tpcds_partitioned_parquet_snap.customer_5.c_login,tpcds_partitioned_parquet_snap.customer_5.c_email_address,tpcds_partitioned_parquet_snap.date_dim_5.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=52 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 45(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  50:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_5.c_customer_id, tpcds_partitioned_parquet_snap.customer_5.c_first_name, tpcds_partitioned_parquet_snap.customer_5.c_last_name, tpcds_partitioned_parquet_snap.customer_5.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_5.c_birth_country, tpcds_partitioned_parquet_snap.customer_5.c_login, tpcds_partitioned_parquet_snap.customer_5.c_email_address, tpcds_partitioned_parquet_snap.date_dim_5.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=52 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 45(GETNEXT)
|  |
|  49:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=46,48,50 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 45(GETNEXT), 48(OPEN)
|  |
|  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=11
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  159:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=50 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 48(GETNEXT)
|  |  |
|  |  F31:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  48:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=50 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 48(GETNEXT)
|  |
|  47:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=23
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=46,48 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 45(GETNEXT), 46(OPEN)
|  |
|  |--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=23 plan-id=24 cohort-id=11
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  |  runtime filters: RF026[bloom] <- tpcds_partitioned_parquet_snap.customer_5.c_customer_sk, RF027[min_max] <- tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  158:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=48 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 46(GETNEXT)
|  |  |
|  |  F30:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  46:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=48 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 46(GETNEXT)
|  |
|  45:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF027[min_max] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk, RF026[bloom] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=46 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 45(GETNEXT)
|
42:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=28
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45 row-size=232B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 147(OPEN), 151(OPEN), 155(OPEN)
|
|--F114:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=28 plan-id=29 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  157:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 147(GETNEXT), 151(GETNEXT), 155(GETNEXT)
|  |
|  F27:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 49605428499] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  41:SELECT
|  |  predicates: DYEAR = CAST(1999 AS INT), SALE_TYPE = 's', YEAR_TOTAL > CAST(0 AS DECIMAL(3,0))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=116B cardinality=1.18G cost=35500236800
|  |  in pipelines: 147(GETNEXT), 151(GETNEXT), 155(GETNEXT)
|  |
|  21:UNION
|  |  pass-through-operands: 22
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 147(GETNEXT), 151(GETNEXT), 155(GETNEXT)
|  |
|  |--155:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_4.c_customer_id, tpcds_partitioned_parquet_snap.customer_4.c_first_name, tpcds_partitioned_parquet_snap.customer_4.c_last_name, tpcds_partitioned_parquet_snap.customer_4.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_4.c_birth_country, tpcds_partitioned_parquet_snap.customer_4.c_login, tpcds_partitioned_parquet_snap.customer_4.c_email_address, tpcds_partitioned_parquet_snap.date_dim_4.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=44 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 155(GETNEXT), 35(OPEN)
|  |  |
|  |  154:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_4.c_customer_id,tpcds_partitioned_parquet_snap.customer_4.c_first_name,tpcds_partitioned_parquet_snap.customer_4.c_last_name,tpcds_partitioned_parquet_snap.customer_4.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_4.c_birth_country,tpcds_partitioned_parquet_snap.customer_4.c_login,tpcds_partitioned_parquet_snap.customer_4.c_email_address,tpcds_partitioned_parquet_snap.date_dim_4.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=44 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 35(GETNEXT)
|  |  |
|  |  F23:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  40:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_4.c_customer_id, tpcds_partitioned_parquet_snap.customer_4.c_first_name, tpcds_partitioned_parquet_snap.customer_4.c_last_name, tpcds_partitioned_parquet_snap.customer_4.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_4.c_birth_country, tpcds_partitioned_parquet_snap.customer_4.c_login, tpcds_partitioned_parquet_snap.customer_4.c_email_address, tpcds_partitioned_parquet_snap.date_dim_4.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=44 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 35(GETNEXT)
|  |  |
|  |  39:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=33
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=38,40,42 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 35(GETNEXT), 38(OPEN)
|  |  |
|  |  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=16
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  153:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=42 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 38(GETNEXT)
|  |  |  |
|  |  |  F25:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=42 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 38(GETNEXT)
|  |  |
|  |  37:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=34
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=38,40 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |  |
|  |  |--F120:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=16
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  |  runtime filters: RF023[min_max] <- tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  152:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 36(GETNEXT)
|  |  |  |
|  |  |  F24:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=40 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 36(GETNEXT)
|  |  |
|  |  35:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF023[min_max] -> tpcds_partitioned_parquet_snap.web_sales_0.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=38 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 35(GETNEXT)
|  |
|  22:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=37 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 147(GETNEXT), 151(GETNEXT)
|  |
|  |--151:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_3.c_customer_id, tpcds_partitioned_parquet_snap.customer_3.c_first_name, tpcds_partitioned_parquet_snap.customer_3.c_last_name, tpcds_partitioned_parquet_snap.customer_3.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_3.c_birth_country, tpcds_partitioned_parquet_snap.customer_3.c_login, tpcds_partitioned_parquet_snap.customer_3.c_email_address, tpcds_partitioned_parquet_snap.date_dim_3.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=36 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 151(GETNEXT), 29(OPEN)
|  |  |
|  |  150:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_3.c_customer_id,tpcds_partitioned_parquet_snap.customer_3.c_first_name,tpcds_partitioned_parquet_snap.customer_3.c_last_name,tpcds_partitioned_parquet_snap.customer_3.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_3.c_birth_country,tpcds_partitioned_parquet_snap.customer_3.c_login,tpcds_partitioned_parquet_snap.customer_3.c_email_address,tpcds_partitioned_parquet_snap.date_dim_3.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 29(GETNEXT)
|  |  |
|  |  F18:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  34:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_3.c_customer_id, tpcds_partitioned_parquet_snap.customer_3.c_first_name, tpcds_partitioned_parquet_snap.customer_3.c_last_name, tpcds_partitioned_parquet_snap.customer_3.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_3.c_birth_country, tpcds_partitioned_parquet_snap.customer_3.c_login, tpcds_partitioned_parquet_snap.customer_3.c_email_address, tpcds_partitioned_parquet_snap.date_dim_3.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=36 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 29(GETNEXT)
|  |  |
|  |  33:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=31
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=30,32,34 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 29(GETNEXT), 32(OPEN)
|  |  |
|  |  |--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=31 plan-id=32 cohort-id=15
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  149:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=34 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 32(GETNEXT)
|  |  |  |
|  |  |  F20:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  32:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=34 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 32(GETNEXT)
|  |  |
|  |  31:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=32
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=30,32 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 29(GETNEXT), 30(OPEN)
|  |  |
|  |  |--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=32 plan-id=33 cohort-id=15
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  |  runtime filters: RF018[bloom] <- tpcds_partitioned_parquet_snap.customer_3.c_customer_sk, RF019[min_max] <- tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  148:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=32 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 30(GETNEXT)
|  |  |  |
|  |  |  F19:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  30:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=32 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 30(GETNEXT)
|  |  |
|  |  29:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF019[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk, RF018[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=30 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 29(GETNEXT)
|  |
|  147:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_2.c_customer_id, tpcds_partitioned_parquet_snap.customer_2.c_first_name, tpcds_partitioned_parquet_snap.customer_2.c_last_name, tpcds_partitioned_parquet_snap.customer_2.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_2.c_birth_country, tpcds_partitioned_parquet_snap.customer_2.c_login, tpcds_partitioned_parquet_snap.customer_2.c_email_address, tpcds_partitioned_parquet_snap.date_dim_2.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=29 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 147(GETNEXT), 23(OPEN)
|  |
|  146:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_2.c_customer_id,tpcds_partitioned_parquet_snap.customer_2.c_first_name,tpcds_partitioned_parquet_snap.customer_2.c_last_name,tpcds_partitioned_parquet_snap.customer_2.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_2.c_birth_country,tpcds_partitioned_parquet_snap.customer_2.c_login,tpcds_partitioned_parquet_snap.customer_2.c_email_address,tpcds_partitioned_parquet_snap.date_dim_2.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=29 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 23(GETNEXT)
|  |
|  F14:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  28:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_2.c_customer_id, tpcds_partitioned_parquet_snap.customer_2.c_first_name, tpcds_partitioned_parquet_snap.customer_2.c_last_name, tpcds_partitioned_parquet_snap.customer_2.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_2.c_birth_country, tpcds_partitioned_parquet_snap.customer_2.c_login, tpcds_partitioned_parquet_snap.customer_2.c_email_address, tpcds_partitioned_parquet_snap.date_dim_2.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=29 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 23(GETNEXT)
|  |
|  27:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=29
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=23,25,27 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 23(GETNEXT), 26(OPEN)
|  |
|  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=29 plan-id=30 cohort-id=14
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  145:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=27 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 26(GETNEXT)
|  |  |
|  |  F16:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  26:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=27 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 26(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=30
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=23,25 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |
|  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=30 plan-id=31 cohort-id=14
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  |  runtime filters: RF014[bloom] <- tpcds_partitioned_parquet_snap.customer_2.c_customer_sk, RF015[min_max] <- tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  144:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=25 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 24(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  24:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=25 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF015[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk, RF014[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=23 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 23(GETNEXT)
|
156:EXCHANGE [HASH(CUSTOMER_ID)]
|  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=116B cardinality=1.18G cost=762900139
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT)
|
F13:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 37772016915] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
20:SELECT
|  predicates: DYEAR = add(CAST(1999 AS INT), CAST(1 AS INT)), SALE_TYPE = 's'
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=116B cardinality=1.18G cost=23666825216
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=116B cardinality=11.83G cost=782000635
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT)
|
|--143:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales.ws_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_1.c_customer_id, tpcds_partitioned_parquet_snap.customer_1.c_first_name, tpcds_partitioned_parquet_snap.customer_1.c_last_name, tpcds_partitioned_parquet_snap.customer_1.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_1.c_birth_country, tpcds_partitioned_parquet_snap.customer_1.c_login, tpcds_partitioned_parquet_snap.customer_1.c_email_address, tpcds_partitioned_parquet_snap.date_dim_1.d_year
|  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=21 row-size=169B cardinality=1.99G cost=11732593545
|  |  in pipelines: 143(GETNEXT), 14(OPEN)
|  |
|  142:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_1.c_customer_id,tpcds_partitioned_parquet_snap.customer_1.c_first_name,tpcds_partitioned_parquet_snap.customer_1.c_last_name,tpcds_partitioned_parquet_snap.customer_1.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_1.c_birth_country,tpcds_partitioned_parquet_snap.customer_1.c_login,tpcds_partitioned_parquet_snap.customer_1.c_email_address,tpcds_partitioned_parquet_snap.date_dim_1.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=21 row-size=169B cardinality=1.99G cost=1767409028
|  |  in pipelines: 14(GETNEXT)
|  |
|  F09:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  19:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_1.c_customer_id, tpcds_partitioned_parquet_snap.customer_1.c_first_name, tpcds_partitioned_parquet_snap.customer_1.c_last_name, tpcds_partitioned_parquet_snap.customer_1.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_1.c_birth_country, tpcds_partitioned_parquet_snap.customer_1.c_login, tpcds_partitioned_parquet_snap.customer_1.c_email_address, tpcds_partitioned_parquet_snap.date_dim_1.d_year
|  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=21 row-size=169B cardinality=1.99G cost=11732593545
|  |  in pipelines: 14(GETNEXT)
|  |
|  18:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=39
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=15,17,19 row-size=582B cardinality=1.99G cost=870015958
|  |  in pipelines: 14(GETNEXT), 17(OPEN)
|  |
|  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=39 plan-id=40 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  141:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=19 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 17(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=19 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 17(GETNEXT)
|  |
|  16:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=40
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=15,17 row-size=344B cardinality=1.99G cost=870015958
|  |  in pipelines: 14(GETNEXT), 15(OPEN)
|  |
|  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=40 plan-id=41 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  |  runtime filters: RF011[min_max] <- tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  140:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=17 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 15(GETNEXT)
|  |  |
|  |  F10:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  15:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=17 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 15(GETNEXT)
|  |
|  14:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF011[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|     tuple-ids=15 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|     in pipelines: 14(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=14 row-size=116B cardinality=9.85G cost=3873500731
|  in pipelines: 135(GETNEXT), 139(GETNEXT)
|
|--139:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_0.c_customer_id, tpcds_partitioned_parquet_snap.customer_0.c_first_name, tpcds_partitioned_parquet_snap.customer_0.c_last_name, tpcds_partitioned_parquet_snap.customer_0.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_0.c_birth_country, tpcds_partitioned_parquet_snap.customer_0.c_login, tpcds_partitioned_parquet_snap.customer_0.c_email_address, tpcds_partitioned_parquet_snap.date_dim_0.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=13 row-size=169B cardinality=3.97G cost=23408022405
|  |  in pipelines: 139(GETNEXT), 08(OPEN)
|  |
|  138:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_0.c_customer_id,tpcds_partitioned_parquet_snap.customer_0.c_first_name,tpcds_partitioned_parquet_snap.customer_0.c_last_name,tpcds_partitioned_parquet_snap.customer_0.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_0.c_birth_country,tpcds_partitioned_parquet_snap.customer_0.c_login,tpcds_partitioned_parquet_snap.customer_0.c_email_address,tpcds_partitioned_parquet_snap.date_dim_0.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=13 row-size=169B cardinality=3.97G cost=3526206713
|  |  in pipelines: 08(GETNEXT)
|  |
|  F04:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  13:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_0.c_customer_id, tpcds_partitioned_parquet_snap.customer_0.c_first_name, tpcds_partitioned_parquet_snap.customer_0.c_last_name, tpcds_partitioned_parquet_snap.customer_0.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_0.c_birth_country, tpcds_partitioned_parquet_snap.customer_0.c_login, tpcds_partitioned_parquet_snap.customer_0.c_email_address, tpcds_partitioned_parquet_snap.date_dim_0.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=13 row-size=169B cardinality=3.97G cost=23408022405
|  |  in pipelines: 08(GETNEXT)
|  |
|  12:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=37
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=7,9,11 row-size=582B cardinality=3.97G cost=1735792939
|  |  in pipelines: 08(GETNEXT), 11(OPEN)
|  |
|  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=37 plan-id=38 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  137:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=11 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=11 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 11(GETNEXT)
|  |
|  10:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=38
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=7,9 row-size=344B cardinality=3.97G cost=1735792939
|  |  in pipelines: 08(GETNEXT), 09(OPEN)
|  |
|  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=38 plan-id=39 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.customer_0.c_customer_sk, RF007[min_max] <- tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  136:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=9 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 09(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  09:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=9 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 09(GETNEXT)
|  |
|  08:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF007[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=7 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|     in pipelines: 08(GETNEXT)
|
135:AGGREGATE [FINALIZE]
|  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales.ss_ext_sales_price), 2))
|  group by: tpcds_partitioned_parquet_snap.customer.c_customer_id, tpcds_partitioned_parquet_snap.customer.c_first_name, tpcds_partitioned_parquet_snap.customer.c_last_name, tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer.c_birth_country, tpcds_partitioned_parquet_snap.customer.c_login, tpcds_partitioned_parquet_snap.customer.c_email_address, tpcds_partitioned_parquet_snap.date_dim.d_year
|  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=6 row-size=169B cardinality=5.88G cost=37464857383
|  in pipelines: 135(GETNEXT), 02(OPEN)
|
134:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_customer_id,tpcds_partitioned_parquet_snap.customer.c_first_name,tpcds_partitioned_parquet_snap.customer.c_last_name,tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer.c_birth_country,tpcds_partitioned_parquet_snap.customer.c_login,tpcds_partitioned_parquet_snap.customer.c_email_address,tpcds_partitioned_parquet_snap.date_dim.d_year)]
|  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  tuple-ids=6 row-size=169B cardinality=7.89G cost=7012748222
|  in pipelines: 02(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
07:AGGREGATE [STREAMING]
|  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  group by: tpcds_partitioned_parquet_snap.customer.c_customer_id, tpcds_partitioned_parquet_snap.customer.c_first_name, tpcds_partitioned_parquet_snap.customer.c_last_name, tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer.c_birth_country, tpcds_partitioned_parquet_snap.customer.c_login, tpcds_partitioned_parquet_snap.customer.c_email_address, tpcds_partitioned_parquet_snap.date_dim.d_year
|  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=6 row-size=169B cardinality=7.89G cost=46613754103
|  in pipelines: 02(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=35
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=538B cardinality=7.93G cost=3471497176
|  in pipelines: 02(GETNEXT), 05(OPEN)
|
|--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[170129]
|  JOIN BUILD
|  |  join-table-id=35 plan-id=36 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |
|  133:EXCHANGE [BROADCAST]
|  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=237B cardinality=73.05K cost=97080
|  |  in pipelines: 05(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[158950]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=4 row-size=237B cardinality=73.05K cost=110600
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=36
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2 row-size=300B cardinality=7.93G cost=3471497176
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  max-parallelism=10 segment-costs=[69869990]
|  JOIN BUILD
|  |  join-table-id=36 plan-id=37 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk, RF003[min_max] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |
|  132:EXCHANGE [BROADCAST]
|  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=204B cardinality=30.00M cost=39869990
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[64027278]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.55GB
|     stored statistics:
|       table: rows=30.00M size=1.55GB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.10M
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=2 row-size=204B cardinality=30.00M cost=46823813
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
   in pipelines: 02(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=26.29GB Threads=409
Per-Host Resource Estimates: Memory=1.25TB
F85:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.40MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[434] cpu-comparison-result=2160 [max(1 (self) vs 2160 (sum children))]
PLAN-ROOT SINK
|  output exprs: CUSTOMER_ID, CUSTOMER_FIRST_NAME, CUSTOMER_LAST_NAME, CUSTOMER_BIRTH_COUNTRY
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=400
|
210:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CUSTOMER_ID ASC NULLS LAST, CUSTOMER_FIRST_NAME ASC NULLS LAST, CUSTOMER_LAST_NAME ASC NULLS LAST, CUSTOMER_BIRTH_COUNTRY ASC NULLS LAST
|  limit: 100
|  mem-estimate=406.72KB mem-reservation=0B thread-reservation=0
|  tuple-ids=138 row-size=48B cardinality=100 cost=34
|  in pipelines: 131(GETNEXT)
|
F28:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
Per-Instance Resources: mem-estimate=24.07MB mem-reservation=0B thread-reservation=1
max-parallelism=2350 segment-costs=[23461227104, 157] cpu-comparison-result=2160 [max(80 (self) vs 2160 (sum children))]
131:TOP-N [LIMIT=100]
|  order by: CUSTOMER_ID ASC NULLS LAST, CUSTOMER_FIRST_NAME ASC NULLS LAST, CUSTOMER_LAST_NAME ASC NULLS LAST, CUSTOMER_BIRTH_COUNTRY ASC NULLS LAST
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=138 row-size=48B cardinality=100 cost=20108584520
|  in pipelines: 131(GETNEXT), 135(OPEN), 139(OPEN), 143(OPEN)
|
130:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=00
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  other join predicates: CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END > CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68,91,114,137 row-size=696B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 200(OPEN), 204(OPEN), 208(OPEN)
|
|--F86:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  209:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 200(GETNEXT), 204(GETNEXT), 208(GETNEXT)
|  |
|  F84:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 49605428499] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  129:SELECT
|  |  predicates: DYEAR = CAST(1999 AS INT), SALE_TYPE = 'w', YEAR_TOTAL > CAST(0 AS DECIMAL(3,0))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=116B cardinality=1.18G cost=35500236800
|  |  in pipelines: 200(GETNEXT), 204(GETNEXT), 208(GETNEXT)
|  |
|  109:UNION
|  |  pass-through-operands: 110
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=137 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 200(GETNEXT), 204(GETNEXT), 208(GETNEXT)
|  |
|  |--208:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_16.c_customer_id, tpcds_partitioned_parquet_snap.customer_16.c_first_name, tpcds_partitioned_parquet_snap.customer_16.c_last_name, tpcds_partitioned_parquet_snap.customer_16.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_16.c_birth_country, tpcds_partitioned_parquet_snap.customer_16.c_login, tpcds_partitioned_parquet_snap.customer_16.c_email_address, tpcds_partitioned_parquet_snap.date_dim_16.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=136 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 208(GETNEXT), 123(OPEN)
|  |  |
|  |  207:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_16.c_customer_id,tpcds_partitioned_parquet_snap.customer_16.c_first_name,tpcds_partitioned_parquet_snap.customer_16.c_last_name,tpcds_partitioned_parquet_snap.customer_16.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_16.c_birth_country,tpcds_partitioned_parquet_snap.customer_16.c_login,tpcds_partitioned_parquet_snap.customer_16.c_email_address,tpcds_partitioned_parquet_snap.date_dim_16.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=136 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 123(GETNEXT)
|  |  |
|  |  F80:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  128:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_4.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_16.c_customer_id, tpcds_partitioned_parquet_snap.customer_16.c_first_name, tpcds_partitioned_parquet_snap.customer_16.c_last_name, tpcds_partitioned_parquet_snap.customer_16.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_16.c_birth_country, tpcds_partitioned_parquet_snap.customer_16.c_login, tpcds_partitioned_parquet_snap.customer_16.c_email_address, tpcds_partitioned_parquet_snap.date_dim_16.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=136 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 123(GETNEXT)
|  |  |
|  |  127:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130,132,134 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 123(GETNEXT), 126(OPEN)
|  |  |
|  |  |--F91:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_16.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  206:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=134 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 126(GETNEXT)
|  |  |  |
|  |  |  F82:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  126:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=134 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 126(GETNEXT)
|  |  |
|  |  125:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=06
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_4.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_4.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=130,132 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 123(GETNEXT), 124(OPEN)
|  |  |
|  |  |--F92:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=06 plan-id=07 cohort-id=04
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  |  runtime filters: RF071[min_max] <- tpcds_partitioned_parquet_snap.customer_16.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  205:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=132 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 124(GETNEXT)
|  |  |  |
|  |  |  F81:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  124:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=132 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 124(GETNEXT)
|  |  |
|  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF071[min_max] -> tpcds_partitioned_parquet_snap.web_sales_4.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=130 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 123(GETNEXT)
|  |
|  110:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=129 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 200(GETNEXT), 204(GETNEXT)
|  |
|  |--204:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_15.c_customer_id, tpcds_partitioned_parquet_snap.customer_15.c_first_name, tpcds_partitioned_parquet_snap.customer_15.c_last_name, tpcds_partitioned_parquet_snap.customer_15.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_15.c_birth_country, tpcds_partitioned_parquet_snap.customer_15.c_login, tpcds_partitioned_parquet_snap.customer_15.c_email_address, tpcds_partitioned_parquet_snap.date_dim_15.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=128 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 204(GETNEXT), 117(OPEN)
|  |  |
|  |  203:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_15.c_customer_id,tpcds_partitioned_parquet_snap.customer_15.c_first_name,tpcds_partitioned_parquet_snap.customer_15.c_last_name,tpcds_partitioned_parquet_snap.customer_15.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_15.c_birth_country,tpcds_partitioned_parquet_snap.customer_15.c_login,tpcds_partitioned_parquet_snap.customer_15.c_email_address,tpcds_partitioned_parquet_snap.date_dim_15.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=128 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 117(GETNEXT)
|  |  |
|  |  F75:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  122:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_4.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_15.c_customer_id, tpcds_partitioned_parquet_snap.customer_15.c_first_name, tpcds_partitioned_parquet_snap.customer_15.c_last_name, tpcds_partitioned_parquet_snap.customer_15.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_15.c_birth_country, tpcds_partitioned_parquet_snap.customer_15.c_login, tpcds_partitioned_parquet_snap.customer_15.c_email_address, tpcds_partitioned_parquet_snap.date_dim_15.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=128 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 117(GETNEXT)
|  |  |
|  |  121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=122,124,126 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 117(GETNEXT), 120(OPEN)
|  |  |
|  |  |--F89:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_15.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  202:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=126 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  F77:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  120:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=126 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 120(GETNEXT)
|  |  |
|  |  119:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=04
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_4.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=122,124 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 117(GETNEXT), 118(OPEN)
|  |  |
|  |  |--F90:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=04 plan-id=05 cohort-id=03
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  |  runtime filters: RF067[min_max] <- tpcds_partitioned_parquet_snap.customer_15.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  201:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=124 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 118(GETNEXT)
|  |  |  |
|  |  |  F76:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  118:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=124 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 118(GETNEXT)
|  |  |
|  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF067[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_4.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=122 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 117(GETNEXT)
|  |
|  200:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_14.c_customer_id, tpcds_partitioned_parquet_snap.customer_14.c_first_name, tpcds_partitioned_parquet_snap.customer_14.c_last_name, tpcds_partitioned_parquet_snap.customer_14.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_14.c_birth_country, tpcds_partitioned_parquet_snap.customer_14.c_login, tpcds_partitioned_parquet_snap.customer_14.c_email_address, tpcds_partitioned_parquet_snap.date_dim_14.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=121 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 200(GETNEXT), 111(OPEN)
|  |
|  199:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_14.c_customer_id,tpcds_partitioned_parquet_snap.customer_14.c_first_name,tpcds_partitioned_parquet_snap.customer_14.c_last_name,tpcds_partitioned_parquet_snap.customer_14.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_14.c_birth_country,tpcds_partitioned_parquet_snap.customer_14.c_login,tpcds_partitioned_parquet_snap.customer_14.c_email_address,tpcds_partitioned_parquet_snap.date_dim_14.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=121 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 111(GETNEXT)
|  |
|  F71:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  116:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_4.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_14.c_customer_id, tpcds_partitioned_parquet_snap.customer_14.c_first_name, tpcds_partitioned_parquet_snap.customer_14.c_last_name, tpcds_partitioned_parquet_snap.customer_14.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_14.c_birth_country, tpcds_partitioned_parquet_snap.customer_14.c_login, tpcds_partitioned_parquet_snap.customer_14.c_email_address, tpcds_partitioned_parquet_snap.date_dim_14.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=121 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 111(GETNEXT)
|  |
|  115:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=115,117,119 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 111(GETNEXT), 114(OPEN)
|  |
|  |--F87:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_14.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  198:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=119 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 114(GETNEXT)
|  |  |
|  |  F73:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  114:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=119 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 114(GETNEXT)
|  |
|  113:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=02
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=115,117 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 111(GETNEXT), 112(OPEN)
|  |
|  |--F88:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  |  runtime filters: RF062[bloom] <- tpcds_partitioned_parquet_snap.customer_14.c_customer_sk, RF063[min_max] <- tpcds_partitioned_parquet_snap.customer_14.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  197:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=117 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 112(GETNEXT)
|  |  |
|  |  F72:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  112:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=117 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 112(GETNEXT)
|  |
|  111:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF063[min_max] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk, RF062[bloom] -> tpcds_partitioned_parquet_snap.store_sales_4.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=115 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 111(GETNEXT)
|
108:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=07
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68,91,114 row-size=580B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 187(OPEN), 191(OPEN), 195(OPEN)
|
|--F93:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=07 plan-id=08 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  196:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=114 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 187(GETNEXT), 191(GETNEXT), 195(GETNEXT)
|  |
|  F70:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 37772016915] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  107:SELECT
|  |  predicates: DYEAR = add(CAST(1999 AS INT), CAST(1 AS INT)), SALE_TYPE = 'w'
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=114 row-size=116B cardinality=1.18G cost=23666825216
|  |  in pipelines: 187(GETNEXT), 191(GETNEXT), 195(GETNEXT)
|  |
|  87:UNION
|  |  pass-through-operands: 88
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=114 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 187(GETNEXT), 191(GETNEXT), 195(GETNEXT)
|  |
|  |--195:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_13.c_customer_id, tpcds_partitioned_parquet_snap.customer_13.c_first_name, tpcds_partitioned_parquet_snap.customer_13.c_last_name, tpcds_partitioned_parquet_snap.customer_13.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_13.c_birth_country, tpcds_partitioned_parquet_snap.customer_13.c_login, tpcds_partitioned_parquet_snap.customer_13.c_email_address, tpcds_partitioned_parquet_snap.date_dim_13.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=113 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 195(GETNEXT), 101(OPEN)
|  |  |
|  |  194:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_13.c_customer_id,tpcds_partitioned_parquet_snap.customer_13.c_first_name,tpcds_partitioned_parquet_snap.customer_13.c_last_name,tpcds_partitioned_parquet_snap.customer_13.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_13.c_birth_country,tpcds_partitioned_parquet_snap.customer_13.c_login,tpcds_partitioned_parquet_snap.customer_13.c_email_address,tpcds_partitioned_parquet_snap.date_dim_13.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=113 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 101(GETNEXT)
|  |  |
|  |  F66:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  106:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_3.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_13.c_customer_id, tpcds_partitioned_parquet_snap.customer_13.c_first_name, tpcds_partitioned_parquet_snap.customer_13.c_last_name, tpcds_partitioned_parquet_snap.customer_13.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_13.c_birth_country, tpcds_partitioned_parquet_snap.customer_13.c_login, tpcds_partitioned_parquet_snap.customer_13.c_email_address, tpcds_partitioned_parquet_snap.date_dim_13.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=113 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 101(GETNEXT)
|  |  |
|  |  105:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=12
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=107,109,111 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 101(GETNEXT), 104(OPEN)
|  |  |
|  |  |--F98:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=12 plan-id=13 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_13.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  193:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=111 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 104(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  104:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=111 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 104(GETNEXT)
|  |  |
|  |  103:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=13
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_3.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_3.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=107,109 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 101(GETNEXT), 102(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=13 plan-id=14 cohort-id=07
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  |  runtime filters: RF059[min_max] <- tpcds_partitioned_parquet_snap.customer_13.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  192:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=109 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  102:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=109 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 102(GETNEXT)
|  |  |
|  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF059[min_max] -> tpcds_partitioned_parquet_snap.web_sales_3.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=107 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 101(GETNEXT)
|  |
|  88:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=106 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 187(GETNEXT), 191(GETNEXT)
|  |
|  |--191:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_12.c_customer_id, tpcds_partitioned_parquet_snap.customer_12.c_first_name, tpcds_partitioned_parquet_snap.customer_12.c_last_name, tpcds_partitioned_parquet_snap.customer_12.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_12.c_birth_country, tpcds_partitioned_parquet_snap.customer_12.c_login, tpcds_partitioned_parquet_snap.customer_12.c_email_address, tpcds_partitioned_parquet_snap.date_dim_12.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=105 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 191(GETNEXT), 95(OPEN)
|  |  |
|  |  190:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_12.c_customer_id,tpcds_partitioned_parquet_snap.customer_12.c_first_name,tpcds_partitioned_parquet_snap.customer_12.c_last_name,tpcds_partitioned_parquet_snap.customer_12.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_12.c_birth_country,tpcds_partitioned_parquet_snap.customer_12.c_login,tpcds_partitioned_parquet_snap.customer_12.c_email_address,tpcds_partitioned_parquet_snap.date_dim_12.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=105 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 95(GETNEXT)
|  |  |
|  |  F61:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  100:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_3.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_12.c_customer_id, tpcds_partitioned_parquet_snap.customer_12.c_first_name, tpcds_partitioned_parquet_snap.customer_12.c_last_name, tpcds_partitioned_parquet_snap.customer_12.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_12.c_birth_country, tpcds_partitioned_parquet_snap.customer_12.c_login, tpcds_partitioned_parquet_snap.customer_12.c_email_address, tpcds_partitioned_parquet_snap.date_dim_12.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=105 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 95(GETNEXT)
|  |  |
|  |  99:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=10
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99,101,103 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 95(GETNEXT), 98(OPEN)
|  |  |
|  |  |--F96:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=10 plan-id=11 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_12.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  189:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=103 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 98(GETNEXT)
|  |  |  |
|  |  |  F63:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  98:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=103 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 98(GETNEXT)
|  |  |
|  |  97:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=11
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_3.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99,101 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 95(GETNEXT), 96(OPEN)
|  |  |
|  |  |--F97:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=11 plan-id=12 cohort-id=06
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  |  runtime filters: RF055[min_max] <- tpcds_partitioned_parquet_snap.customer_12.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  188:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=101 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 96(GETNEXT)
|  |  |  |
|  |  |  F62:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  96:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=101 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 96(GETNEXT)
|  |  |
|  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF055[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_3.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=99 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 95(GETNEXT)
|  |
|  187:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_11.c_customer_id, tpcds_partitioned_parquet_snap.customer_11.c_first_name, tpcds_partitioned_parquet_snap.customer_11.c_last_name, tpcds_partitioned_parquet_snap.customer_11.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_11.c_birth_country, tpcds_partitioned_parquet_snap.customer_11.c_login, tpcds_partitioned_parquet_snap.customer_11.c_email_address, tpcds_partitioned_parquet_snap.date_dim_11.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=98 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 187(GETNEXT), 89(OPEN)
|  |
|  186:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_11.c_customer_id,tpcds_partitioned_parquet_snap.customer_11.c_first_name,tpcds_partitioned_parquet_snap.customer_11.c_last_name,tpcds_partitioned_parquet_snap.customer_11.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_11.c_birth_country,tpcds_partitioned_parquet_snap.customer_11.c_login,tpcds_partitioned_parquet_snap.customer_11.c_email_address,tpcds_partitioned_parquet_snap.date_dim_11.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=98 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 89(GETNEXT)
|  |
|  F57:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  94:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_3.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_11.c_customer_id, tpcds_partitioned_parquet_snap.customer_11.c_first_name, tpcds_partitioned_parquet_snap.customer_11.c_last_name, tpcds_partitioned_parquet_snap.customer_11.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_11.c_birth_country, tpcds_partitioned_parquet_snap.customer_11.c_login, tpcds_partitioned_parquet_snap.customer_11.c_email_address, tpcds_partitioned_parquet_snap.date_dim_11.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=98 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 89(GETNEXT)
|  |
|  93:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=08
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=92,94,96 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 89(GETNEXT), 92(OPEN)
|  |
|  |--F94:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_11.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  185:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 92(GETNEXT)
|  |  |
|  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  92:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=96 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 92(GETNEXT)
|  |
|  91:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=09
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=92,94 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |
|  |--F95:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=09 plan-id=10 cohort-id=05
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  |  runtime filters: RF050[bloom] <- tpcds_partitioned_parquet_snap.customer_11.c_customer_sk, RF051[min_max] <- tpcds_partitioned_parquet_snap.customer_11.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  184:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=94 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 90(GETNEXT)
|  |  |
|  |  F58:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  90:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=94 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 90(GETNEXT)
|  |
|  89:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF051[min_max] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk, RF050[bloom] -> tpcds_partitioned_parquet_snap.store_sales_3.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=92 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 89(GETNEXT)
|
86:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=14
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  other join predicates: CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END > CASE WHEN YEAR_TOTAL > CAST(0 AS DECIMAL(3,0)) THEN divide(YEAR_TOTAL, YEAR_TOTAL) ELSE NULL END
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68,91 row-size=464B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 174(OPEN), 178(OPEN), 182(OPEN)
|
|--F100:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=14 plan-id=15 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  183:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=91 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 174(GETNEXT), 178(GETNEXT), 182(GETNEXT)
|  |
|  F56:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 49605428499] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  85:SELECT
|  |  predicates: DYEAR = CAST(1999 AS INT), SALE_TYPE = 'c', YEAR_TOTAL > CAST(0 AS DECIMAL(3,0))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=91 row-size=116B cardinality=1.18G cost=35500236800
|  |  in pipelines: 174(GETNEXT), 178(GETNEXT), 182(GETNEXT)
|  |
|  65:UNION
|  |  pass-through-operands: 66
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=91 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 174(GETNEXT), 178(GETNEXT), 182(GETNEXT)
|  |
|  |--182:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_10.c_customer_id, tpcds_partitioned_parquet_snap.customer_10.c_first_name, tpcds_partitioned_parquet_snap.customer_10.c_last_name, tpcds_partitioned_parquet_snap.customer_10.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_10.c_birth_country, tpcds_partitioned_parquet_snap.customer_10.c_login, tpcds_partitioned_parquet_snap.customer_10.c_email_address, tpcds_partitioned_parquet_snap.date_dim_10.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=90 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 182(GETNEXT), 79(OPEN)
|  |  |
|  |  181:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_10.c_customer_id,tpcds_partitioned_parquet_snap.customer_10.c_first_name,tpcds_partitioned_parquet_snap.customer_10.c_last_name,tpcds_partitioned_parquet_snap.customer_10.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_10.c_birth_country,tpcds_partitioned_parquet_snap.customer_10.c_login,tpcds_partitioned_parquet_snap.customer_10.c_email_address,tpcds_partitioned_parquet_snap.date_dim_10.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=90 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 79(GETNEXT)
|  |  |
|  |  F52:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  84:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_2.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_10.c_customer_id, tpcds_partitioned_parquet_snap.customer_10.c_first_name, tpcds_partitioned_parquet_snap.customer_10.c_last_name, tpcds_partitioned_parquet_snap.customer_10.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_10.c_birth_country, tpcds_partitioned_parquet_snap.customer_10.c_login, tpcds_partitioned_parquet_snap.customer_10.c_email_address, tpcds_partitioned_parquet_snap.date_dim_10.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=90 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 79(GETNEXT)
|  |  |
|  |  83:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=19
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=84,86,88 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 79(GETNEXT), 82(OPEN)
|  |  |
|  |  |--F105:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=19 plan-id=20 cohort-id=10
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_10.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=88 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 82(GETNEXT)
|  |  |  |
|  |  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  82:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=88 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 82(GETNEXT)
|  |  |
|  |  81:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=20
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_2.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_2.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=84,86 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 79(GETNEXT), 80(OPEN)
|  |  |
|  |  |--F106:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=20 plan-id=21 cohort-id=10
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  |  runtime filters: RF047[min_max] <- tpcds_partitioned_parquet_snap.customer_10.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  179:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=86 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 80(GETNEXT)
|  |  |  |
|  |  |  F53:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=86 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  79:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF047[min_max] -> tpcds_partitioned_parquet_snap.web_sales_2.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=84 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 79(GETNEXT)
|  |
|  66:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=83 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 174(GETNEXT), 178(GETNEXT)
|  |
|  |--178:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_9.c_customer_id, tpcds_partitioned_parquet_snap.customer_9.c_first_name, tpcds_partitioned_parquet_snap.customer_9.c_last_name, tpcds_partitioned_parquet_snap.customer_9.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_9.c_birth_country, tpcds_partitioned_parquet_snap.customer_9.c_login, tpcds_partitioned_parquet_snap.customer_9.c_email_address, tpcds_partitioned_parquet_snap.date_dim_9.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 178(GETNEXT), 73(OPEN)
|  |  |
|  |  177:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_9.c_customer_id,tpcds_partitioned_parquet_snap.customer_9.c_first_name,tpcds_partitioned_parquet_snap.customer_9.c_last_name,tpcds_partitioned_parquet_snap.customer_9.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_9.c_birth_country,tpcds_partitioned_parquet_snap.customer_9.c_login,tpcds_partitioned_parquet_snap.customer_9.c_email_address,tpcds_partitioned_parquet_snap.date_dim_9.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=82 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 73(GETNEXT)
|  |  |
|  |  F47:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  78:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_2.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_9.c_customer_id, tpcds_partitioned_parquet_snap.customer_9.c_first_name, tpcds_partitioned_parquet_snap.customer_9.c_last_name, tpcds_partitioned_parquet_snap.customer_9.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_9.c_birth_country, tpcds_partitioned_parquet_snap.customer_9.c_login, tpcds_partitioned_parquet_snap.customer_9.c_email_address, tpcds_partitioned_parquet_snap.date_dim_9.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=82 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 73(GETNEXT)
|  |  |
|  |  77:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=17
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=76,78,80 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 73(GETNEXT), 76(OPEN)
|  |  |
|  |  |--F103:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=17 plan-id=18 cohort-id=09
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_9.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  176:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=80 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 76(GETNEXT)
|  |  |  |
|  |  |  F49:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  76:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=80 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 76(GETNEXT)
|  |  |
|  |  75:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=76,78 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 73(GETNEXT), 74(OPEN)
|  |  |
|  |  |--F104:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=09
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  |  runtime filters: RF042[bloom] <- tpcds_partitioned_parquet_snap.customer_9.c_customer_sk, RF043[min_max] <- tpcds_partitioned_parquet_snap.customer_9.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  175:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=78 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 74(GETNEXT)
|  |  |  |
|  |  |  F48:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=78 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 74(GETNEXT)
|  |  |
|  |  73:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF043[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk, RF042[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_2.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=76 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 73(GETNEXT)
|  |
|  174:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_8.c_customer_id, tpcds_partitioned_parquet_snap.customer_8.c_first_name, tpcds_partitioned_parquet_snap.customer_8.c_last_name, tpcds_partitioned_parquet_snap.customer_8.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_8.c_birth_country, tpcds_partitioned_parquet_snap.customer_8.c_login, tpcds_partitioned_parquet_snap.customer_8.c_email_address, tpcds_partitioned_parquet_snap.date_dim_8.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=75 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 174(GETNEXT), 67(OPEN)
|  |
|  173:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_8.c_customer_id,tpcds_partitioned_parquet_snap.customer_8.c_first_name,tpcds_partitioned_parquet_snap.customer_8.c_last_name,tpcds_partitioned_parquet_snap.customer_8.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_8.c_birth_country,tpcds_partitioned_parquet_snap.customer_8.c_login,tpcds_partitioned_parquet_snap.customer_8.c_email_address,tpcds_partitioned_parquet_snap.date_dim_8.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=75 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 67(GETNEXT)
|  |
|  F43:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  72:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_2.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_8.c_customer_id, tpcds_partitioned_parquet_snap.customer_8.c_first_name, tpcds_partitioned_parquet_snap.customer_8.c_last_name, tpcds_partitioned_parquet_snap.customer_8.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_8.c_birth_country, tpcds_partitioned_parquet_snap.customer_8.c_login, tpcds_partitioned_parquet_snap.customer_8.c_email_address, tpcds_partitioned_parquet_snap.date_dim_8.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=75 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 67(GETNEXT)
|  |
|  71:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=15
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=69,71,73 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 67(GETNEXT), 70(OPEN)
|  |
|  |--F101:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=15 plan-id=16 cohort-id=08
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_8.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  172:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=73 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 70(GETNEXT)
|  |  |
|  |  F45:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  70:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=73 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 70(GETNEXT)
|  |
|  69:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=16
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=69,71 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 67(GETNEXT), 68(OPEN)
|  |
|  |--F102:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=16 plan-id=17 cohort-id=08
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  |  runtime filters: RF038[bloom] <- tpcds_partitioned_parquet_snap.customer_8.c_customer_sk, RF039[min_max] <- tpcds_partitioned_parquet_snap.customer_8.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  171:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=71 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 68(GETNEXT)
|  |  |
|  |  F44:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  68:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=71 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 68(GETNEXT)
|  |
|  67:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF039[min_max] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk, RF038[bloom] -> tpcds_partitioned_parquet_snap.store_sales_2.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=69 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 67(GETNEXT)
|
64:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=21
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45,68 row-size=348B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 161(OPEN), 165(OPEN), 169(OPEN)
|
|--F107:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=21 plan-id=22 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  170:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 161(GETNEXT), 165(GETNEXT), 169(GETNEXT)
|  |
|  F42:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 37772016915] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  63:SELECT
|  |  predicates: DYEAR = add(CAST(1999 AS INT), CAST(1 AS INT)), SALE_TYPE = 'c'
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68 row-size=116B cardinality=1.18G cost=23666825216
|  |  in pipelines: 161(GETNEXT), 165(GETNEXT), 169(GETNEXT)
|  |
|  43:UNION
|  |  pass-through-operands: 44
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 161(GETNEXT), 165(GETNEXT), 169(GETNEXT)
|  |
|  |--169:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_7.c_customer_id, tpcds_partitioned_parquet_snap.customer_7.c_first_name, tpcds_partitioned_parquet_snap.customer_7.c_last_name, tpcds_partitioned_parquet_snap.customer_7.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_7.c_birth_country, tpcds_partitioned_parquet_snap.customer_7.c_login, tpcds_partitioned_parquet_snap.customer_7.c_email_address, tpcds_partitioned_parquet_snap.date_dim_7.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=67 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 169(GETNEXT), 57(OPEN)
|  |  |
|  |  168:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_7.c_customer_id,tpcds_partitioned_parquet_snap.customer_7.c_first_name,tpcds_partitioned_parquet_snap.customer_7.c_last_name,tpcds_partitioned_parquet_snap.customer_7.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_7.c_birth_country,tpcds_partitioned_parquet_snap.customer_7.c_login,tpcds_partitioned_parquet_snap.customer_7.c_email_address,tpcds_partitioned_parquet_snap.date_dim_7.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=67 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 57(GETNEXT)
|  |  |
|  |  F38:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  62:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_1.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_7.c_customer_id, tpcds_partitioned_parquet_snap.customer_7.c_first_name, tpcds_partitioned_parquet_snap.customer_7.c_last_name, tpcds_partitioned_parquet_snap.customer_7.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_7.c_birth_country, tpcds_partitioned_parquet_snap.customer_7.c_login, tpcds_partitioned_parquet_snap.customer_7.c_email_address, tpcds_partitioned_parquet_snap.date_dim_7.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=67 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 57(GETNEXT)
|  |  |
|  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=26
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=61,63,65 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 57(GETNEXT), 60(OPEN)
|  |  |
|  |  |--F112:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=26 plan-id=27 cohort-id=13
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_7.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  167:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=65 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  F40:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=65 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 60(GETNEXT)
|  |  |
|  |  59:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=27
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_1.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_1.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=61,63 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 57(GETNEXT), 58(OPEN)
|  |  |
|  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=27 plan-id=28 cohort-id=13
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  |  runtime filters: RF035[min_max] <- tpcds_partitioned_parquet_snap.customer_7.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  166:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=63 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  58:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=63 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 58(GETNEXT)
|  |  |
|  |  57:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF035[min_max] -> tpcds_partitioned_parquet_snap.web_sales_1.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=61 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 57(GETNEXT)
|  |
|  44:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=60 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 161(GETNEXT), 165(GETNEXT)
|  |
|  |--165:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_6.c_customer_id, tpcds_partitioned_parquet_snap.customer_6.c_first_name, tpcds_partitioned_parquet_snap.customer_6.c_last_name, tpcds_partitioned_parquet_snap.customer_6.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_6.c_birth_country, tpcds_partitioned_parquet_snap.customer_6.c_login, tpcds_partitioned_parquet_snap.customer_6.c_email_address, tpcds_partitioned_parquet_snap.date_dim_6.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=59 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 165(GETNEXT), 51(OPEN)
|  |  |
|  |  164:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_6.c_customer_id,tpcds_partitioned_parquet_snap.customer_6.c_first_name,tpcds_partitioned_parquet_snap.customer_6.c_last_name,tpcds_partitioned_parquet_snap.customer_6.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_6.c_birth_country,tpcds_partitioned_parquet_snap.customer_6.c_login,tpcds_partitioned_parquet_snap.customer_6.c_email_address,tpcds_partitioned_parquet_snap.date_dim_6.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=59 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 51(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  56:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_1.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_6.c_customer_id, tpcds_partitioned_parquet_snap.customer_6.c_first_name, tpcds_partitioned_parquet_snap.customer_6.c_last_name, tpcds_partitioned_parquet_snap.customer_6.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_6.c_birth_country, tpcds_partitioned_parquet_snap.customer_6.c_login, tpcds_partitioned_parquet_snap.customer_6.c_email_address, tpcds_partitioned_parquet_snap.date_dim_6.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=59 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 51(GETNEXT)
|  |  |
|  |  55:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=24
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=53,55,57 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 51(GETNEXT), 54(OPEN)
|  |  |
|  |  |--F110:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=24 plan-id=25 cohort-id=12
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_6.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  163:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=57 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=57 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 54(GETNEXT)
|  |  |
|  |  53:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=25
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=53,55 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 51(GETNEXT), 52(OPEN)
|  |  |
|  |  |--F111:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=12
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  |  runtime filters: RF030[bloom] <- tpcds_partitioned_parquet_snap.customer_6.c_customer_sk, RF031[min_max] <- tpcds_partitioned_parquet_snap.customer_6.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  162:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=55 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 52(GETNEXT)
|  |  |  |
|  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  52:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=55 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 52(GETNEXT)
|  |  |
|  |  51:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF031[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk, RF030[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_1.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=53 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 51(GETNEXT)
|  |
|  161:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_5.c_customer_id, tpcds_partitioned_parquet_snap.customer_5.c_first_name, tpcds_partitioned_parquet_snap.customer_5.c_last_name, tpcds_partitioned_parquet_snap.customer_5.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_5.c_birth_country, tpcds_partitioned_parquet_snap.customer_5.c_login, tpcds_partitioned_parquet_snap.customer_5.c_email_address, tpcds_partitioned_parquet_snap.date_dim_5.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=52 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 161(GETNEXT), 45(OPEN)
|  |
|  160:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_5.c_customer_id,tpcds_partitioned_parquet_snap.customer_5.c_first_name,tpcds_partitioned_parquet_snap.customer_5.c_last_name,tpcds_partitioned_parquet_snap.customer_5.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_5.c_birth_country,tpcds_partitioned_parquet_snap.customer_5.c_login,tpcds_partitioned_parquet_snap.customer_5.c_email_address,tpcds_partitioned_parquet_snap.date_dim_5.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=52 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 45(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  50:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_1.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_5.c_customer_id, tpcds_partitioned_parquet_snap.customer_5.c_first_name, tpcds_partitioned_parquet_snap.customer_5.c_last_name, tpcds_partitioned_parquet_snap.customer_5.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_5.c_birth_country, tpcds_partitioned_parquet_snap.customer_5.c_login, tpcds_partitioned_parquet_snap.customer_5.c_email_address, tpcds_partitioned_parquet_snap.date_dim_5.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=52 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 45(GETNEXT)
|  |
|  49:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=22
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=46,48,50 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 45(GETNEXT), 48(OPEN)
|  |
|  |--F108:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=22 plan-id=23 cohort-id=11
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_5.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  159:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=50 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 48(GETNEXT)
|  |  |
|  |  F31:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  48:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=50 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 48(GETNEXT)
|  |
|  47:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=23
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=46,48 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 45(GETNEXT), 46(OPEN)
|  |
|  |--F109:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=23 plan-id=24 cohort-id=11
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  |  runtime filters: RF026[bloom] <- tpcds_partitioned_parquet_snap.customer_5.c_customer_sk, RF027[min_max] <- tpcds_partitioned_parquet_snap.customer_5.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  158:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=48 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 46(GETNEXT)
|  |  |
|  |  F30:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  46:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=48 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 46(GETNEXT)
|  |
|  45:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF027[min_max] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk, RF026[bloom] -> tpcds_partitioned_parquet_snap.store_sales_1.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=46 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 45(GETNEXT)
|
42:HASH JOIN [INNER JOIN, PARTITIONED]
|  hash-table-id=28
|  hash predicates: CUSTOMER_ID = CUSTOMER_ID
|  fk/pk conjuncts: assumed fk/pk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=22,45 row-size=232B cardinality=1.18G cost=517948489
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT), 147(OPEN), 151(OPEN), 155(OPEN)
|
|--F114:PLAN FRAGMENT [HASH(CUSTOMER_ID)] hosts=10 instances=80 (adjusted from 120)
|  |  Per-Instance Resources: mem-estimate=1.92GB mem-reservation=34.00MB thread-reservation=1
|  |  max-parallelism=2350 segment-costs=[1946241445] cpu-comparison-result=360 [max(80 (self) vs 360 (sum children))]
|  JOIN BUILD
|  |  join-table-id=28 plan-id=29 cohort-id=01
|  |  build expressions: CUSTOMER_ID
|  |  mem-estimate=1.90GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0 cost=1183341306
|  |
|  157:EXCHANGE [HASH(CUSTOMER_ID)]
|  |  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=116B cardinality=1.18G cost=762900139
|  |  in pipelines: 147(GETNEXT), 151(GETNEXT), 155(GETNEXT)
|  |
|  F27:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
|  max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 49605428499] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
|  41:SELECT
|  |  predicates: DYEAR = CAST(1999 AS INT), SALE_TYPE = 's', YEAR_TOTAL > CAST(0 AS DECIMAL(3,0))
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=116B cardinality=1.18G cost=35500236800
|  |  in pipelines: 147(GETNEXT), 151(GETNEXT), 155(GETNEXT)
|  |
|  21:UNION
|  |  pass-through-operands: 22
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=45 row-size=116B cardinality=11.83G cost=782000635
|  |  in pipelines: 147(GETNEXT), 151(GETNEXT), 155(GETNEXT)
|  |
|  |--155:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_4.c_customer_id, tpcds_partitioned_parquet_snap.customer_4.c_first_name, tpcds_partitioned_parquet_snap.customer_4.c_last_name, tpcds_partitioned_parquet_snap.customer_4.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_4.c_birth_country, tpcds_partitioned_parquet_snap.customer_4.c_login, tpcds_partitioned_parquet_snap.customer_4.c_email_address, tpcds_partitioned_parquet_snap.date_dim_4.d_year
|  |  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=44 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 155(GETNEXT), 35(OPEN)
|  |  |
|  |  154:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_4.c_customer_id,tpcds_partitioned_parquet_snap.customer_4.c_first_name,tpcds_partitioned_parquet_snap.customer_4.c_last_name,tpcds_partitioned_parquet_snap.customer_4.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_4.c_birth_country,tpcds_partitioned_parquet_snap.customer_4.c_login,tpcds_partitioned_parquet_snap.customer_4.c_email_address,tpcds_partitioned_parquet_snap.date_dim_4.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=44 row-size=169B cardinality=1.99G cost=1767409028
|  |  |  in pipelines: 35(GETNEXT)
|  |  |
|  |  F23:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  |  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  40:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales_0.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_4.c_customer_id, tpcds_partitioned_parquet_snap.customer_4.c_first_name, tpcds_partitioned_parquet_snap.customer_4.c_last_name, tpcds_partitioned_parquet_snap.customer_4.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_4.c_birth_country, tpcds_partitioned_parquet_snap.customer_4.c_login, tpcds_partitioned_parquet_snap.customer_4.c_email_address, tpcds_partitioned_parquet_snap.date_dim_4.d_year
|  |  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=44 row-size=169B cardinality=1.99G cost=11732593545
|  |  |  in pipelines: 35(GETNEXT)
|  |  |
|  |  39:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=33
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=38,40,42 row-size=582B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 35(GETNEXT), 38(OPEN)
|  |  |
|  |  |--F119:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=16
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_4.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  153:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=42 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 38(GETNEXT)
|  |  |  |
|  |  |  F25:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=42 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 38(GETNEXT)
|  |  |
|  |  37:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=34
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales_0.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales_0.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=38,40 row-size=344B cardinality=1.99G cost=870015958
|  |  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |  |
|  |  |--F120:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=34 plan-id=35 cohort-id=16
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  |  runtime filters: RF023[min_max] <- tpcds_partitioned_parquet_snap.customer_4.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  152:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 36(GETNEXT)
|  |  |  |
|  |  |  F24:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=40 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 36(GETNEXT)
|  |  |
|  |  35:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=145.75GB
|  |     runtime filters: RF023[min_max] -> tpcds_partitioned_parquet_snap.web_sales_0.ws_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=2.16G size=145.75GB
|  |       partitions: 1824/1824 rows=2.16G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.37M
|  |     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|  |     tuple-ids=38 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|  |     in pipelines: 35(GETNEXT)
|  |
|  22:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=37 row-size=116B cardinality=9.85G cost=3873500731
|  |  in pipelines: 147(GETNEXT), 151(GETNEXT)
|  |
|  |--151:AGGREGATE [FINALIZE]
|  |  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_sales_price), 2))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_3.c_customer_id, tpcds_partitioned_parquet_snap.customer_3.c_first_name, tpcds_partitioned_parquet_snap.customer_3.c_last_name, tpcds_partitioned_parquet_snap.customer_3.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_3.c_birth_country, tpcds_partitioned_parquet_snap.customer_3.c_login, tpcds_partitioned_parquet_snap.customer_3.c_email_address, tpcds_partitioned_parquet_snap.date_dim_3.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=36 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 151(GETNEXT), 29(OPEN)
|  |  |
|  |  150:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_3.c_customer_id,tpcds_partitioned_parquet_snap.customer_3.c_first_name,tpcds_partitioned_parquet_snap.customer_3.c_last_name,tpcds_partitioned_parquet_snap.customer_3.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_3.c_birth_country,tpcds_partitioned_parquet_snap.customer_3.c_login,tpcds_partitioned_parquet_snap.customer_3.c_email_address,tpcds_partitioned_parquet_snap.date_dim_3.d_year)]
|  |  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=169B cardinality=3.97G cost=3526206713
|  |  |  in pipelines: 29(GETNEXT)
|  |  |
|  |  F18:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  |  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  |  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  |  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  |  34:AGGREGATE [STREAMING]
|  |  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales_0.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  |  group by: tpcds_partitioned_parquet_snap.customer_3.c_customer_id, tpcds_partitioned_parquet_snap.customer_3.c_first_name, tpcds_partitioned_parquet_snap.customer_3.c_last_name, tpcds_partitioned_parquet_snap.customer_3.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_3.c_birth_country, tpcds_partitioned_parquet_snap.customer_3.c_login, tpcds_partitioned_parquet_snap.customer_3.c_email_address, tpcds_partitioned_parquet_snap.date_dim_3.d_year
|  |  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=36 row-size=169B cardinality=3.97G cost=23408022405
|  |  |  in pipelines: 29(GETNEXT)
|  |  |
|  |  33:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=31
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=30,32,34 row-size=582B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 29(GETNEXT), 32(OPEN)
|  |  |
|  |  |--F117:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  |  max-parallelism=10 segment-costs=[170129]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=31 plan-id=32 cohort-id=15
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_3.d_date_sk
|  |  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |  |
|  |  |  149:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=34 row-size=237B cardinality=73.05K cost=97080
|  |  |  |  in pipelines: 32(GETNEXT)
|  |  |  |
|  |  |  F20:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[158950]
|  |  |  32:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.17MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |  |     tuple-ids=34 row-size=237B cardinality=73.05K cost=110600
|  |  |     in pipelines: 32(GETNEXT)
|  |  |
|  |  31:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=32
|  |  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=30,32 row-size=344B cardinality=3.97G cost=1735792939
|  |  |  in pipelines: 29(GETNEXT), 30(OPEN)
|  |  |
|  |  |--F118:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=32 plan-id=33 cohort-id=15
|  |  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  |  runtime filters: RF018[bloom] <- tpcds_partitioned_parquet_snap.customer_3.c_customer_sk, RF019[min_max] <- tpcds_partitioned_parquet_snap.customer_3.c_customer_sk
|  |  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |  |
|  |  |  148:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=32 row-size=204B cardinality=30.00M cost=39869990
|  |  |  |  in pipelines: 30(GETNEXT)
|  |  |  |
|  |  |  F19:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[64027278]
|  |  |  30:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |  |     stored statistics:
|  |  |       table: rows=30.00M size=1.55GB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |  |     tuple-ids=32 row-size=204B cardinality=30.00M cost=46823813
|  |  |     in pipelines: 30(GETNEXT)
|  |  |
|  |  29:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=280.96GB
|  |     runtime filters: RF019[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk, RF018[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales_0.cs_bill_customer_sk
|  |     stored statistics:
|  |       table: rows=4.32G size=280.96GB
|  |       partitions: 1831/1831 rows=4.32G
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=21.52M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=30 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|  |     in pipelines: 29(GETNEXT)
|  |
|  147:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_2.c_customer_id, tpcds_partitioned_parquet_snap.customer_2.c_first_name, tpcds_partitioned_parquet_snap.customer_2.c_last_name, tpcds_partitioned_parquet_snap.customer_2.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_2.c_birth_country, tpcds_partitioned_parquet_snap.customer_2.c_login, tpcds_partitioned_parquet_snap.customer_2.c_email_address, tpcds_partitioned_parquet_snap.date_dim_2.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=29 row-size=169B cardinality=5.88G cost=37464857383
|  |  in pipelines: 147(GETNEXT), 23(OPEN)
|  |
|  146:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_2.c_customer_id,tpcds_partitioned_parquet_snap.customer_2.c_first_name,tpcds_partitioned_parquet_snap.customer_2.c_last_name,tpcds_partitioned_parquet_snap.customer_2.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_2.c_birth_country,tpcds_partitioned_parquet_snap.customer_2.c_login,tpcds_partitioned_parquet_snap.customer_2.c_email_address,tpcds_partitioned_parquet_snap.date_dim_2.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=29 row-size=169B cardinality=7.89G cost=7012748222
|  |  in pipelines: 23(GETNEXT)
|  |
|  F14:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  28:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales_0.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_2.c_customer_id, tpcds_partitioned_parquet_snap.customer_2.c_first_name, tpcds_partitioned_parquet_snap.customer_2.c_last_name, tpcds_partitioned_parquet_snap.customer_2.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_2.c_birth_country, tpcds_partitioned_parquet_snap.customer_2.c_login, tpcds_partitioned_parquet_snap.customer_2.c_email_address, tpcds_partitioned_parquet_snap.date_dim_2.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=29 row-size=169B cardinality=7.89G cost=46613754103
|  |  in pipelines: 23(GETNEXT)
|  |
|  27:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=29
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=23,25,27 row-size=538B cardinality=7.93G cost=3471497176
|  |  in pipelines: 23(GETNEXT), 26(OPEN)
|  |
|  |--F115:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=29 plan-id=30 cohort-id=14
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_2.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  145:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=27 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 26(GETNEXT)
|  |  |
|  |  F16:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  26:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=27 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 26(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=30
|  |  hash predicates: tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk = tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=23,25 row-size=300B cardinality=7.93G cost=3471497176
|  |  in pipelines: 23(GETNEXT), 24(OPEN)
|  |
|  |--F116:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=30 plan-id=31 cohort-id=14
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  |  runtime filters: RF014[bloom] <- tpcds_partitioned_parquet_snap.customer_2.c_customer_sk, RF015[min_max] <- tpcds_partitioned_parquet_snap.customer_2.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  144:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=25 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 24(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  24:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=25 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 24(GETNEXT)
|  |
|  23:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=389.90GB
|     runtime filters: RF015[min_max] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk, RF014[bloom] -> tpcds_partitioned_parquet_snap.store_sales_0.ss_customer_sk
|     stored statistics:
|       table: rows=8.64G size=389.90GB
|       partitions: 1824/1824 rows=8.64G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=390.22M
|     mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
|     tuple-ids=23 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
|     in pipelines: 23(GETNEXT)
|
156:EXCHANGE [HASH(CUSTOMER_ID)]
|  mem-estimate=24.06MB mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=116B cardinality=1.18G cost=762900139
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT)
|
F13:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Instance Resources: mem-estimate=4.23GB mem-reservation=34.00MB thread-reservation=1
max-parallelism=120 segment-costs=[44477605605, 26934229118, 13500002573, 37772016915] cpu-comparison-result=360 [max(120 (self) vs 360 (sum children))]
20:SELECT
|  predicates: DYEAR = add(CAST(1999 AS INT), CAST(1 AS INT)), SALE_TYPE = 's'
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=116B cardinality=1.18G cost=23666825216
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT)
|
00:UNION
|  pass-through-operands: 01
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=22 row-size=116B cardinality=11.83G cost=782000635
|  in pipelines: 135(GETNEXT), 139(GETNEXT), 143(GETNEXT)
|
|--143:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales.ws_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_1.c_customer_id, tpcds_partitioned_parquet_snap.customer_1.c_first_name, tpcds_partitioned_parquet_snap.customer_1.c_last_name, tpcds_partitioned_parquet_snap.customer_1.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_1.c_birth_country, tpcds_partitioned_parquet_snap.customer_1.c_login, tpcds_partitioned_parquet_snap.customer_1.c_email_address, tpcds_partitioned_parquet_snap.date_dim_1.d_year
|  |  mem-estimate=2.79GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=21 row-size=169B cardinality=1.99G cost=11732593545
|  |  in pipelines: 143(GETNEXT), 14(OPEN)
|  |
|  142:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_1.c_customer_id,tpcds_partitioned_parquet_snap.customer_1.c_first_name,tpcds_partitioned_parquet_snap.customer_1.c_last_name,tpcds_partitioned_parquet_snap.customer_1.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_1.c_birth_country,tpcds_partitioned_parquet_snap.customer_1.c_login,tpcds_partitioned_parquet_snap.customer_1.c_email_address,tpcds_partitioned_parquet_snap.date_dim_1.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=21 row-size=169B cardinality=1.99G cost=1767409028
|  |  in pipelines: 14(GETNEXT)
|  |
|  F09:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Instance Resources: mem-estimate=2.19GB mem-reservation=34.26MB thread-reservation=1
|  max-parallelism=1824 segment-costs=[17827120882, 22676121640] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  19:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.web_sales.ws_ext_list_price, tpcds_partitioned_parquet_snap.web_sales.ws_ext_wholesale_cost), tpcds_partitioned_parquet_snap.web_sales.ws_ext_discount_amt), tpcds_partitioned_parquet_snap.web_sales.ws_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_1.c_customer_id, tpcds_partitioned_parquet_snap.customer_1.c_first_name, tpcds_partitioned_parquet_snap.customer_1.c_last_name, tpcds_partitioned_parquet_snap.customer_1.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_1.c_birth_country, tpcds_partitioned_parquet_snap.customer_1.c_login, tpcds_partitioned_parquet_snap.customer_1.c_email_address, tpcds_partitioned_parquet_snap.date_dim_1.d_year
|  |  mem-estimate=2.10GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=21 row-size=169B cardinality=1.99G cost=11732593545
|  |  in pipelines: 14(GETNEXT)
|  |
|  18:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=39
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=15,17,19 row-size=582B cardinality=1.99G cost=870015958
|  |  in pipelines: 14(GETNEXT), 17(OPEN)
|  |
|  |--F125:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=39 plan-id=40 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_1.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  141:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=19 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 17(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=19 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 17(GETNEXT)
|  |
|  16:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=40
|  |  hash predicates: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=15,17 row-size=344B cardinality=1.99G cost=870015958
|  |  in pipelines: 14(GETNEXT), 15(OPEN)
|  |
|  |--F126:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.47GB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=40 plan-id=41 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  |  runtime filters: RF011[min_max] <- tpcds_partitioned_parquet_snap.customer_1.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  140:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=17 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 15(GETNEXT)
|  |  |
|  |  F10:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  15:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=17 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 15(GETNEXT)
|  |
|  14:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=145.75GB
|     runtime filters: RF011[min_max] -> tpcds_partitioned_parquet_snap.web_sales.ws_bill_customer_sk
|     stored statistics:
|       table: rows=2.16G size=145.75GB
|       partitions: 1824/1824 rows=2.16G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.37M
|     mem-estimate=16.00MB mem-reservation=264.00KB thread-reservation=0
|     tuple-ids=15 row-size=140B cardinality=1.99G(filtered from 2.16G) cost=4354495421
|     in pipelines: 14(GETNEXT)
|
01:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=14 row-size=116B cardinality=9.85G cost=3873500731
|  in pipelines: 135(GETNEXT), 139(GETNEXT)
|
|--139:AGGREGATE [FINALIZE]
|  |  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_sales_price), 2))
|  |  group by: tpcds_partitioned_parquet_snap.customer_0.c_customer_id, tpcds_partitioned_parquet_snap.customer_0.c_first_name, tpcds_partitioned_parquet_snap.customer_0.c_last_name, tpcds_partitioned_parquet_snap.customer_0.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_0.c_birth_country, tpcds_partitioned_parquet_snap.customer_0.c_login, tpcds_partitioned_parquet_snap.customer_0.c_email_address, tpcds_partitioned_parquet_snap.date_dim_0.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=13 row-size=169B cardinality=3.97G cost=23408022405
|  |  in pipelines: 139(GETNEXT), 08(OPEN)
|  |
|  138:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer_0.c_customer_id,tpcds_partitioned_parquet_snap.customer_0.c_first_name,tpcds_partitioned_parquet_snap.customer_0.c_last_name,tpcds_partitioned_parquet_snap.customer_0.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer_0.c_birth_country,tpcds_partitioned_parquet_snap.customer_0.c_login,tpcds_partitioned_parquet_snap.customer_0.c_email_address,tpcds_partitioned_parquet_snap.date_dim_0.d_year)]
|  |  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=13 row-size=169B cardinality=3.97G cost=3526206713
|  |  in pipelines: 08(GETNEXT)
|  |
|  F04:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
|  Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
|  Per-Instance Resources: mem-estimate=4.26GB mem-reservation=35.00MB thread-reservation=1
|  max-parallelism=1831 segment-costs=[35588885488, 45241758471] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
|  13:AGGREGATE [STREAMING]
|  |  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_list_price, tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_wholesale_cost), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_discount_amt), tpcds_partitioned_parquet_snap.catalog_sales.cs_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  |  group by: tpcds_partitioned_parquet_snap.customer_0.c_customer_id, tpcds_partitioned_parquet_snap.customer_0.c_first_name, tpcds_partitioned_parquet_snap.customer_0.c_last_name, tpcds_partitioned_parquet_snap.customer_0.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer_0.c_birth_country, tpcds_partitioned_parquet_snap.customer_0.c_login, tpcds_partitioned_parquet_snap.customer_0.c_email_address, tpcds_partitioned_parquet_snap.date_dim_0.d_year
|  |  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=13 row-size=169B cardinality=3.97G cost=23408022405
|  |  in pipelines: 08(GETNEXT)
|  |
|  12:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=37
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=7,9,11 row-size=582B cardinality=3.97G cost=1735792939
|  |  in pipelines: 08(GETNEXT), 11(OPEN)
|  |
|  |--F123:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  |  max-parallelism=10 segment-costs=[170129]
|  |  JOIN BUILD
|  |  |  join-table-id=37 plan-id=38 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.date_dim_0.d_date_sk
|  |  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |  |
|  |  137:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=11 row-size=237B cardinality=73.05K cost=97080
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  F06:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[158950]
|  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.17MB
|  |     stored statistics:
|  |       table: rows=73.05K size=2.17MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|  |     tuple-ids=11 row-size=237B cardinality=73.05K cost=110600
|  |     in pipelines: 11(GETNEXT)
|  |
|  10:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=38
|  |  hash predicates: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  fk/pk conjuncts: tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk = tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=7,9 row-size=344B cardinality=3.97G cost=1735792939
|  |  in pipelines: 08(GETNEXT), 09(OPEN)
|  |
|  |--F124:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  |  max-parallelism=10 segment-costs=[69869990]
|  |  JOIN BUILD
|  |  |  join-table-id=38 plan-id=39 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  |  runtime filters: RF006[bloom] <- tpcds_partitioned_parquet_snap.customer_0.c_customer_sk, RF007[min_max] <- tpcds_partitioned_parquet_snap.customer_0.c_customer_sk
|  |  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |  |
|  |  136:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=9 row-size=204B cardinality=30.00M cost=39869990
|  |  |  in pipelines: 09(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[64027278]
|  |  09:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.55GB
|  |     stored statistics:
|  |       table: rows=30.00M size=1.55GB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=3.10M
|  |     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|  |     tuple-ids=9 row-size=204B cardinality=30.00M cost=46823813
|  |     in pipelines: 09(GETNEXT)
|  |
|  08:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=280.96GB
|     runtime filters: RF007[min_max] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk, RF006[bloom] -> tpcds_partitioned_parquet_snap.catalog_sales.cs_bill_customer_sk
|     stored statistics:
|       table: rows=4.32G size=280.96GB
|       partitions: 1831/1831 rows=4.32G
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=21.52M
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=7 row-size=140B cardinality=3.97G(filtered from 4.32G) cost=8709277205
|     in pipelines: 08(GETNEXT)
|
135:AGGREGATE [FINALIZE]
|  output: sum:merge(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales.ss_ext_sales_price), 2))
|  group by: tpcds_partitioned_parquet_snap.customer.c_customer_id, tpcds_partitioned_parquet_snap.customer.c_first_name, tpcds_partitioned_parquet_snap.customer.c_last_name, tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer.c_birth_country, tpcds_partitioned_parquet_snap.customer.c_login, tpcds_partitioned_parquet_snap.customer.c_email_address, tpcds_partitioned_parquet_snap.date_dim.d_year
|  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=6 row-size=169B cardinality=5.88G cost=37464857383
|  in pipelines: 135(GETNEXT), 02(OPEN)
|
134:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.customer.c_customer_id,tpcds_partitioned_parquet_snap.customer.c_first_name,tpcds_partitioned_parquet_snap.customer.c_last_name,tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag,tpcds_partitioned_parquet_snap.customer.c_birth_country,tpcds_partitioned_parquet_snap.customer.c_login,tpcds_partitioned_parquet_snap.customer.c_email_address,tpcds_partitioned_parquet_snap.date_dim.d_year)]
|  mem-estimate=30.29MB mem-reservation=0B thread-reservation=0
|  tuple-ids=6 row-size=169B cardinality=7.89G cost=7012748222
|  in pipelines: 02(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=10 instances=120
Per-Host Shared Resources: mem-estimate=16.00MB mem-reservation=16.00MB thread-reservation=0 runtime-filters-memory=16.00MB
Per-Instance Resources: mem-estimate=4.26GB mem-reservation=42.00MB thread-reservation=1
max-parallelism=1824 segment-costs=[65500594865, 89974606443] cpu-comparison-result=120 [max(120 (self) vs 31 (sum children))]
07:AGGREGATE [STREAMING]
|  output: sum(divide(add(subtract(subtract(tpcds_partitioned_parquet_snap.store_sales.ss_ext_list_price, tpcds_partitioned_parquet_snap.store_sales.ss_ext_wholesale_cost), tpcds_partitioned_parquet_snap.store_sales.ss_ext_discount_amt), tpcds_partitioned_parquet_snap.store_sales.ss_ext_sales_price), CAST(2 AS DECIMAL(3,0))))
|  group by: tpcds_partitioned_parquet_snap.customer.c_customer_id, tpcds_partitioned_parquet_snap.customer.c_first_name, tpcds_partitioned_parquet_snap.customer.c_last_name, tpcds_partitioned_parquet_snap.customer.c_preferred_cust_flag, tpcds_partitioned_parquet_snap.customer.c_birth_country, tpcds_partitioned_parquet_snap.customer.c_login, tpcds_partitioned_parquet_snap.customer.c_email_address, tpcds_partitioned_parquet_snap.date_dim.d_year
|  mem-estimate=4.17GB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=6 row-size=169B cardinality=7.89G cost=46613754103
|  in pipelines: 02(GETNEXT)
|
06:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=35
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_sold_date_sk = tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2,4 row-size=538B cardinality=7.93G cost=3471497176
|  in pipelines: 02(GETNEXT), 05(OPEN)
|
|--F121:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=418.24MB mem-reservation=408.00MB thread-reservation=1
|  |  max-parallelism=10 segment-costs=[170129]
|  JOIN BUILD
|  |  join-table-id=35 plan-id=36 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.date_dim.d_date_sk
|  |  mem-estimate=408.00MB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=73049
|  |
|  133:EXCHANGE [BROADCAST]
|  |  mem-estimate=10.24MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=4 row-size=237B cardinality=73.05K cost=97080
|  |  in pipelines: 05(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[158950]
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.17MB
|     stored statistics:
|       table: rows=73.05K size=2.17MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     mem-estimate=16.00MB mem-reservation=4.00MB thread-reservation=0
|     tuple-ids=4 row-size=237B cardinality=73.05K cost=110600
|     in pipelines: 05(GETNEXT)
|
04:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=36
|  hash predicates: tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  fk/pk conjuncts: tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk = tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=0,2 row-size=300B cardinality=7.93G cost=3471497176
|  in pipelines: 02(GETNEXT), 03(OPEN)
|
|--F122:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  |  Per-Instance Resources: mem-estimate=6.49GB mem-reservation=424.00MB thread-reservation=1 runtime-filters-memory=16.00MB
|  |  max-parallelism=10 segment-costs=[69869990]
|  JOIN BUILD
|  |  join-table-id=36 plan-id=37 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  runtime filters: RF002[bloom] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk, RF003[min_max] <- tpcds_partitioned_parquet_snap.customer.c_customer_sk
|  |  mem-estimate=6.46GB mem-reservation=408.00MB spill-buffer=2.00MB thread-reservation=0 cost=30000000
|  |
|  132:EXCHANGE [BROADCAST]
|  |  mem-estimate=12.04MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=204B cardinality=30.00M cost=39869990
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=10 instances=10
|  Per-Instance Resources: mem-estimate=16.81MB mem-reservation=1.00MB thread-reservation=1
|  max-parallelism=10 segment-costs=[64027278]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.customer, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.55GB
|     stored statistics:
|       table: rows=30.00M size=1.55GB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=3.10M
|     mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
|     tuple-ids=2 row-size=204B cardinality=30.00M cost=46823813
|     in pipelines: 03(GETNEXT)
|
02:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=389.90GB
   runtime filters: RF003[min_max] -> tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk, RF002[bloom] -> tpcds_partitioned_parquet_snap.store_sales.ss_customer_sk
   stored statistics:
     table: rows=8.64G size=389.90GB
     partitions: 1824/1824 rows=8.64G
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=390.22M
   mem-estimate=16.00MB mem-reservation=8.00MB thread-reservation=0
   tuple-ids=0 row-size=96B cardinality=7.93G(filtered from 8.64G) cost=11943846410
   in pipelines: 02(GETNEXT)
====
