====
---- QUERY
select * from iceberg_column_case_sensitivity_issue;
---- RESULTS
'1','impala'
'2','hive'
---- TYPES
STRING, STRING
====
---- QUERY
# Check that predicate pushdown works well
select * from iceberg_column_case_sensitivity_issue
where id = '1';
---- RESULTS
'1','impala'
---- TYPES
STRING, STRING
---- RUNTIME_PROFILE
aggregation(SUM, NumRowGroups): 1
====
---- QUERY
# IMPALA-14290: check partition columns case insensitivity
CREATE TABLE partition_case_insensitive ( START_TIME TIMESTAMP, End_Time TIMESTAMP )
PARTITIONED BY SPEC (DAY(START_TIME), MONTH(enD_tIMe))
STORED AS ICEBERG;
---- RESULTS
'Table has been created.'
====
---- QUERY
ALTER TABLE partition_case_insensitive SET PARTITION SPEC (MONTH(start_TIME), DAY(end_time));
---- RESULTS
'Updated partition spec.'
====
---- QUERY
INSERT INTO partition_case_insensitive VALUES ("2023-11-27 00:00:00", "2024-08-12 00:00:00");
ALTER TABLE partition_case_insensitive DROP PARTITION (MONTH(sTARt_timE) = "2023-11");
---- RESULTS
'Dropped 1 partition(s)'
====
---- QUERY
INSERT INTO partition_case_insensitive VALUES ("2023-12-27 00:00:00", "2024-08-12 00:00:00");
INSERT INTO partition_case_insensitive VALUES ("2023-12-25 00:00:00", "2024-08-12 00:00:00");
INSERT INTO partition_case_insensitive VALUES ("2023-12-25 00:00:00", "2024-07-12 00:00:00");
INSERT INTO partition_case_insensitive VALUES ("2023-11-27 00:00:00", "2024-07-12 00:00:00");
SHOW PARTITIONS partition_case_insensitive;
---- LABELS
Partition, Number Of Rows, Number Of Files
---- RESULTS
# IMPALA-14406: in newer Iceberg versions (e.g. 1.5.2), partition values with null are not shown
regex:'{("start_time_day":null,"end_time_month":null,)?"start_time_month":"646","end_time_day":"19916"}',1,1
regex:'{("start_time_day":null,"end_time_month":null,)?"start_time_month":"647","end_time_day":"19916"}',1,1
regex:'{("start_time_day":null,"end_time_month":null,)?"start_time_month":"647","end_time_day":"19947"}',2,2
---- TYPES
STRING, BIGINT, BIGINT
====
